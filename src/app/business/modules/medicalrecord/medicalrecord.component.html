<section>
  <div class="card title-gb">
    <h5 class="mgn-up-10">
      <span class="fa fa-arrow-left pointer-cursor" (click)="goback()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      Medical Record
    </h5>
  </div>
</section>
<app-common-innerloading-spinner *ngIf="loading"></app-common-innerloading-spinner>
<section *ngIf="!loading" class="medical-record">
  <div class="col-md-10 col-xs-12 col-sm-12 col-lg-9 mgn-up-10 no-padding-small">
    <div class="card title-gb no-padding">
      <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 mgn-up-10">
          <label>{{customer_label | capitalizeFirst}} Name </label>&nbsp; <span>{{customerDetails.firstName | capitalizeFirst}} {{customerDetails.lastName}} </span><br>
          <label>{{customer_label | capitalizeFirst}} Id  </label>&nbsp; <span>{{display_PatientId}}</span> <br *ngIf="display_PatientId">
          <label  *ngIf="customerDetails.dob">DOB </label> &nbsp;<span  *ngIf="customerDetails.dob">{{customerDetails.dob  | date:newDateFormat}} </span> <br  *ngIf="customerDetails.dob">
          <label *ngIf="customerDetails.gender">Gender </label> &nbsp;<span *ngIf="customerDetails.gender">{{customerDetails.gender | capitalizeFirst}} </span>

        <!-- <span>Patient Name: {{customerDetails.firstName | capitalizeFirst}} {{customerDetails.lastName}} </span><br>
        <span>Patient Id: {{display_PatientId}}</span><br *ngIf="display_PatientId">
        <span *ngIf="customerDetails.dob">DOB: {{customerDetails.dob  | date:display_dateFormat}}</span><br
          *ngIf="customerDetails.dob">
        <span *ngIf="customerDetails.gender">Gender: {{customerDetails.gender | capitalizeFirst}}</span> -->
        <hr>
      </div>
      <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 ">
        <h5 class="heading2b">Add or view medical records</h5>
        <div class="col-md-8 col-xs-12 col-sm-12 col-lg-8"  style="padding-left:0px;padding-right:0px;"><span class="normal-sz">{{customer_label | capitalizeFirst}} visit date </span>
          <button *ngIf="dateShow">{{visitdate }} &nbsp;</button>
          <button *ngIf="isShowList" (click)="VisitList()">{{visitdate}} &nbsp; <i class="arrow down"></i></button>
        </div><div class="col-md-4 col-xs-12 col-sm-12 col-lg-4"  style="padding-left:0px;padding-right:0px;">
          <span *ngIf="mrId !== 0"  class="custId-cursor  mr-20" (click)="activitylogs()"><u style="color: blue;">Activity Logs</u></span>
          <!-- <span>(Recent visit)</span> -->
        </div>
        <div class="clearfix"></div>
      <hr>
      </div>
      
     
      <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12">
        <div class="col-md-7 col-lg-7 col-xs-12 col-sm-12" style="padding-left:0px;padding-right:0px;">
          <label *ngIf="department">Department</label><span *ngIf="department">
            {{department | capitalizeFirst}}</span><br *ngIf="department">
          <label *ngIf="serviceName">Service/Consultation</label><span *ngIf="serviceName">
            {{serviceName | capitalizeFirst}}</span><br *ngIf="serviceName">
            <label *ngIf="doctorName">Doctor</label><span *ngIf="doctorName">
              {{doctorName | capitalizeFirst}}</span><br *ngIf="doctorName">
          <!-- <label *ngIf="bookingType && bookingType !='FOLLOWUP'">Consultation Mode: </label><span  *ngIf="bookingType && bookingType !='FOLLOWUP'"> {{consultationMode}}</span> -->
          <!-- <span *ngIf="bookingType === 'FOLLOWUP'"> <label>Consultation Mode: </label>&nbsp;
          <select [(ngModel)]="patientConsultationType" (ngModelChange)="modeChanged($event)">
            <option *ngFor="let mode of patientConsultationModes" [value]="mode.name">{{mode.displayName}}</option>
          </select>
        </span> -->
        </div>
        <div  class="col-md-5 col-lg-5 col-xs-12 col-sm-12 no-padding">
          <label *ngIf="mrId !== 0">Medical Record#</label><span *ngIf="mrId !== 0"> {{mrNumber}}</span><br>
          <div *ngIf="mrId !== 0">
            <label>Created On</label>
            <span>&nbsp;{{mrCreatedDate}}</span>
          </div>
        </div>
        <div class="clearfix"></div>
        <hr>
      </div>
      <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12">
          <!-- <span class="normal-sz mgn-bt-10">For uploading files </span> <button (click)="uploadFileforMr()">Click here</button><br> -->
<span  *ngIf="selectedMessage.files && selectedMessage.files.length > 0"><a class="pointlist" (click)="isShowtable()"><u>{{selectedMessage.files.length}} files are uploaded</u></a></span>
          <div class="w-dta" *ngIf="selectedMessage.files && selectedMessage.files.length > 0 && showtable" >
              <div class="row">
                  <div class="copy">
                      <div class="table-outer q-itm">
            <div class="pad-10 drugdetailslist" >
              <h5 class="heading3b"> Files uploaded</h5>
              <table class="table " >
                <thead>
                  <tr>
                    <th>
                      File 
                    </th>
                    <th>
                      Caption
                    </th>
                    <th>
                      Image size
                    </th>
                    <!-- <th>
                      audio
                      </th> -->
                    <th>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let file of selectedMessage.files; let i = index;">
                    <td data-title="File" *ngIf="file.type == '.pdf'|| file.type == 'application/pdf'">
                      {{file.name}}
                    </td>
                    <td data-title="File" *ngIf="file.type == '.png'|| file.type =='image/png'|| file.type == '.jpg' ||file.type == '.PNG'|| file.type == '.jpeg' ||file.type =='image/jpeg'" >
                      <!-- <img  [src]="selectedMessage.base64[0]" *ngIf="selectedMessage.base64[0]" style="width: 25px; height:25px;" class="img-responsive pointer-cursor"(click)="openImageModalRow(image_list_popup[0])"> -->
                      <img alt="" src="{{file.url}}"   id="prescription-image1" style="width: 25px; height:25px;"  class="img-responsive pointer-cursor" (click)="openImageModalRow(image_list_popup[i])">
                    </td>
                    <td data-title="status">
                      {{file.caption}}
                    </td>
                    <td data-title="Image size">
                      {{imageSize(file.size)}} KB
                    </td>
                    <!-- <td data-title="audio">
                        <audio src = "https://file-examples-com.github.io/uploads/2017/11/file_example_MP3_700KB.mp3" controls >
                         </audio>
                      </td> -->
                    <td class="action">
                      <span class="mbt">
                          <button type="button" mat-icon-button
                              [matMenuTriggerFor]="menu">
                              <mat-icon>more_vert</mat-icon>
                          </button>
                          <mat-menu #menu="matMenu">
                              <button type="button" (click)="deleteTempImage(file,i)"
                                  mat-menu-item>
                                  <i class="icon-delete"></i>
                                  Delete
                              </button>
                          </mat-menu>
                      </span>
                      <span class="mbt-mobile-show">
                          <button class="deletecls" type="button"
                              (click)="deleteTempImage(file,i)">Delete</button>
                      </span>
                  </td>
                  </tr>
                </tbody>
              </table>
              
              <ks-modal-gallery [id]="0" *ngIf="image_list_popup && image_list_popup.length>0"
                [modalImages]="image_list_popup" [plainGalleryConfig]="customPlainGalleryRowConfig"
                [buttonsConfig]="customButtonsFontAwesomeConfig" (buttonBeforeHook)="onButtonBeforeHook()"
                (buttonAfterHook)="onButtonAfterHook()"></ks-modal-gallery>
             </div></div></div></div>
            </div>
        <hr>
      </div>
      <div class="clearfix"></div>
      <div class="content w-manager settings ">
        <div style="padding: 5px;">
          <nav mat-tab-nav-bar>
            <a mat-tab-link *ngFor="let routeLink of routeLinks; let i = index;" [routerLink]="routeLink.link"
           routerLinkActive="mat-tab-link-active" #rla="routerLinkActive"
              class="routerLink.active heading2" [active]="rla.isActive" (click)="activeLinkIndex = i"
              [routerLinkActiveOptions]="{exact: true}">
              {{routeLink.label}}
            </a>
          </nav>
          <router-outlet></router-outlet>
          <div class="clearfix"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="clearfix"></div>
</section>

