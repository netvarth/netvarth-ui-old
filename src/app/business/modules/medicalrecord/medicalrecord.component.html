<section>
  <div class="card title-gb">
    <h5 class="mgn-up-10 medicalRecord">
      <span class="fa fa-arrow-left pointer-cursor clrChnge" (click)="goback('medical')"></span>
      <span class="clrChnge">Medical Record</span>
    </h5>
  </div>
</section>
<app-common-innerloading-spinner *ngIf="loading"></app-common-innerloading-spinner>
<section *ngIf="!loading && !viewVisitDetails" class="medical-record">
  <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 mgn-up-10 no-padding-small">
    <div class="col-xs-12 col-sm-12 mgn-up-10 card">
      <div class="infoDetails shadow">
        <div *ngIf="customerDetails">
          <div  *ngIf="customerDetails && customerDetails.gender === 'male'">
            <img class="imGBorderRadius" src="assets/images/mr_male.svg"  />
          </div>
          <div  *ngIf="customerDetails && customerDetails.gender === 'female'">
            <img class="imGBorderRadius" src="assets/images/mr_female.svg"  />
          </div>
          <div  *ngIf="customerDetails.gender != 'male' && customerDetails.gender != 'female'">
            <img class="imGBorderRadius" src="assets/images/undefinedUser.png"  />
          </div>
            <div *ngIf="customerDetails.firstName ||customerDetails.lastName || customerDetails.age || customerDetails.age.year || customerDetails.gender">
              <div *ngIf="customerDetails.firstName ||customerDetails.lastName" class="nameAge" >
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/name.png" />
                <div class="nameClr">{{customerDetails.firstName | capitalizeFirst}} {{customerDetails.lastName}}</div>
              </div>
              <div class="nameAgeYear" *ngIf="customerDetails && (customerDetails.age && customerDetails.age.year) || customerDetails.gender">
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/age.png" />
                <div class="nameClrOther">{{customerDetails.age.year}} years,</div>
                <div class="nameClrOther" *ngIf="customerDetails && customerDetails.gender">{{customerDetails.gender}}</div>
              </div>
            </div>
            <div *ngIf="customerDetails && customerDetails.address">
              <div class="infoDetails" style="justify-content:flex-start !important">
                <div><img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/address.png" /></div>
                <div class="nameClrOther">{{customerDetails.address}}</div>
              </div>
            </div>
        </div>
        <div *ngIf="customer_label || display_PatientId || customerDetails &&  (customerDetails.phoneNo ||customerDetails.id )">
          <div>
            <div class="nameClr" *ngIf="customer_label">{{customer_label | capitalizeFirst}} Id</div>
            <div class="infoDetails" style="justify-content:flex-start !important">
              <div><img  style="height:15px;width:15px" src="/assets/images/medicalReportIcon/id.png" /></div>
              <div *ngIf="display_PatientId" class="nameClrOther">{{display_PatientId}}</div>
            </div>
          </div>
          <div *ngIf="customerDetails && (customerDetails.phoneNo || customerDetails.countryCode) " class="mgTop">
            <div class="nameClr" >Phone</div>
            <div class="infoDetails">
              <div *ngIf="customerDetails && (customerDetails.phoneNo && customerDetails.phoneNo!=' ')">
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/phone.png" />
              </div>
              <div *ngIf="customerDetails" class="nameClrOther">
                {{customerDetails.countryCode ?customerDetails.countryCode : '+91'}} 
              </div>
              <div *ngIf="customerDetails.phoneNo" class="nameClrOther">{{customerDetails.phoneNo}} </div>
            </div> 
          </div>
           <div *ngIf="!customerDetails.phoneNo && customerDetails.id">
            <div class="nameClr" >Phone</div>
            <div class="infoDetails">
              <div *ngIf="!customerDetails.phoneNo && customerDetails.id">
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/phone.png" />
              </div>
              <div >{{customerDetails.countryCode ?customerDetails.countryCode : '+91'}} </div>
                <div class="nameClrOther" *ngIf="!customerDetails.phoneNo && customerDetails.id">9110762518</div>
            </div>
           </div>
        </div>
        <!---dob && email start---->
        <div *ngIf="customerDetails && (customerDetails.dob || customerDetails.email)">
          <div *ngIf="customerDetails && customerDetails.dob">
            <div class="nameClr">Date Of Birth</div>
            <div class="infoDetails" style="justify-content: flex-start !important;">
              <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/dob.png" />
              <div>
                <div class="nameClrOther" *ngIf="customerDetails.dob">{{customerDetails.dob |date:newDateFormat}} </div> 
              </div>
            </div>
          </div>

          <div *ngIf="customerDetails && customerDetails.email">
            <div class="nameClr">Email</div>
            <div class="infoDetails">
              <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/email.png" />
              <div>
                <div class="nameClrOther" *ngIf="customerDetails.email">{{customerDetails.email}} </div> 
              </div>
            </div>
          </div>
        </div>
         <!---dob && email end---->
        <!---prescriptiojn start-->
        <div class="prescriptionOuter" (click)="addPrescriptionAndClinical(patientId,'createPrescription')">
          <div>
            <img class="imageSize"  src="/assets/images/medicalReportIcon/prescription.png" />
          </div>
          <div class="nameClrOther">
            Create Prescription
          </div>
        </div>
         <!---prescriptiojn end-->
         <!---clinical notes start-->
        <div class="clinicalOuter" (click)="addPrescriptionAndClinical(patientId,'craeteClinicalnotes')">
          <div>
            <img class="imageSize"  src="/assets/images/medicalReportIcon/clinicalReport.png" />
          </div>
          <div class="nameClrOther">
           Add Clinical Notes
          </div>
        </div>
         <!---clinical noptes end-->
      </div>
    </div>
    <div class="col-xs-12 col-sm-12 mgn-up-10  previousVisit card" *ngIf="showHidepreviousDetails ">
      <app-common-innerloading-spinner *ngIf="loading_table"></app-common-innerloading-spinner>
      <div class="shadow">
        <div class="d-flex justify-content-between">
          <div class="pt-2">
            <span class="table-heading pl-2"><b>Previous Visits</b></span>
          </div>
        </div>
        <section class="report pt-2" *ngIf="visitcount !== 0">
          <ng-container *ngIf="!loading && !loading_table">
            <mat-table class="mat-scrool visit-tbl" [dataSource]="lastVisit_dataSource">
              <ng-container matColumnDef="consultationDate">
                <mat-header-cell *matHeaderCellDef class="visit-dt-cl"> <b class="headerClr">Date</b></mat-header-cell>
                <mat-cell *matCellDef="let visit"><div class="elementTextClr">{{getLastVisitDate(visit)}}</div></mat-cell>
              </ng-container>
              <ng-container matColumnDef="mrId">
                <mat-header-cell *matHeaderCellDef> <b class="headerClr">Medical Id</b></mat-header-cell>
                <mat-cell *matCellDef="let visit"><div class="elementTextClr">MR-{{visit.mrId}}</div></mat-cell>
              </ng-container>
              <ng-container matColumnDef="serviceName">
                <mat-header-cell *matHeaderCellDef class="visit-sr-cl"> <b class="headerClr">Service</b></mat-header-cell>
                <mat-cell *matCellDef="let visit"><div class="elementTextClr">{{getServiceName(visit)}}</div></mat-cell>
              </ng-container>
              <ng-container matColumnDef="userName">
                <mat-header-cell *matHeaderCellDef class="m-0 p-0 visit-dr-cl"> <b class="headerClr">Doctor</b></mat-header-cell>
                <mat-cell *matCellDef="let visit">
                  <div class="providerName">
                    <div class="arrowIcon">
                      <img style="margin-top: 5px" src="/assets/images/medicalReportIcon/arrow2.png"/>
                    </div>
                   <div class="elementTextClr"> {{getProviderName(visit)}}</div>
                  </div>
                </mat-cell>
              </ng-container>
              <ng-container matColumnDef="mr">
                <mat-header-cell *matHeaderCellDef class="visit-mr-cl"> <b class="headerClr">Medical Record</b></mat-header-cell>
                <mat-cell class="m-0 p-0" *matCellDef="let row;columns:lastVisit_displayedColumns">
                  <div [ngClass]="row.mrCreated === true ? 'createBtn':'ViewBtn'">
                    <div *ngIf="row.mrCreated">View</div>
                    <div *ngIf="!row.mrCreated">Create</div>
                  </div>
                </mat-cell>
              </ng-container>
              <mat-header-row class="matHeaderRow" *matHeaderRowDef="lastVisit_displayedColumns;sticky: true"></mat-header-row>
              <mat-row *matRowDef="let row;columns:lastVisit_displayedColumns" (click)="getMedicalRecord(row)"
                class="pointlist"></mat-row>
            </mat-table>
          </ng-container>
          <div class="clearfix"></div>
        </section>
      </div>
    </div>
      <!---prescription start-->
      <!-- <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 no-padding prescriptionNotes card"> -->
        <!-- (uploadFiles && uploadFiles.length===0)" -->
        <div class="p-1 pl0 pt-0 col-md-8 col-xs-12 col-sm-12 col-lg-8 prescriptionCreate shadow mgn-up-10" *ngIf="showHideAddPrescription">
          <div>
            <app-prescription></app-prescription>
          </div>
        </div>

        <!-- <span class="spaanOr" *ngIf="uploadFiles && uploadFiles.length===0">OR</span>
        <div class="mobileDevice" *ngIf="uploadFiles && uploadFiles.length===0">
          <span class="mobileOr">OR</span>
        </div>
        <div class="p-1 pr-0 col-md-4 col-xs-12 col-sm-12 col-lg-4 filesCreate" >
          <div class="shadow flexClass">
            <div class="text-dark text-center dashedClass" *ngIf="uploadFiles && uploadFiles.length == 0">
                <img style="height:50px;width:50px" src="/assets/images/medicalReportIcon/uploadIcon.png" />
                <div class="fileText">Click Your Files Here </div>
                <div>
                  <button type="button"class=" font-weight-bold confirmBtn pointer-cursor"(click)="uploadFileforMr()" >Upload file</button>
                </div>
            </div>
            <div class="pointer-cursor fileUpload text-dark text-center" *ngIf="uploadFiles && uploadFiles.length > 0">
                <img style="height:50px;width:50px" src="/assets/images/medicalReportIcon/uploadIcon.png" />
              <div class="twolConfirmBtn">
                <div>
                  <button type="button"class=" font-weight-bold confirmBtn pointer-cursor"(click)="uploadedFileforMr()" >Uploaded files</button>
                </div>
                <div>
                  <button type="button"class=" font-weight-bold confirmBtn pointer-cursor"(click)="uploadFileforMr()" >Upload file</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="p-1 pr-0 col-md-4 col-xs-12 col-sm-12 col-lg-4 filesCreate"*ngIf="uploadFiles && uploadFiles.length > 0" >
          <div class="shadow" style="height:100% !important">
            <div class="pl-2 uploadedText">Uploaded Prescription</div>
            <div class="hightLimit">
              <div *ngFor="let file of uploadFiles;let i=index" class="allFile">
                <div class="borderClass" >
                  <div class="allfileNameDetails">
                    <div class="allfileName">
                      <div class="fileType" *ngIf="file && file.type ">
                        <img height="25px" width="25px" [src]="getFileType(file.type)"  />
                      </div>
                      <div>
                        <div class="fileName"*ngIf="file && file.originalName">{{originalFilename(file.originalName)}}</div>
                        <div *ngIf="file && file.imageSize" class="fileSize" >
                          {{bytesToSize(file.imageSize)}}
                        </div>
                      </div>
                    </div>
                    <div class="imageClas">
                      <div (click)="dialogImgView(file)">
                        <img class="fileView"src="./assets/images/ImgeFileIcon/fileView.png" />
                      </div>
                      <div (click)="deletePrescriptionFile(file,i)">
                        <img class="removeIcon"src="./assets/images/ImgeFileIcon/removeCross.png" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            </div>
            </div> -->

      <!-- </div> -->
      <!---prescription end-->
      <!-- <hr> -->
      <!----clinical notess ection start-->
      <div class="p-1 pl0 pt-0 col-md-8 col-xs-12 col-sm-12 col-lg-8 prescriptionCreate shadow mgn-up-10" *ngIf="showHideClinicalNotes">
        <div>
          <app-clinicalnotes [details]='customerDetails' [type]='bookingType' [b_id]="bookingId">
          </app-clinicalnotes>
        </div>
      </div>
 <!----clinical notess ection end-->
  </div>
</section>



























<section *ngIf="!loading && viewVisitDetails" class="medical-record">
  <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 mgn-up-10 no-padding-small">
    <div class="col-xs-12 col-sm-12 mgn-up-10 card">
      <div class="infoDetails shadow">
        <div *ngIf="customerDetails">
          <div  *ngIf="customerDetails && customerDetails.gender === 'male'">
            <img class="imGBorderRadius" src="assets/images/mr_male.svg"  />
          </div>
          <div  *ngIf="customerDetails && customerDetails.gender === 'female'">
            <img class="imGBorderRadius" src="assets/images/mr_female.svg"  />
          </div>
          <div  *ngIf="customerDetails.gender != 'male' && customerDetails.gender != 'female'">
            <img class="imGBorderRadius" src="assets/images/undefinedUser.png"  />
          </div>
            <div *ngIf="customerDetails.firstName ||customerDetails.lastName || customerDetails.age || customerDetails.age.year || customerDetails.gender">
              <div *ngIf="customerDetails.firstName ||customerDetails.lastName" class="nameAge" >
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/name.png" />
                <div class="nameClr">{{customerDetails.firstName | capitalizeFirst}} {{customerDetails.lastName}}</div>
              </div>
              <div class="nameAgeYear" *ngIf="customerDetails && (customerDetails.age && customerDetails.age.year) || customerDetails.gender">
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/age.png" />
                <div class="nameClrOther">{{customerDetails.age.year}} years,</div>
                <div class="nameClrOther" *ngIf="customerDetails && customerDetails.gender">{{customerDetails.gender}}</div>
              </div>
            </div>
            <div *ngIf="customerDetails && customerDetails.address">
              <div class="infoDetails" style="justify-content:flex-start !important">
                <div><img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/address.png" /></div>
                <div class="nameClrOther">{{customerDetails.address}}</div>
              </div>
            </div>
        </div>
        <div *ngIf="customer_label || display_PatientId || customerDetails &&  (customerDetails.phoneNo ||customerDetails.id )">
          <div>
            <div class="nameClr" *ngIf="customer_label">{{customer_label | capitalizeFirst}} Id</div>
            <div class="infoDetails" style="justify-content:flex-start !important">
              <div><img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/id.png" /></div>
              <div *ngIf="display_PatientId" class="nameClrOther">{{display_PatientId}}</div>
            </div>
          </div>
          <div *ngIf="customerDetails && (customerDetails.phoneNo || customerDetails.countryCode) " >
            <div class="nameClr" >Phone</div>
            <div class="infoDetails">
              <div *ngIf="customerDetails && (customerDetails.phoneNo && customerDetails.phoneNo!=' ')">
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/phone.png" />
              </div>
              <div *ngIf="customerDetails" class="nameClrOther">
                {{customerDetails.countryCode ?customerDetails.countryCode : '+91'}} 
              </div>
              <div *ngIf="customerDetails.phoneNo" class="nameClrOther">{{customerDetails.phoneNo}} </div>
            </div> 
          </div>
           <div *ngIf="!customerDetails.phoneNo && customerDetails.id">
            <div class="nameClr" >Phone</div>
            <div class="infoDetails">
              <div *ngIf="!customerDetails.phoneNo && customerDetails.id">
                <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/phone.png" />
              </div>
              <div >{{customerDetails.countryCode ?customerDetails.countryCode : '+91'}} </div>
                <div class="nameClrOther" *ngIf="!customerDetails.phoneNo && customerDetails.id">9110762518</div>
            </div>
           </div>
        </div>
        <!---dob && email start---->
        <div *ngIf="customerDetails && (customerDetails.dob || customerDetails.email)">
          <div *ngIf="customerDetails && customerDetails.dob">
            <div class="nameClr">Date Of Birth</div>
            <div class="infoDetails" style="justify-content: flex-start !important;">
              <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/dob.png" />
              <div>
                <div class="nameClrOther" *ngIf="customerDetails.dob">{{customerDetails.dob |date:newDateFormat}} </div> 
              </div>
            </div>
          </div>

          <div *ngIf="customerDetails && customerDetails.email">
            <div class="nameClr">Email</div>
            <div class="infoDetails">
              <img style="height:15px;width:15px" src="/assets/images/medicalReportIcon/email.png" />
              <div>
                <div class="nameClrOther" *ngIf="customerDetails.email">{{customerDetails.email}} </div> 
              </div>
            </div>
          </div>
        </div>
         <!---dob && email end---->
      </div>
    </div>

      <div class="col-xs-12 col-sm-12 mgn-up-10 card">
        <div class="shadow flexClass1">
          <div class="recordInfo">
            <div class="mrNumber1">
              <div>Medical Records</div>
              <div *ngIf="mrId !== 0">1</div>
            </div>
            <div class="mrNumber2">
              <div>Medical Record ID</div>
              <div *ngIf="mrId !== 0"> {{mrNumber}}</div>
            </div>
          </div>
          <div class="dateCreate">
            <img style="height:20px;width:20px" src="/assets/images/medicalReportIcon/calendar.png" />
            <div *ngIf="mrId !== 0" class="dateClr">{{getDate(mrCreatedDate)}}</div>
          </div>
          <div class="dateCreate">
            <img style="height:20px;width:20px" src="/assets/images/medicalReportIcon/serviceIcon.png" />
            <div *ngIf="mrId !== 0 && serviceName" class="dateClr">{{serviceName | capitalizeFirst}}</div>
          </div>
          <div class="dateCreate" *ngIf="doctorBName || (!doctorBName && doctorName)">
            <img style="height:20px;width:20px" src="/assets/images/medicalReportIcon/doctorIcon.png" />
            <div *ngIf="doctorBName" class="dateClr">{{doctorBName | capitalizeFirst}}</div>
            <div *ngIf="!doctorBName && doctorName" class="dateClr">{{doctorName | capitalizeFirst}}</div>
          </div>
        </div>
      </div>


    <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 mgn-up-10 card" >
      <div  >
        <div [ngClass]="{'prescription-details':uploadFiles.length>0}" class=" p-1 pl0 pt-0">
          <app-prescription [viewVisitDetails]="viewVisitDetails"></app-prescription>
        </div>
      </div>
    </div>


    <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 mgn-up-10 card" >
      <div  >
        <div class=" p-1 pl0 pt-0">
          <app-clinicalnotes [mRListUsingId]="mRListUsingId" [showClinicalNotesDetails]="'true'"></app-clinicalnotes>
        </div>
      </div>
    </div>

  </div>
  
</section>