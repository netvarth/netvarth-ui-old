<app-common-innerloading-spinner *ngIf="loading"></app-common-innerloading-spinner>
<form [formGroup]="amForm" class="ynw-common-form" novalidate *ngIf="!loading" style="padding:25px">
  <div class="createTxtIcon">
    <div class="share">
      <div class="createTxt">Share Prescription</div>
      <div class="shareTxt">Share Your Medical Prescription to others</div>
    </div>
    <div style=" cursor: pointer;" mat-dialog-close class="modal_close" tabindex="-1" class="closeIcon"
      #tooltip="matTooltip" matTooltip="Close" [matTooltipPosition]="'below'">
      <mat-icon>clear</mat-icon>
    </div>
  </div>
  <mat-dialog-content class="dialogContent">
    <div style="margin-right: 5px;">
      <div>
        <div class="leadTitle">
          <div class="labelSize">Share with whom</div>
          <div class="astericColor">*</div>
        </div>
        <div class="fieldPadding">
          <mat-select name="item" [(ngModel)]="sharewith" placeholder="Share with whom"
            [ngModelOptions]="{standalone: true}" (selectionChange)="onUserSelect($event)"
            class="form-control widthWebKit">
            <mat-option [value]="item.id" *ngFor="let item of msgreceivers">
              <div *ngIf="item && item.name">{{item.name}}</div>
            </mat-option>
          </mat-select>
        </div>
      </div>
    </div>
    <div style="margin-right: 5px;">
      <div class="leadTitle">
        <div class="labelSize">Message</div>
        <div class="astericColor">*</div>
      </div>
      <div class="fieldPadding">
        <textarea (ngModelChange)="messageBoxhandle(message.value)" rowa="10" class="form-control widthWebKit"
          formControlName="message" #message (keyup)="autoGrowTextZone($event)" maxlength="120"
          placeholder="Enter message description">
            </textarea>
      </div>
    </div>
    <div class="formTop" *ngIf="showthirdparty" style="margin-right: 5px;">
      <div class="leadTitle">
        <div class="labelSize">Email</div>
        <div class="astericColor">*</div>
      </div>
      <div>
        <div class="fieldPadding">
          <input type="text" class="form-control widthWebKit" id="thirdpartyemail" (keyup)="resetApiErrors()"
            placeholder="Email" [(ngModel)]="thirdpartyemail" [ngModelOptions]="{standalone: true}" autocomplete="off">
        </div>
      </div>
    </div>
    <div class="form-group" *ngIf="!showthirdparty" style="margin-top: 10px;margin-bottom: 0px !important;">
      <span class="docText" *ngIf="!(mrPrescriptionDetails &&  mrPrescriptionDetails[0].keyName)
            &&(this.phon==='' && this.email_id==='' && this.IsTelegramDisable===false)
            ">Share prescription Via</span>
      <span class="docText" *ngIf="(mrPrescriptionDetails && mrPrescriptionDetails[0].keyName)">Your presciption will
        share Via</span>
      <div class="coupon-outer">
        <mat-checkbox [ngClass]="{hideClass: (!phon || phon === 'null') || is_noSMS || countryCode !='+91'}"
          [disabled]="(!phon || phon === 'null') || is_noSMS || countryCode !='+91'" class="example-margin"
          [(ngModel)]="sms" [ngModelOptions]="{standalone: true}">
          <span class="labelCheckName">SMS</span>
        </mat-checkbox>
        <mat-checkbox [ngClass]="{hideClass: !email_id}" [disabled]=" !email_id" class=" example-margin"
          [(ngModel)]="email" [ngModelOptions]="{standalone: true}"><span class="labelCheckName">Email</span>
        </mat-checkbox>
        <mat-checkbox [ngClass]="{hideClass: !phon ||  phon === 'null'}" [disabled]="!phon ||  phon === 'null'"
          class=" example-margin" [(ngModel)]="pushnotify" [ngModelOptions]="{standalone: true}">
          <span class="labelCheckName">App notification</span>
        </mat-checkbox>
        <mat-checkbox class=" example-margin" [ngClass]="{hideClass: !IsTelegramDisable}" *ngIf="!IsTelegramDisable"
          [(ngModel)]="telegram" [ngModelOptions]="{standalone: true}">
          <span class="labelCheckName"> Telegram</span>
        </mat-checkbox>
        <mat-checkbox class=" example-margin" [ngClass]="{hideClass: (!phon || phon === 'null') || countryCode !='+91'}"
          [disabled]="(!phon || phon === 'null')  || countryCode !='+91'" [(ngModel)]="whatsApp"
          [ngModelOptions]="{standalone: true}">
          <span class="labelCheckName"> Whatsapp</span>
        </mat-checkbox>
      </div>
      <!-- <div style="color: red;" class="errorCls" *ngIf="!sms && !email && !pushnotify && !telegram">
                Make sure the options you choose are valid/ enabled
                </div> -->
      <!-- <div class="sms_credit_warn mgn-up-10" *ngIf="is_smsLow">{{smsWarnMsg}} <a (click)="gotoSmsAddon()">{{is_noSMS? 'Purchase now': 'Upgrade now'}}</a>{{is_noSMS? '' : ' to avoid undelivered SMS'}}</div> -->
    </div>
    <!-- *ngIf="!showthirdparty" -->

    <div class="sms_credit_warn mgn-up-10" *ngIf="is_smsLow && !showthirdparty ">{{smsWarnMsg}} <a
        (click)="gotoSmsAddon()">{{is_noSMS? 'Purchase now': 'Upgrade now'}}</a>
      {{is_noSMS? '' : ' to avoid undelivered SMS'}}</div>
    <div *ngIf="showthirdparty">
      <span class="sharePresText" *ngIf="!mrPrescriptionDetails[0].keyName">We will create a PDF of your prescription
        and will share Via
        email.</span>
      <span class="sharePresText" *ngIf="mrPrescriptionDetails[0].keyName">Your prescription will be shared Via
        email.</span>
    </div>

    <div class="btnClass">
      <button type="button" mat-dialog-close type="button" class="btn btn-primary font-weight-bold cancelBtn"
        [disabled]="disableButton">Cancel</button>
      <button (click)="shareBtn(amForm)" type="submit" [disabled]="!amForm.valid || disable " type="button"
        class="btn btn-primary font-weight-bold confirmBtn">Share<i class="fa fa-spinner fa-spin"
          *ngIf="sharebtnloading"></i></button>
    </div>
  </mat-dialog-content>
</form>
