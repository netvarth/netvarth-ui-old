<!-- <section>
    <app-breadcrumb [breadcrumbs]="breadcrumbs"></app-breadcrumb>
</section> -->
<section class="">
    <div class="card title-gb">
        <h5 class="mgn-up-10"> 
            <!-- <button type="button" class="btn default profile-back" (click)="redirecToUsersl()">
                <span class="fa fa-chevron-left">&nbsp;Back</span>
            </button>&nbsp;&nbsp;&nbsp; -->
            <span class="fa fa-arrow-left pointer-cursor" (click)="redirecToUsersl()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
            {{usercaption}}
        </h5>
    </div>
</section>
<section class="user-create-window">
    <div class="content loc-list bsp">
        <div class="col-md-12 no-padding-small">
            <div class="row">
                <div class="card p0">
                    <div class="copy locd">
                        <div class="lbl col-md-12 no padding"> 
                            <div class="card" *ngIf="api_loading">
                                <app-common-innerloading-spinner></app-common-innerloading-spinner>
                            </div>
                            <div class="col-md-12" *ngIf="actionparam.type !== 'view' && !api_loading">
                                <div  class="create-dept">
                                    <ul class="info-lst serviceadd-info">
                                            <li *ngIf="isadminPrivilege"> <a class="pointlist"
                                                        routerLink="/provider/license/addons">To create an user, your license package needs to  be Premium or higher.In order to add additional users, you can purchase  'Multi User'
                                                        add-on from the Subscription Plan section.</a>
                                            </li>
                                            <!-- <li> <a class="pointlist"
                                                (click)="enabledepartment()">To
                                                complete the process Department feature needs to enabled to add a doctor.</a> 
                                            </li> -->
                                    </ul>
                                </div>
                                <!-- <div *ngIf="filterBydept" class="create-dept">
                                    <ul class="info-lst serviceadd-info">
                                        <li> <a class="pointlist"
                                            routerLink="/provider/license/addons">To create a User, You need to purchase a 'Multi User'
                                            add-on from the License section.</a>
                                        </li>
                                    </ul>
                                </div> -->
                                <form [formGroup]="userForm" (ngSubmit)="userForm.valid &&
onSubmit(userForm.value)" class="ynw-common-form-nm" (keyup)="resetApiErrors()">
                                    <!-- <div class="col-md-6 col-sm-6 col-xs-12 " *ngIf="type !== 'ADMIN'">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <mat-select formControlName="selectedUserType"
                                                    placeholder="Choose Usertype *"
                                                    (selectionChange)="onUserSelect($event)">
                                                    <mat-option *ngFor="let user of userTypesFormfill" [value]="user">
                                                        {{user}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div> -->
                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <input matInput type="text" class="form-control" id="first_name"
                                                    placeholder="First Name *" formControlName="first_name"
                                                    autocomplete="off">
                                            </mat-form-field>
                                            <app-field-error-display
                                                [displayError]="fed_service.isFieldValid(userForm,'first_name')"
                                                [errorMsgs]="fed_service.getErrorMessage(userForm,'first_name',
                        {
                        'required' : 'First name is required',
                        'pattern' : 'Only alphabets are allowed'
                        })">
                                            </app-field-error-display>
                                            <app-field-error-display [displayError]="true"
                                                *ngIf="fnameerror != null && !fed_service.isFieldValid(userForm,'first_name')"
                                                [errorMsg]="fnameerror">
                                            </app-field-error-display>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <input matInput type="text" class="form-control" id="last_name"
                                                    placeholder="Last Name *" formControlName="last_name"
                                                    autocomplete="off">
                                            </mat-form-field>
                                            <app-field-error-display
                                                [displayError]="fed_service.isFieldValid(userForm,'last_name')"
                                                [errorMsgs]="fed_service.getErrorMessage(userForm,'last_name',
                        {
                        'required' : 'Last name is required',
                        'pattern' : 'Only alphabets are allowed'
                        })">
                                            </app-field-error-display>
                                            <app-field-error-display [displayError]="true"
                                                *ngIf="!fed_service.isFieldValid(userForm,'last_name')"
                                                [errorMsg]="lnameerror">
                                            </app-field-error-display>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>

                                    <!-- <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <input matInput type="text" class="form-control" id="add_ress"
                                                    placeholder="Address" formControlName="address" autocomplete="off">
                                            </mat-form-field>

                                        </div>
                                    </div>

                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <input matInput type="text" class="form-control" id="city"
                                                    placeholder="City" formControlName="city" autocomplete="off">
                                            </mat-form-field>

                                        </div>
                                    </div>
                                    <div class="clearfix"></div> -->
                                    <!-- <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <input matInput type="text" class="form-control" id="state"
                                                    placeholder="State" formControlName="state" autocomplete="off">
                                            </mat-form-field>

                                        </div>
                                    </div> -->
                                    <!-- <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group mobile-field" style="width: 100%">
                                            <mat-form-field>
                                                <div class="input-group">
                                                    <div class="input-group-prepend mob-prefix">
                                                        <span class="input-group-text" id="">{{mob_prefix_cap}}</span>
                                                    </div>
                                                    <input type="text" (keypress)="isNumeric($event)" matInput
                                                        class="form-control text-width" id="phonenumber"
                                                        placeholder="Enter Mobile # " formControlName="phonenumber"
                                                        autocomplete="off" maxlength="10">
                                                </div>
                                            </mat-form-field>
                                            <app-field-error-display
                                                [displayError]="fed_service.isFieldValid(userForm,'phonenumber')"
                                                [errorMsgs]="fed_service.getErrorMessage(userForm,'phonenumber',
            {
            'minlength' : 'Enter a 10 digit mobile number',
            'maxlength' : 'Enter a 10 digit mobile number',
            'pattern' : 'Enter a 10 digit mobile number'
            })">
                                            </app-field-error-display>
                                        </div>
                                    </div> -->
                                    <div class="col-md-6 col-sm-6 col-xs-12" style="display: flex;">
                                        <div class="col-md-4 col-sm-4 col-xs-4 mgn-rt-10 no-padding">
                                            <div class="form-group">
                                                <mat-form-field>
                                                        <input type="text"  (keypress)="isNumericSign($event)" matInput
                                                        class="input-group-text" id="countryCode"
                                                        placeholder="Country code " formControlName="countryCode"
                                                        autocomplete="off" maxlength="5">
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="col-md-8 col-sm-8 col-xs-8 no-padding">
                                            <div class="form-group">

                                            <mat-form-field>
                                                    <input type="text" (keypress)="isNumeric($event)" matInput
                                                        class="form-control text-width" id="phonenumber"
                                                        placeholder="Enter Mobile # " formControlName="phonenumber"
                                                        autocomplete="off"  maxlength="15">
                                            </mat-form-field>
                                            <app-field-error-display
                                                [displayError]="fed_service.isFieldValid(userForm,'phonenumber')"
                                                [errorMsgs]="fed_service.getErrorMessage(userForm,'phonenumber',
                                                    {
                                                    'pattern' : 'Enter number only'
                                                    })">
                                            </app-field-error-display>
                                            </div>
                                        </div>  
                                    </div>
                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <input matInput type="text" class="form-control" id="email"
                                                    formControlName="email" placeholder="Email(user@xyz.com)"
                                                    autocomplete="off">
                                            </mat-form-field>
                                            <app-field-error-display [displayError]="true"
                                                *ngIf="emailerror != null && !fed_service.isFieldValid(userForm,'email')"
                                                [errorMsg]="emailerror">
                                            </app-field-error-display>
                                        </div>
                                    </div>

                                    <div class="clearfix"></div>


<!-- *******User Telegram and what's up number ************ -->
                                    <!-- <div class="col-md-6 col-sm-6 col-xs-12"  style="display: flex;" *ngIf="showPrvdrFields">
                                        <div class="col-md-4 col-sm-4 col-xs-4 mgn-rt-10 no-padding">
                                            <div class="form-group">
                                                <mat-form-field>
                                                        <input type="text" (keypress)="isNumericSign($event)" matInput
                                                        class="input-group-text" id="countryCode_whatsapp"
                                                        placeholder="Country code " formControlName="countryCode_whatsapp"
                                                        autocomplete="off" maxlength="5">
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="col-md-8 col-sm-8 col-xs-8 no-padding">
                                            <div class="form-group">
                                                <mat-form-field>
                                                        <input type="text" (keypress)="isNumeric($event)" matInput
                                                            class="form-control text-width" id="whatsappumber"
                                                            placeholder="Enter whatsapp # " formControlName="whatsappumber"
                                                            autocomplete="off">
                                                </mat-form-field>
                                                <app-field-error-display
                                                    [displayError]="fed_service.isFieldValid(userForm,'whatsappumber')"
                                                    [errorMsgs]="fed_service.getErrorMessage(userForm,'whatsappumber',
                        {
                        'minlength' : 'Enter a 10 digit whatsapp number',
                        'maxlength' : 'Enter a 10 digit whatsapp number',
                        'pattern' : 'Enter a 10 digit whatsapp number'
                        })">
                                                </app-field-error-display>
                                            </div>
                                    </div>
                                  </div>
                                  <div class="col-md-6 col-sm-6 col-xs-12" style="display: flex;" *ngIf="showPrvdrFields">
                                        <div class="col-md-4 col-sm-4 col-xs-4 mgn-rt-10 no-padding">
                                            <div class="form-group">
                                                <mat-form-field>
                                                        <input type="text"  (keypress)="isNumericSign($event)"  matInput
                                                        class="input-group-text" id="countryCode_telegram"
                                                        placeholder="Country code " formControlName="countryCode_telegram"
                                                        autocomplete="off" maxlength="5">
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="col-md-8 col-sm-8 col-xs-8 no-padding">
                                        <div class="form-group">
                                            <mat-form-field>
                                                    <input type="text" (keypress)="isNumeric($event)" matInput
                                                        class="form-control text-width" id="telegramnumber"
                                                        placeholder="Enter Telegram # " formControlName="telegramnumber"
                                                        autocomplete="off">
                                            </mat-form-field>
                                            <app-field-error-display
                                                [displayError]="fed_service.isFieldValid(userForm,'telegramnumber')"
                                                [errorMsgs]="fed_service.getErrorMessage(userForm,'telegramnumber',
                    {
                    'minlength' : 'Enter a 10 digit Telegram number',
                    'maxlength' : 'Enter a 10 digit Telegram number',
                    'pattern' : 'Enter a 10 digit Telegram number'
                    })">
                                            </app-field-error-display>
                                        </div>
                                    </div>
                                </div>
                                    <div class="clearfix"></div> -->
       <!-- close telegarm and whatsup  part  -->



                                    <!-- <div class="col-md-6 col-sm-6 col-xs-12">
    <div class="form-group">
        <mat-form-field>
            <input class="form-control" placeholder="Enter default password *"
                matInput formControlName="password" reverse="true" type="password">
        </mat-form-field>
        <app-field-error-display
            [displayError]="fed_service.isFieldValid(userForm,'password')"
            [errorMsgs]="fed_service.getErrorMessage(userForm,'password',
                {'required' : 'Enter Password Required',
                'pattern' : 'Use minimum 8 characters with atleast one uppercase, lowercase and number'})">
        </app-field-error-display>
    </div>
</div> -->
                                    <!-- <div class="col-md-6 col-sm-6 col-xs-12" *ngIf="showPrvdrFields">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <mat-select placeholder="{{select_subdomain_cap}}" subdom
                                                    formControlName="selectedSubDomain"  (selectionChange)="resetApiErrors()"#subdom>
                                                    <mat-option *ngFor="let subdomain of subDomains; let i = index"
                                                        [value]="subdomain.id">
                                                        {{subdomain.displayName}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                            <app-field-error-display [displayError]="true"
                                                    *ngIf="subdomainerror != null && !fed_service.isFieldValid(userForm,'selectedSubDomain')"
                                                    [errorMsg]="subdomainerror">
                                                </app-field-error-display>{{subdomainerror}}
                                        </div>
                                    </div> -->
                                    <div class="col-md-6 col-sm-6 col-xs-12 ">
                                            <div class="form-group mgn-up-20" *ngIf="actionparam.type === 'edit'">
                                                <label>User Type : {{type}}</label>
                                                    <!-- <mat-form-field>
                                                            <input matInput readonly type="text" class="form-control" value="{{type}}"
                                                                placeholder="Usertype" 
                                                                autocomplete="off">
                                                        </mat-form-field> -->
                                                </div>
                                        <div class="form-group" *ngIf="actionparam.type !== 'edit'"> 
                                            <mat-form-field>
                                                <mat-select formControlName="selectedUserType"
                                                    placeholder="Choose Usertype *"
                                                    (selectionChange)="onUserSelect($event)">
                                                    <mat-option *ngFor="let user of userTypesFormfill" [value]="user.value">
                                                        {{user.name}}
                                                    </mat-option>
                                                </mat-select>
                                            </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="col-md-6 col-sm-6 col-xs-12"
                                        *ngIf="filterBydept && departments.length > 0 && showPrvdrFields">
                                        <div class="form-group">
                                            <mat-form-field *ngIf="deptLength == 1">
                                             <input matInput *ngFor="let dept of departments" [readonly]="true" 
                                                placeholder="Select department *"  value="{{dept.departmentName | capitalizeFirst}}">
                                            </mat-form-field>
                                             <mat-form-field *ngIf="deptLength > 1">
                                               <mat-select placeholder="Select department *" formControlName="selectedDepartment" #deptsel>
                                                  <mat-option *ngFor="let dept of departments"
                                                     [value]="dept.departmentId">
                                                        {{dept.departmentName}}
                                                   </mat-option>
                                                 </mat-select>
                                             </mat-form-field>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>







                                    <!-- *******User Telegram and what's up number ************ -->
                                    <div class="col-md-6 col-sm-6 col-xs-12"  style="display: flex;" *ngIf="showPrvdrFields">
                                        <div class="col-md-4 col-sm-4 col-xs-4 mgn-rt-10 no-padding">
                                            <div class="form-group">
                                                <mat-form-field>
                                                        <input type="text" (keypress)="isNumericSign($event)" matInput
                                                        class="input-group-text" id="countryCode_whatsapp"
                                                        placeholder="Country code " formControlName="countryCode_whatsapp"
                                                        autocomplete="off" maxlength="5">
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="col-md-8 col-sm-8 col-xs-8 no-padding">
                                            <div class="form-group">
                                                <mat-form-field>
                                                        <input type="text" (keypress)="isNumeric($event)" matInput
                                                            class="form-control text-width" id="whatsappumber"
                                                            placeholder="Enter whatsapp # " formControlName="whatsappumber"
                                                            autocomplete="off">
                                                </mat-form-field>
                                                <app-field-error-display
                                                    [displayError]="fed_service.isFieldValid(userForm,'whatsappumber')"
                                                    [errorMsgs]="fed_service.getErrorMessage(userForm,'whatsappumber',
                        {
                        'minlength' : 'Enter a 10 digit whatsapp number',
                        'maxlength' : 'Enter a 10 digit whatsapp number',
                        'pattern' : 'Enter a 10 digit whatsapp number'
                        })">
                                                </app-field-error-display>
                                            </div>
                                    </div>
                                  </div>
                                  <div class="col-md-6 col-sm-6 col-xs-12" style="display: flex;" *ngIf="showPrvdrFields">
                                        <div class="col-md-4 col-sm-4 col-xs-4 mgn-rt-10 no-padding">
                                            <div class="form-group">
                                                <mat-form-field>
                                                        <input type="text"  (keypress)="isNumericSign($event)"  matInput
                                                        class="input-group-text" id="countryCode_telegram"
                                                        placeholder="Country code " formControlName="countryCode_telegram"
                                                        autocomplete="off" maxlength="5">
                                                </mat-form-field>
                                            </div>
                                        </div>
                                        <div class="col-md-8 col-sm-8 col-xs-8 no-padding">
                                        <div class="form-group">
                                            <mat-form-field>
                                                    <input type="text" (keypress)="isNumeric($event)" matInput
                                                        class="form-control text-width" id="telegramnumber"
                                                        placeholder="Enter Telegram # " formControlName="telegramnumber"
                                                        autocomplete="off">
                                            </mat-form-field>
                                            <app-field-error-display
                                                [displayError]="fed_service.isFieldValid(userForm,'telegramnumber')"
                                                [errorMsgs]="fed_service.getErrorMessage(userForm,'telegramnumber',
                    {
                    'minlength' : 'Enter a 10 digit Telegram number',
                    'maxlength' : 'Enter a 10 digit Telegram number',
                    'pattern' : 'Enter a 10 digit Telegram number'
                    })">
                                            </app-field-error-display>
                                        </div>
                                    </div>
                                </div>
                                    <div class="clearfix"></div>
       <!-- close telegarm and whatsup  part  -->

                                    <div class="col-md-6 col-sm-6 col-xs-12">
                                        <div class="form-group">
                                            <mat-form-field>
                                                <input matInput type="text" class="form-control" id="postalCode"
                                                    placeholder="Postal Code /ZIP*" formControlName="postalCode" (keyup)="keyPressed($event.target.value)"
                                                    (blur)="blurPincodeQty($event.target.value)"  autocomplete="off">
                                            </mat-form-field>
                                            <app-field-error-display
                                                [displayError]="fed_service.isFieldValid(userForm,'postalCode')"
                                                [errorMsgs]="fed_service.getErrorMessage(userForm,'postalCode',
                        {
                        'required' : 'Please enter Postal Code ',
                        'minlength' : 'Enter a 6 digit Postal Code',
                        'maxlength' : 'Enter a 6 digit Postal Code',
                        'pattern' : 'Only numbers are allowed'
                        })">
                                            </app-field-error-display>
                                            <app-field-error-display [displayError]="true"
                                                *ngIf="!fed_service.isFieldValid(userForm,'postalCode')"
                                                [errorMsg]="lnameerror">
                                            </app-field-error-display>
                                        </div>
                                    </div>
                                    <div class="clearfix"></div>

                                    

                                    <div class="col-md-6 col-sm-6 col-xs-12">          
                                        <div *ngIf="actionparam.type === 'edit' && editloc" > 
                                            <span *ngIf="user_data.city && user_data.state"> <i class="fa fa-map-marker mgn-rt-5" aria-hidden="true"></i> {{user_data.city}},&nbsp;{{user_data.state}}</span>
                                         
                                        </div>   
                                        <div *ngIf="showloc">
                                            <div *ngFor="let locationDetails of locations; let idx = index">
                                                <mat-radio-button [checked]="idx === 0">
                                                {{locationDetails.Name}},&nbsp;{{locationDetails.Block}},&nbsp;{{locationDetails.Region}},&nbsp;{{locationDetails.State}}
                                                </mat-radio-button>
                                            </div>
                                        </div>
                                    </div>
                                <div class="clearfix"></div>
                            


                                    <div class="col-md-6 col-sm-6 col-xs-12" style="margin-top: 10px;" *ngIf="type != 'ADMIN'">
                                        <div class="form-group">
                                            <mat-checkbox  formControlName="privileges">
                                                Admin Privileges
                                            </mat-checkbox>
                                            <div class="form-level-settings">This privilege will allow the user to create new user, modify existing user etc.</div>
                                        </div>
                                    </div>

                                    <div class="col-md-12 col-sm-12 col-xs-12 mgn-up-20">
                                        <h3><a class="learnmore-pointer" (click)="advancedClick()"> Additional details</a></h3>
                                    </div>
                                    
                                    <div class="col-md-12 col-sm-12 col-xs-12 no-padding mgn-up-20" *ngIf="showAdvancedSection">
                                        <!-- <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="form-group">
                                                <mat-form-field>
                                                    <input matInput type="text" class="form-control" id="email"
                                                        formControlName="email" placeholder="Email(user@xyz.com)"
                                                        autocomplete="off" onpaste="return false;" oncopy="return false"
                                                        oncut="return false" ondrag="return false"
                                                        ondrop="return false">
                                                </mat-form-field>
                                                <app-field-error-display [displayError]="true"
                                                    *ngIf="emailerror != null && !fed_service.isFieldValid(userForm,'email')"
                                                    [errorMsg]="emailerror">
                                                </app-field-error-display>
                                            </div>
                                        </div> -->
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="form-group ">
                                                <label class="col-form-label gender mgn-up-10" for="gender">{{gender_cap}} </label>
                                                <mat-radio-group formControlName="gender">
                                                    <mat-radio-button class="mgn-rt-10" value="male">{{male_cap}}
                                                    </mat-radio-button>
                                                    <mat-radio-button class="mgn-rt-10" value="female">{{female_cap}}</mat-radio-button>
                                                    <mat-radio-button value="other">Other</mat-radio-button>
                                                </mat-radio-group>
                                                <app-field-error-display
                                                    [displayError]="fed_service.isFieldValid(userForm,'gender')"
                                                    errorMsg="Please select the gender.">
                                                </app-field-error-display>
                                            </div>
                                        </div>
                                        <div class="col-md-6 col-sm-6 col-xs-12">
                                            <div class="form-group col-md-12 no-padding picker-form-group">
                                                <mat-form-field>
                                                    <input matInput [matDatepicker]="picker" placeholder="Date of birth"
                                                        #inputdob formControlName="dob" [max]="tday" [min]="minday"
                                                        disabled class="nofocus" tabindex="-1">
                                                    <mat-datepicker-toggle matSuffix [for]="picker">
                                                    </mat-datepicker-toggle>
                                                    <mat-datepicker #picker [disabled]="false"></mat-datepicker>
                                                </mat-form-field>
                                                <app-field-error-display
                                                    [displayError]="fed_service.isFieldValid(userForm,'dob')"
                                                    errorMsg="Please select the date of birth.">
                                                </app-field-error-display>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-12 col-sm-12 col-xs-12">
                                        <div class="actiondiv labelsave" style="margin-top: 20px;position: relative; display: inline-flex;">
                                            <button (click)="onCancel()" type="button"
                                                class="cs-btn bt2">{{cancel_btn}}</button>
                                            &nbsp;
                                            <button type="submit" mat-button [disabled]="!userForm.valid"
                                                class="cs-btn bt2">{{button_title}}</button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </div>
            </div>
<!-- 
            <div class="row"  *ngIf="userId && showPrvdrFields " >
                <div class="card p0">
                    <span class="b-link onlineProfile" (click)="onlineProfile()">
                        <h5>Online profile</h5>
                        <span class="form-level-settings">Manage profile name and basic information of you or your business here.</span>
                    </span>
                </div>
            </div> -->
        </div>
    </div>
    <div class="clearfix"></div>
</section>