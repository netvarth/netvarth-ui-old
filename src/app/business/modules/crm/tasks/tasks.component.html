<section class="card">
  <div class="row d-flex">
    <div class="col-md-4 col-lg-4 col-sm-5 col-xs-5 headerDetails">
      <div class="dash-head">
        <div><i style="color:#1D3E77 !important" class="fa fa-arrow-left pointer-cursor" (click)="goback()"></i></div>
        <div style="color: #1D3E77;" *ngIf="headerName">{{headerName}}</div>
      </div>
    </div>
    <div class="col-md-8 col-lg-8 col-sm-7 col-xs-7 headerDetailss">
      <div class="pull-right">
        <div class="navbar-custom-menu">
          <ul class="nav navbar-nav">
            <li class="dropdown messages-menu loc-lst queue-menu-1 pull-right locationName">
              <i class="icon-location dropdown-toggle " data-toggle="dropdown" style="color: #1D3E77"></i>
              <a href="#" class="dropdown-toggle navbar-item-color bold" data-toggle="dropdown"
                *ngIf="selected_location && selected_location.place" style="color: #1D3E77">
                {{selected_location.place | capitalizeFirst}}
              </a>
              <ul class="dropdown-menu">
                <li>
                  <ul *ngIf="selected_location" class="menu">
                    <li *ngFor="let location of locations;let i = index"
                      [ngClass]="{'active': (location.place === selected_location.place)}">
                      <a class="pointer-cursor" (click)="onChangeLocationSelect(i)" style="color: #1D3E77">
                        <h4 *ngIf="location && location.place && location.place.length>='27'">
                          {{ location.place.substring(0,24) | capitalizeFirst }}...</h4>
                        <h4 *ngIf="location && location.place &&location.place.length<'27'">{{ location.place |
                          capitalizeFirst }}</h4>
                      </a>
                    </li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>
<section class="card col-md-12">
  <div class="activityFilter1">
    <!----mat tab change to mat select start-->
    <div class="statusSelectDiv">
      <div class="fieldPadding">
        <mat-select class="form-control" placeholder="New" #userTaskStatus [(value)]="statusFilter"
          [compareWith]="compareFn">
          <mat-select-trigger>
            <div style="display:flex;gap:5px;align-items:center">
              <img width="25px" *ngIf="selected2 && selected2.image" src={{selected2.image}} />
              <div *ngIf="selected2 && selected2.name">{{selected2.name}}</div>
              <div *ngIf="selected2 && selected2.name==='New'">
                <div *ngIf="newTaskDetailsCount">({{newTaskDetailsCount}})</div>
              </div>
              <div *ngIf="selected2 && selected2.name==='Completed'">
                <div *ngIf="completedTaskCount"> ({{completedTaskCount}})</div>
              </div>
            </div>
          </mat-select-trigger>
          <mat-option *ngFor="let stat of taskStatusList;let index=i" [value]="stat.id"
            (click)="handleTaskStatus(userTaskStatus.value)">
            <span style="display:flex;gap:10px">
              <div>
                <img *ngIf="stat && stat.image" width="25px" src={{stat.image}} />
              </div>
              <div *ngIf="stat.name">{{stat.name }}</div>
              <div *ngIf="stat.name==='New'">
                <div *ngIf="newTaskDetailsCount">({{newTaskDetailsCount}})</div>
              </div>
              <div *ngIf="stat.name==='Completed'">
                <div *ngIf="completedTaskCount"> ({{completedTaskCount}})</div>
              </div>
            </span>
          </mat-option>
        </mat-select>
      </div>
    </div>
    <div class="activityandFilter" >
      <div class="">
        <span (click)="createTask('Create')"  class="btn btn-primary font-weight-bold confirmBtn">
          <span *ngIf="createActivityText"> {{createActivityText}}</span>
        </span>
      </div>
      <div class="">
        <span (click)="showFilterSidebar()"  class="btn btn-primary font-weight-bold confirmBtn">
          <i class="icon-filter-one mt-2" [matTooltipClass]="tooltipcls" [matTooltip]="filtericonTooltip"
            style="cursor: pointer;"></i>
          <span class="hideFilter" *ngIf="Filter">{{Filter}}</span>
        </span>
      </div>
    </div>
    <div class="activityandFilterMob">
      <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu" 
      style="height:35px;width:85px;border-radius: 0px !important;" >
        <!-- <mat-icon>more_vert</mat-icon> -->
        <div class="others">
          <span><img style="margin-bottom: 7px;" height="20px" width="20px" src="/assets/images/crmImages/others.png" /></span>
         <span><span style="font-size: 13px;color:#000;margin-left: 2px;font-weight: 600;">Others</span></span>
        </div>
       <!-- <div>Others</div> -->
      </button>
      <mat-menu #menu="matMenu" class="mat-menu-panel">
        <button mat-menu-item (click)="createTask('Create')">
          <img  height="25px" width="25px"  src="/assets/images/crmImages/craeteActivity.png"/>
          <span *ngIf="createActivityText">{{createActivityText}}</span>
        </button>
        <button mat-menu-item (click)="showFilterSidebar()">
          <img  height="25px" width="25px"  src="/assets/images/crmImages/filter.png"/>
          <span *ngIf="Filter">{{Filter}}</span>
        </button>
      </mat-menu>
    </div>
  </div>
  <div class="clearfix"></div>
  <div class="startMatTab">
    <div>
      <div class="content comn-cls dashboard audit" *ngIf="!api_loading">
        <div class="col-md-12 no-padding-small">
          <div class="row">
            <div class="card p0 w-dta">
              <div class="table-responsive dash-list">
                <table class="table" style="background-color: white;">
                  <thead>
                    <tr class="tble-filtr-tr heght">
                      <th class="head_color">Activity</th>
                      <th class="head_color">Employee</th>
                      <th class="head_color">Due Date</th>
                      <th class="head_color">Status</th>
                    </tr>
                  </thead>
                  <app-common-innerloading-spinner *ngIf="api_loading"></app-common-innerloading-spinner>
                  <tbody>
                    <tr>
                      <div>
                        <aside class="filterSidebar filter-sidebar" *ngIf="filter_sidebar">
                          <section id="filterContainer" class="sidebar sidebar-bottom checkfilter filter-container">
                            <div class="filterClosebtn filter-head" [class.pd-btm-30]="!filterapplied">
                              <span class="filter-head-title" *ngIf="Filter">{{Filter}}s</span>
                              <i class="icon-filter-one-op ng-star-inserted pointer-cursor pull-right"
                                (click)="hideFilterSidebar()" [matTooltipClass]="tooltipcls"
                                [matTooltip]="'Close filter window'"></i>
                            </div>
                            <div [ngStyle]="{'height.px': filterapplied === true ? 95 : 44 }">&nbsp;</div>
                            <ul class="sidebar-menu accordion" id="accordion1">
                              <!-- <div class="card">
                                <div class="card-header">
                                  <h2 class="mb-0">
                                    <button class="btn btn-link" type="button" data-toggle="collapse"
                                      data-target="#collapseStatus2" aria-expanded="false">
                                      <div>
                                        <div style="display: inline-block !important;">
                                          <i class="fa fa-circle-o-notch"></i>
                                        </div>
                                        <span>&nbsp;Status</span>
                                      </div>
                                      <i class="fa fa-angle-down"></i>
                                    </button>
                                  </h2>
                                </div>
                                <div id="collapseStatus2" class="collapse in" data-parent="#accordion2">
                                  <div class="card-body">
                                    <div class="filter-checkbox-input">
                                      <li class="filterli filterCheckbox filterCheckboxborder filtercheckboxSize">
                                      </li>
                                      <li class="filterli filterCheckbox  filterCheckboxborder filtercheckboxSize"
                                        *ngFor="let stat of taskStatusList;let index=i">
                                        <mat-checkbox [checked]="statuses.indexOf(stat) !== -1"
                                          [checked]="statuses.indexOf(stat.id) !== -1"
                                          (change)="setFilterDataCheckbox('status', stat.id)">
                                          {{stat.name}}</mat-checkbox>
                                      </li>
                                    </div>
                                  </div>
                                </div>
                              </div> -->

                              <div class="card">
                                <div class="card-header">
                                  <h2 class="mb-0">
                                    <button class="btn btn-link" type="button" data-toggle="collapse"
                                      data-target="#collapseDate3" aria-expanded="false">
                                      <div>
                                        <div style="display: inline-block !important;">
                                          <i class="fa fa-calendar-o"></i>
                                        </div>
                                        <span>&nbsp;Date</span>
                                      </div>
                                      <i class="fa fa-angle-down"></i>
                                    </button>
                                  </h2>
                                </div>
                                <div id="collapseDate3" class="collapse in" data-parent="#accordion3">
                                  <div class="card-body">
                                    <div class="filterTextinput filter-text-input">
                                      <li class="filterli filterDatepicker filter-li">
                                        <input type="text" [(ngModel)]="filter.check_in_start_date"
                                          [matDatepicker]="startpicker" #Fdate class="filterTextbox filter-textbox"
                                          [max]="maxday" placeholder="Enter Start Date" (dateChange)="keyPressed()">
                                        <mat-datepicker-toggle matSuffix [for]="startpicker">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #startpicker></mat-datepicker>
                                      </li>
                                    </div>
                                    <div class="filterTextinput filter-text-input">
                                      <li class="filterli filterDatepicker filter-li">
                                        <input type="text" [(ngModel)]="filter.check_in_end_date"
                                          [matDatepicker]="endpicker" #Fdate class="filterTextbox filter-textbox"
                                          placeholder="Enter End Date" [min]="endminday" [max]="endmaxday"
                                          (dateChange)="keyPressed()">
                                        <mat-datepicker-toggle matSuffix [for]="endpicker">
                                        </mat-datepicker-toggle>
                                        <mat-datepicker #endpicker></mat-datepicker>
                                      </li>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <!-- <div class="card">
                                  <div class="card-header">
                                    <h2 class="mb-0">
                                      <button class="btn btn-link" type="button" data-toggle="collapse"
                                        data-target="#collapseCategory3" aria-expanded="false">
                                        <div>
                                          <div style="display: inline-block !important;">
                                            <i class="fa fa-circle-o-notch"></i>
                                          </div>
                                          <span>&nbsp;Category</span>
                                        </div>
                                        <i class="fa fa-angle-down"></i>
                                      </button>
                                    </h2>
                                  </div>
                                  <div id="collapseCategory3" class="collapse in" data-parent="#accordion2">
                                    <div class="card-body">
                                      <div class="filter-checkbox-input">
                                        <li class="filterli filterCheckbox filterCheckboxborder filtercheckboxSize">
                                        </li>
                                        <li class="filterli filterCheckbox  filterCheckboxborder filtercheckboxSize"
                                          *ngFor="let cat of categoryListData[0];let index=i">
                                          <mat-checkbox [checked]="categories.indexOf(cat) !== -1"
                                            [checked]="categories.indexOf(cat.id) !== -1"
                                            (change)="setFilterDataCheckbox('category', cat.id)">
                                            {{cat.name}}</mat-checkbox>
                                        </li>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="card">
                                  <div class="card-header">
                                    <h2 class="mb-0">
                                      <button class="btn btn-link" type="button" data-toggle="collapse"
                                        data-target="#collapseType3" aria-expanded="false">
                                        <div>
                                          <div style="display: inline-block !important;">
                                            <i class="fa fa-circle-o-notch"></i>
                                          </div>
                                          <span>&nbsp;Type</span>
                                        </div>
                                        <i class="fa fa-angle-down"></i>
                                      </button>
                                    </h2>
                                  </div>
                                  <div id="collapseType3" class="collapse in" data-parent="#accordion2">
                                    <div class="card-body">
                                      <div class="filter-checkbox-input">
                                        <li class="filterli filterCheckbox filterCheckboxborder filtercheckboxSize">
                                        </li>
                                        <li class="filterli filterCheckbox  filterCheckboxborder filtercheckboxSize"
                                          *ngFor="let typ of taskTypeList[0];let index=i">
                                          <mat-checkbox [checked]="types.indexOf(typ) !== -1"
                                            [checked]="types.indexOf(typ.id) !== -1"
                                            (change)="setFilterDataCheckbox('type', typ.id)">
                                            {{typ.name}}</mat-checkbox>
                                        </li>
                                      </div>
                                    </div>
                                  </div>

                                </div> -->
                            </ul>
                          </section>
                          <div class="filter-footer mt-1 mx-auto text-center" *ngIf="filterapplied === true">
                            <button class="btn reset-btn" (click)="clearFilter()" style="margin-top: 5px;">
                              <i class="fa fa-undo"></i>&nbsp;Reset
                            </button>
                            <button class="btn apply-btn" (click)="applyFilter(statusFilter)">
                              <i class="fa fa-check"></i>&nbsp;Apply
                            </button>
                          </div>
                        </aside>
                      </div>

                    </tr>
                  </tbody>
                  <tbody>
                    <ng-container *ngIf="totalTaskActivityList && totalTaskActivityList.length === 0">
                      <tr>
                        <td class="nodatafound" colspan="5" *ngIf="no_tasks_cap">{{no_tasks_cap}}</td>
                      </tr>
                    </ng-container>
                    <ng-container *ngIf="totalTaskActivityList && totalTaskActivityList.length>0">
                      <tr *ngFor="let task of totalTaskActivityList | paginate: config; let i=index"
                        class="pointer-cursor" (click)="viewTask(task.taskUid,task)">
                        <td data-title="Task Details" class="td1" *ngIf="task && task.title">{{task.title}}</td>
                        <td data-title="Task Details" class="td2"><span
                            *ngIf="task && task.assignee">{{task.assignee.name}}</span></td>
                        <td data-title="Due Date" class="td6" *ngIf="task && task.dueDate">{{task.dueDate | date:newDateFormat}}
                        </td>
                        <td data-title="Status" class="td3" [ngStyle]="{'color': getColor(task.status.name)}"
                          *ngIf="task && task.status && task.status.name">
                          {{task.status.name}}</td>
                        <td data-title="Due Date" class="td6" *ngIf="!task.dueDate">--</td>
                      </tr>
                    </ng-container>
                  </tbody>
                </table>
                <div class="search_paging my-2" *ngIf="pagination && pagination.totalCnt>10 ">
                  <pagination-template *ngIf="pagination && pagination.totalCnt>10" #p="paginationApi" [id]="config.id"
                    (pageChange)="config.currentPage = $event">
                    <div
                      class="custom-pagination d-flex justify-content-between align-items-center flex-wrap pull-right mb-0">
                      <div class="pagination-previous mx-2" [class.disabled]="p.isFirstPage()" data-bs-toggle="tooltip"
                        data-bs-placement="bottom" title="previous">
                        <a *ngIf="!p.isFirstPage()" (click)="p.previous()">
                          < </a>
                      </div>
                      <div *ngFor="let page of p.pages" [class.current]="p.getCurrent() === page.value">
                        <a (click)="p.setCurrent(page.value)" *ngIf="p.getCurrent() !== page.value">
                          <span class="mx-2">{{ page.label }}</span>
                        </a>
                        <div *ngIf="p.getCurrent() === page.value">
                          <span>{{ page.label }}</span>
                        </div>
                      </div>
                      <div class="pagination-next mx-2" [class.disabled]="p.isLastPage()" data-bs-toggle="tooltip"
                        data-bs-placement="top" title="next">
                        <a *ngIf="!p.isLastPage()" (click)="p.next()"> > </a>
                      </div>
                    </div>
                  </pagination-template>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>