<!-----card header start-->
<section class="card cardBoxShadow">
    <div class="title-gb no-padding">
        <div class="mgn-up-15 mgn-lt-15 mgn-rt-15 dash-head">
            <span class="fa fa-arrow-left pointer-cursor" (click)="goback()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            {{selectHeader}}
        </div>
    </div>
</section>
<br>
<app-common-innerloading-spinner *ngIf="api_loading"></app-common-innerloading-spinner>
<!-- {{type | json}} -->
<section  class="card" *ngIf="taskMasterData && type !=='SubUpdate'">
    <div class=" card bgColor inputwithImg">
        <div class="noImg">
        <form [formGroup]="createTaskForm">
            <div *ngIf="(taskMasterData && taskMasterData.title && taskMasterData.title.isvisible)|| (taskMasterData && taskMasterData.description && taskMasterData.description.isvisible)||(taskMasterData && taskMasterData.category && taskMasterData.category.isvisible)||(taskMasterData && taskMasterData.type && taskMasterData.type.isvisible)||(taskMasterData && taskMasterData.location && taskMasterData.location.isvisible)">
                <span class="group-head" >{{selectHeader}} Details</span><br>
            <div class="bggrey my-2">
                <div *ngIf="taskMasterData && taskMasterData.title && taskMasterData.title.isvisible" >
                    <div class="taskTitle">
                      <div>Title</div>
                      <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.title && taskMasterData.title.iseditable)}">
                        <input (keyup)="resetErrors()" type="text" #taskTitle (ngModelChange)="hamdleTaskTitle(taskTitle.value)"
                            placeholder="{{activityTitle}}"class="form-control"formControlName="taskTitle"autocomplete="off"   [readonly]="!(taskMasterData && taskMasterData.title && taskMasterData.title.iseditable)" [value]="taskTitle" /> 
                        <app-field-error-display 
                            [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>
                    </div>                                      
                </div>
                <div *ngIf="taskMasterData && taskMasterData.description && taskMasterData.description.isvisible">
                    <div class="taskTitle">
                        <div>Description</div>
                    </div>
                    <div  class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.description && taskMasterData.description.iseditable)}">
                        <textarea rowa="10" class="form-control" formControlName="taskDescription"
                            #taskDescription (change)="handleTaskDescription(taskDescription.value)"(keyup)="autoGrowTextZone($event)"
                            maxlength="1000" placeholder="{{activityDescription}}"  [readonly]="!(taskMasterData && taskMasterData.description && taskMasterData.description.iseditable)">
                        </textarea>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>  
                    </div>
                </div>
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding" *ngIf="taskMasterData && taskMasterData.category && taskMasterData.category.isvisible">
                        <div class="taskTitle">
                            <div>Category</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding"  [ngClass]="{'highlight': !(taskMasterData && taskMasterData.category && taskMasterData.category.iseditable)}">
                        <mat-select class="form-control widthWebKit" placeholder="Enter Category" [disabled]="!(taskMasterData && taskMasterData.category && taskMasterData.category.iseditable)"
                            #userTaskCategory formControlName="userTaskCategory" >
                            <mat-option *ngFor="let item of categoryListData[0];let index=i" [value]="item.id"  (selectionChange)="handleTaskCategorySelection(userTaskCategory.value)" >
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                        </div>
                    </div>
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding" *ngIf="taskMasterData && taskMasterData.type && taskMasterData.type.isvisible">
                        <div class="taskTitle">
                            <div>Type</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.type && taskMasterData.type.iseditable)}">
                        <mat-select class="form-control widthWebKit" placeholder="Enter Type" [disabled]="!(taskMasterData && taskMasterData.type && taskMasterData.type.iseditable)"
                            #userTaskType formControlName="userTaskType" >
                            <mat-option *ngFor="let item of taskTypeList[0];let index=i" [value]="item.id"  (selectionChange)="handleTaskTypeSelection(userTaskType.value)">
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                        </div>    
                    </div>
                </div>
    
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding"  *ngIf="taskMasterData && taskMasterData.location && taskMasterData.location.isvisible">
                        <div class="taskTitle">
                            <div>Location</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.location && taskMasterData.location.iseditable)}">
                            <input (keyup)="resetErrors()" type="text" #taskLocation 
                            placeholder="Enter activity location"class="form-control widthWebKit" formControlName="taskLocation"autocomplete="off" [readonly]="!(taskMasterData && taskMasterData.location && taskMasterData.location.iseditable)" [value]="taskLocation.name" /> 
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>    
                        </div>
                    </div>
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding"  *ngIf="taskMasterData && taskMasterData.locationArea && taskMasterData.locationArea.isvisible">
                        <div class="taskTitle">
                            <div>Area</div>
                        </div>
                        <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.locationArea && taskMasterData.locationArea.iseditable)}">
                            <input (keyup)="resetErrors()" type="text" [readonly]="!(taskMasterData && taskMasterData.locationArea && taskMasterData.locationArea.iseditable)"
                            placeholder=""class="form-control widthWebKit" formControlName="areaName" autocomplete="off" /> 
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>    
                        </div>
                    </div>
                </div>
            </div>
            </div>


            <div *ngIf="(taskMasterData && taskMasterData.assignee && taskMasterData.assignee.isvisible)|| (taskMasterData && taskMasterData.manager && taskMasterData.manager.isvisible)">
                <!-- <span class="group-head" >Select Activity Assignee and Manager</span><br> -->
                <div style="display: flex;gap: 5px;">
                    <div class="group-head" *ngIf="taskMasterData && taskMasterData.assignee && taskMasterData.assignee.isvisible ===true">
                        Select Activity Employee
                    </div>
                    <div class="group-head" style="display: none;" *ngIf="taskMasterData && taskMasterData.assignee && taskMasterData.assignee.isvisible === false">
                        Select Activity Employee
                    </div>
                    <div class="group-head" *ngIf="taskMasterData && taskMasterData.manager && taskMasterData.manager.isvisible===true">
                        and Manager
                    </div>
                    <div class="group-head" style="display: none;" *ngIf="taskMasterData && taskMasterData.manager && taskMasterData.manager.isvisible===false">
                        and Manager
                    </div>
                </div>
            <div class="bggrey my-2">
                <div *ngIf="taskMasterData && taskMasterData.assignee && taskMasterData.assignee.isvisible">
                    <div class="taskTitle">
                        <div>Employee</div>
                        <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.assignee && taskMasterData.assignee.iseditable)}">
                        <div>
                            <div formControlName="selectMember" class="form-control" style="display: flex;justify-content: space-between;"(click)="selectMemberDialog(selectMember)" >
                                <div >{{selectMember}}</div>
                                <div style="cursor: pointer;"  ><i class="fa fa-user" aria-hidden="true"></i></div>
                            </div>
                        </div>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>  
                    </div>                           
                </div>
                <div *ngIf="taskMasterData && taskMasterData.manager && taskMasterData.manager.isvisible">
                    <div class="taskTitle">
                        <div>Manager</div>
                    </div>
                    <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.manager && taskMasterData.manager.iseditable)}">
                        <div>
                            <div  formControlName="selectTaskManger" class="form-control" style="display: flex;justify-content: space-between;"(click)="selectManagerDialog(selectTaskManger)" >
                                <div>{{selectTaskManger}}</div>
                                <div style="cursor: pointer;"  ><i class="fa fa-user" aria-hidden="true"></i></div>
                            </div>
                        </div>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>
                    </div>                                     
                </div>
            </div>
            </div>

            
            <div *ngIf="(taskMasterData && taskMasterData.dueDate && taskMasterData.dueDate.isvisible)|| (taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.isvisible)||(taskMasterData && taskMasterData.priority && taskMasterData.priority.isvisible)">
                <div>
                    <div class="group-head" *ngIf="taskMasterData && taskMasterData.dueDate && taskMasterData.dueDate.isvisible===true">
                        Activity Date 
                    </div>
                    <div class="group-head" style="display: none;" *ngIf="taskMasterData && taskMasterData.dueDate && taskMasterData.dueDate.isvisible===false">
                        Activity Date 
                    </div>
                    <div class="group-head" *ngIf="(taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.isvisible===true)">
                         Other Info
                    </div>
                    <div class="group-head"  style="display: none;" *ngIf="(taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.isvisible===false)">
                         Other Info
                    </div>
                    <div class="group-head" *ngIf="(taskMasterData && taskMasterData.priority && taskMasterData.priority.isvisible===true)">
                       Other Info
                    </div>
                    <div class="group-head" style="display: none;" *ngIf="(taskMasterData && taskMasterData.priority && taskMasterData.priority.isvisible===false)">
                         Other Info
                    </div>
                </div>
            <div class="bggrey my-2">
                <div style="display: flex;gap: 5px;flex-wrap: wrap;" >
                    <div class="lbl col-sm-8 col-md-6 col-lg-6 no-padding" *ngIf="taskMasterData && taskMasterData.dueDate && taskMasterData.dueDate.isvisible">
                        <div class="taskTitle">
                            <div>Due Date</div>
                        </div>
                        <div class="pickerouter fieldPadding dt dateWithMatDtae" >
                            <input formControlName="taskDate" class="form-control widthWebKit positionNameInput" type="text"  [ngClass]="{'highlight': !(taskMasterData && taskMasterData.dueDate && taskMasterData.dueDate.iseditable)}" matInput
                                [matDatepicker]="picker"
                                [value]="ddate" (dateChange)="handleDateChange($event)" placeholder="Enter Date" #taskDate>
                            <mat-datepicker-toggle matSuffix [for]="picker">
                            </mat-datepicker-toggle>
                            <mat-datepicker #picker [dateClass]="dateClass.bind(this)">
                            </mat-datepicker>
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>       
                        </div>
                    </div>
                
                    <div class="lbl col-sm-8 col-md-7 col-lg-6 no-padding" *ngIf="taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.isvisible" >
                        <div class="taskTitle">
                            <div>Est Duration</div>
                        </div>
                        <div class="fieldPadding d-flex" style="gap: 5px;flex-wrap: wrap;"  *ngIf="createBTimeField" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.iseditable)}">
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="days" [value]="taskDays" (keyup)="resetErrors()"  type="number" #taskDays (ngModelChange)="handleTaskEstDuration(taskDays.value)"
                                placeholder="Days" class="form-control widthWebKit" formControlName="taskDays"  [readonly]="!(taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.iseditable)" autocomplete="off" min="0"/>
                                </div>
                                <div class="timeField">Days</div>
                            </div>
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="hrs" [value]="taskHrs" (keyup)="resetErrors()"  type="number" #taskHrs (ngModelChange)="handleTaskEstDuration(taskHrs.value)"
                            placeholder="Hours" class="form-control widthWebKit" formControlName="taskHrs"  [readonly]="!(taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.iseditable)" autocomplete="off" min="0" max="23"/>
                                </div>
                                <div class="timeField"> Hours </div>
                            </div>
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="min" [value]="taskMin" (keyup)="resetErrors()"  type="number" #taskMin (ngModelChange)="handleTaskEstDuration(taskMin.value)"
                                    placeholder="Minutes" class="form-control widthWebKit" formControlName="taskMin"  [readonly]="!(taskMasterData && taskMasterData.estDuration && taskMasterData.estDuration.iseditable)" autocomplete="off" min="0" max="59"/>
                                </div>
                                <div class="timeField">
                                    Minutes 
                                </div>
                            </div>
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>
                        </div>
                        <div class="fieldPadding" *ngIf="updateBTimefield" >
                            <div class="form-control" style="display: flex !important;justify-content: space-between;align-items: center;">
                                <div style="display: flex;gap: 5px;align-items: center;" *ngIf="type != 'SubUpdate'">
                                    <div>{{updateValue.estDuration.days}}days,</div>
                                    <div>{{this.updateValue.estDuration.hours}}hours,</div>
                                    <div>{{this.updateValue.estDuration.minutes}}minutes</div>
                                </div>
                                <div style="display: flex;gap: 5px;align-items: center;" *ngIf="type === 'SubUpdate'">
                                    <div>{{updateValue.estdays}}days,</div>
                                    <div>{{updateValue.esthours}}hours,</div>
                                    <div>{{updateValue.estminutes}}minutes</div>
                                </div>
                                <div style="cursor: pointer;" (click)="openTimeField()"><mat-icon>access_time</mat-icon></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div *ngIf="taskMasterData && taskMasterData.priority && taskMasterData.priority.isvisible"> 
                    <div class="taskTitle">
                        <div>Priority</div>
                    </div>
                    <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.priority && taskMasterData.priority.iseditable)}">
                        <mat-select class="form-control" placeholder="Select Priority" [disabled]="!(taskMasterData && taskMasterData.priority && taskMasterData.priority.iseditable)"
                            #userTaskPriority formControlName="userTaskPriority" >
                            <mat-option  *ngFor="let item of taskPriorityList[0];let index=i" [value]="item.id">
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                    </div>
                </div>
            </div>
            </div>



            
            
            <div class="bggrey my-2" *ngIf="(taskMasterData && taskMasterData.status && taskMasterData.status.isvisible)|| (taskMasterData && taskMasterData.targetResult && taskMasterData.targetResult.isvisible)||(taskMasterData && taskMasterData.targetPotential && taskMasterData.targetPotential.isvisible)">
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding" *ngIf="taskMasterData && taskMasterData.status && taskMasterData.status.isvisible"> 
                        <div class="taskTitle">
                            <div>Status</div>
                        </div>
                        <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.status && taskMasterData.status.iseditable)}">
                            <mat-select class="form-control widthWebKit" placeholder="Enter activity status" [disabled]="!(taskMasterData && taskMasterData.status && taskMasterData.status.iseditable)"
                                #taskStatus formControlName="taskStatus" name="item" >
                                <mat-option *ngFor="let item of taskStatusList[0];let index=i" [value]="item.id"  >
                                    <div [ngStyle]="{'color': getColor(item.name)}">
                                        {{item.name | capitalizeFirst}}
                                    </div>
                                </mat-option>
                            </mat-select>
                                
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>
                        </div>
                    </div>
                </div>
    
                
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-6 no-padding" *ngIf="taskMasterData && taskMasterData.targetResult && taskMasterData.targetResult.isvisible">
                        <div class="taskTitle">
                            <div>Target Potential</div>
                        </div>
                        <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.targetResult && taskMasterData.targetResult.iseditable)}">
                            <input (keyup)="resetErrors()" type="text" #targetResult
                            placeholder="Enter potential"class="form-control widthWebKit"formControlName="targetResult"  [readonly]="!(taskMasterData && taskMasterData.targetResult && taskMasterData.targetResult.iseditable)" autocomplete="off" /> 
                        </div>
                    </div>
                                   
                    <div class="lbl col-sm-8 col-md-7 col-lg-6 no-padding" *ngIf="taskMasterData && taskMasterData.targetPotential && taskMasterData.targetPotential.isvisible">
                        <div class="taskTitle">
                            <div>Business Potential</div>
                        </div>
                        <div class="fieldPadding" [ngClass]="{'highlight': !(taskMasterData && taskMasterData.targetPotential && taskMasterData.targetPotential.iseditable)}">
                            <input  min="0" (keyup)="resetErrors()" type="text" #targetPotential    [readonly]="!(taskMasterData && taskMasterData.targetPotential && taskMasterData.targetPotential.iseditable)"
                            placeholder="Enter ({{rupee_symbol}})"class="form-control widthWebKit"formControlName="targetPotential"autocomplete="off" />           
                        </div>
                    </div>               
                </div>
            </div>



            <div style="text-align: center;margin-top: 15px;">
                <ng-container >
                    <div class=" mgn-bt-20 mgn-up-10">
                        <button [ngClass]="{'cursorDiasable':  api_loading_CreateActivity}" type="button" class="btn btn-primary font-weight-bold cancelBtn" (click)="!api_loading_CreateActivity && goback()"
                            >Cancel
                        </button>
                        <button [ngClass]="{'cursorDiasable':  api_loading_CreateActivity}" type="button"  (click)="saveCreateTask()" class="btn btn-primary font-weight-bold confirmBtn">
                            <app-common-innerloading-spinner  *ngIf="api_loading_CreateActivity"></app-common-innerloading-spinner>
                           <span *ngIf="!api_loading_CreateActivity">Save</span>
                        </button>
                    </div>
                </ng-container>
            </div>
        </form>
    </div>
        <!-- <div class="imageClass">
            <img class="taskImg" src="/assets/images/crmImages/Addtasks.png" />
        </div> -->
    </div> 
</section>
<section  class="card" *ngIf="!taskMasterData && type !=='SubUpdate'">
    <div class=" card bgColor inputwithImg">
        <div class="noImg">
        <form [formGroup]="createTaskForm">
            <span class="group-head">{{selectHeader}} Details</span><br>
            <div class="bggrey my-2">
                <div>
                    <div class="taskTitle">
                      <div>Title</div>
                      <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding">
                        <input (keyup)="resetErrors()" type="text" #taskTitle (ngModelChange)="hamdleTaskTitle(taskTitle.value)" (ngModelChange)="removeEmoji(taskTitle.value,$event)"
                        placeholder="{{activityTitle}}"class="form-control"formControlName="taskTitle"autocomplete="off" [value]="taskTitle" /> 
                        <app-field-error-display 
                            [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>
                        <div *ngIf="bErrormsg" style="color: #f24949 !important;font-size: 12px;">{{errorMsgAny}}</div>
                    </div>                                      
                </div>
                <div>
                    <div class="taskTitle">
                        <div>Description</div>
                    </div>
                    <div  class="fieldPadding">
                        <textarea rowa="10" class="form-control" formControlName="taskDescription"
                            #taskDescription (change)="handleTaskDescription(taskDescription.value)"(keyup)="autoGrowTextZone($event)"
                            maxlength="1000" placeholder="{{activityDescription}}">
                        </textarea>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;font-size: 12px;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>  
                    </div>
                </div>
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Category</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding">
                        <mat-select class="form-control widthWebKit" placeholder="Enter Category"
                            #userTaskCategory formControlName="userTaskCategory" (selectionChange)="handleTaskCategorySelection(userTaskCategory.value)" >
                            <mat-option *ngFor="let item of categoryListData[0];let index=i" [value]="item.id"  (ngModelChange)="handleTaskCategorySelection(userTaskCategory.value)" >
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                        </div>
                        <div *ngIf="bErrormsgCategory" style="color: #f24949 !important;font-size: 12px;">{{errorMsgAnyCategory}}</div>
                    </div>
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Type</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding">
                        <mat-select class="form-control widthWebKit" placeholder="Enter Type"
                            #userTaskType formControlName="userTaskType" (selectionChange)="handleTaskTypeSelection(userTaskType.value)">
                            <mat-option *ngFor="let item of taskTypeList[0];let index=i" [value]="item.id"  (ngModelChange)="handleTaskTypeSelection(userTaskType.value)">
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                        </div>  
                        <div *ngIf="bErrormsgType" style="color: #f24949 !important;font-size: 12px;">{{errorMsgAnyType}}</div>  
                    </div>
                </div>
    
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Location</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding">
                            <input (keyup)="resetErrors()"  type="text" #taskLocation 
                            placeholder="Enter activity location"class="form-control widthWebKit" formControlName="taskLocation" autocomplete="off" [value]="taskLocation.name" /> 
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>    
                        </div>
                    </div>
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Area</div>
                        </div>
                        <div class="fieldPadding">
                            <input (keyup)="resetErrors()" type="text"
                            placeholder=""class="form-control widthWebKit"formControlName="areaName" autocomplete="off" /> 
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>    
                        </div>
                    </div>
                </div>
            </div>


            <span class="group-head">Select Activity Employee and Manager</span><br>
            <div class="bggrey my-2">
                <div>
                    <div class="taskTitle">
                        <div>Employee</div>
                        <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding">
                        <div>
                            <div [formControlName]="selectMember" class="form-control" style="display: flex;justify-content: space-between;"(click)="selectMemberDialog(selectMember)" >
                                <div >{{selectMember}}</div>
                                <div style="cursor: pointer;"  ><i class="fa fa-user" aria-hidden="true"></i></div>
                            </div>
                        </div>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>  
                    </div>                           
                </div>
                <div>
                    <div class="taskTitle">
                        <div>Manager</div>
                    </div>
                    <div class="fieldPadding">
                        <div>
                            <div  [formControlName]="selectTaskManger" class="form-control" style="display: flex;justify-content: space-between;"(click)="selectManagerDialog(selectTaskManger)" >
                                <div>{{selectTaskManger}}</div>
                                <div style="cursor: pointer;"  ><i class="fa fa-user" aria-hidden="true"></i></div>
                            </div>
                        </div>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>
                    </div>                                     
                </div>
            </div>

            
            <span class="group-head">Activity Date and Other Info</span><br>
            <div class="bggrey my-2">
                <div style="display: flex;gap: 5px;flex-wrap: wrap;" >
                    <div class="lbl col-sm-8 col-md-6 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Due Date</div>
                        </div>
                        <div class="pickerouter fieldPadding dt dateWithMatDtae" >
                            <input  formControlName="taskDate" class="form-control widthWebKit positionNameInput" type="text"  matInput
                                [matDatepicker]="picker" 
                                [value]="ddate" (dateChange)="handleDateChange($event)" placeholder="Enter Date" #taskDate>
                            <mat-datepicker-toggle matSuffix [for]="picker">
                            </mat-datepicker-toggle>
                            <mat-datepicker #picker [dateClass]="dateClass.bind(this)">
                            </mat-datepicker>
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>       
                        </div>
                    </div>
                
                    <div class="lbl col-sm-8 col-md-6 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Est Duration</div>
                        </div>
                        <div class="fieldPadding d-flex" style="gap: 5px;flex-wrap: wrap;"  *ngIf="createBTimeField" >
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="days" [value]="taskDays" (keyup)="resetErrors()"  type="number" #taskDays (ngModelChange)="handleTaskEstDuration(taskDays.value)"
                                placeholder="Days" class="form-control widthWebKit" formControlName="taskDays"   autocomplete="off" min="0"/>
                                </div>
                                <div class="timeField">Days</div>
                            </div>
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="hrs" [value]="taskHrs" (keyup)="resetErrors()"  type="number" #taskHrs (ngModelChange)="handleTaskEstDuration(taskHrs.value)"
                            placeholder="Hours" class="form-control widthWebKit" formControlName="taskHrs"   autocomplete="off" min="0" max="23"/>
                                </div>
                                <div class="timeField"> Hours </div>
                            </div>
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="min" [value]="taskMin" (keyup)="resetErrors()"  type="number" #taskMin (ngModelChange)="handleTaskEstDuration(taskMin.value)"
                                    placeholder="Minutes" class="form-control widthWebKit" formControlName="taskMin"   autocomplete="off" min="0" max="59"/>
                                </div>
                                <div class="timeField">
                                    Minutes 
                                </div>
                            </div>
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>
                        </div>
                        <div class="fieldPadding" *ngIf="updateBTimefield" >
                            <div class="form-control" style="display: flex !important;justify-content: space-between;align-items: center;">
                                <div style="display: flex;gap: 5px;align-items: center;" *ngIf="type != 'SubUpdate'">
                                    <div>{{updateValue.estDuration.days}}days,</div>
                                    <div>{{this.updateValue.estDuration.hours}}hours,</div>
                                    <div>{{this.updateValue.estDuration.minutes}}minutes</div>
                                </div>
                                <div style="display: flex;gap: 5px;align-items: center;" *ngIf="type === 'SubUpdate'">
                                    <div>{{updateValue.estdays}}days,</div>
                                    <div>{{updateValue.esthours}}hours,</div>
                                    <div>{{updateValue.estminutes}}minutes</div>
                                </div>
                                <div style="cursor: pointer;" (click)="openTimeField()"><mat-icon>access_time</mat-icon></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- <div class="lbl col-sm-8 col-md-6 col-lg-6 no-padding" *ngIf="updateBTimefield">
                <div class="taskTitle">
                    <div>Est Duration</div>
                    <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding"  >
                        <div class="form-control widthWebKit" style="display: flex !important;justify-content: space-between;align-items: center;" *ngIf=" updateValue.estDuration.hours !=0">
                        <div>{{updateValue.estDuration.days}}(Days),{{this.updateValue.estDuration.hours}}(Hours)</div>
                        </div>
                        <div class="form-control widthWebKit" style="display: flex !important;justify-content: space-between;align-items: center;" *ngIf=" updateValue.estDuration.hours ===0">
                        <div>{{updateValue.estDuration.days}}(Days)</div>
                        </div>
                    </div>
    
                </div> -->
                
                <div> 
                    <div class="taskTitle">
                        <div>Priority</div>
                    </div>
                    <div class="fieldPadding">
                        <mat-select class="form-control" placeholder="Select Priority"
                            #userTaskPriority formControlName="userTaskPriority" >
                            <mat-option  *ngFor="let item of taskPriorityList[0];let index=i" [value]="item.id" >
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                    </div>
                </div>
            </div>



            
            
            <div class="bggrey my-2">
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Status</div>
                        </div>
                        <div class="fieldPadding">
                            <mat-select [disabled]="!editable" class="form-control widthWebKit" placeholder="Enter activity status"
                                #taskStatus formControlName="taskStatus" name="item"  >
                                <mat-option *ngFor="let item of taskStatusList[0];let index=i" [value]="item.id"  >
                                    <!-- <div>
                                        {{item.name | capitalizeFirst}}
                                    </div> -->
                                    <div [ngStyle]="{'color': getColor(item.name)}">
                                        {{item.name | capitalizeFirst}}
                                    </div>
                                </mat-option>
                            </mat-select>
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>
                        </div>
                    </div>
                </div>
    
                
                <div style="display: flex;gap: 5px;flex-wrap: wrap !important;" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Target Potential</div>
                        </div>
                        <div class="fieldPadding">
                            <input (keyup)="resetErrors()" type="text" #targetResult 
                            placeholder="Enter potential"class="form-control widthWebKit"formControlName="targetResult"  autocomplete="off" /> 
                        </div>
                    </div>
                                   
                    <div class="lbl col-sm-8 col-md-7 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Business Potential</div>
                        </div>
                        <div class="fieldPadding" >
                            <input min="0" (keyup)="resetErrors()" type="number" #targetPotential  
                            placeholder="Enter ({{rupee_symbol}})"class="form-control widthWebKit"formControlName="targetPotential"autocomplete="off" />           
                        </div>
                    </div>               
                </div>
            </div>

            <div style="text-align: center;margin-top: 15px;">
                <ng-container >
                    <div class=" mgn-bt-20 mgn-up-10">
                        <button [ngClass]="{'cursorDiasable':  api_loading_CreateActivity}" type="button" class="btn btn-primary font-weight-bold cancelBtn" (click)="!api_loading_CreateActivity && goback()"
                            >Cancel
                        </button>
                        <button [ngClass]="{'cursorDiasable':  api_loading_CreateActivity}" type="button"  (click)="saveCreateTask()" class="btn btn-primary font-weight-bold confirmBtn">
                            <app-common-innerloading-spinner  *ngIf="api_loading_CreateActivity"></app-common-innerloading-spinner>
                           <span *ngIf="!api_loading_CreateActivity">Save</span>
                        </button>
                    </div>
                </ng-container>
            </div>
        </form>
    </div>
        <!-- <div class="imageClass">
            <img class="taskImg" src="/assets/images/crmImages/Addtasks.png" />
        </div> -->
    </div>
      

</section>

<section  class="card" *ngIf="type ==='SubUpdate'">
    <div class=" card bgColor inputwithImg">
        <div class="noImg">
        <form [formGroup]="createTaskForm">
            <span class="group-head">{{selectHeader}} Details</span><br>
            <div class="bggrey my-2">
                <div>
                    <div class="taskTitle">
                      <div>Title</div>
                      <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding">
                        <input (keyup)="resetErrors()" type="text" #taskTitle (ngModelChange)="hamdleTaskTitle(taskTitle.value)" (ngModelChange)="removeEmoji(taskTitle.value,$event)"
                        placeholder="{{activityTitle}}"class="form-control"formControlName="taskTitle"autocomplete="off" [value]="taskTitle" /> 
                        <app-field-error-display 
                            [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>
                        <div *ngIf="bErrormsg" style="color: #f24949 !important;font-size: 12px;">{{errorMsgAny}}</div>
                    </div>                                      
                </div>
                <div>
                    <div class="taskTitle">
                        <div>Description</div>
                    </div>
                    <div  class="fieldPadding">
                        <textarea rowa="10" class="form-control" formControlName="taskDescription"
                            #taskDescription (change)="handleTaskDescription(taskDescription.value)"(keyup)="autoGrowTextZone($event)"
                            maxlength="1000" placeholder="{{activityDescription}}">
                        </textarea>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;font-size: 12px;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>  
                    </div>
                </div>
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Category</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding">
                        <mat-select class="form-control widthWebKit" placeholder="Enter Category"
                            #userTaskCategory formControlName="userTaskCategory" (selectionChange)="handleTaskCategorySelection(userTaskCategory.value)" >
                            <mat-option *ngFor="let item of categoryListData[0];let index=i" [value]="item.id"  (ngModelChange)="handleTaskCategorySelection(userTaskCategory.value)" >
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                        </div>
                        <div *ngIf="bErrormsgCategory" style="color: #f24949 !important;font-size: 12px;">{{errorMsgAnyCategory}}</div>
                    </div>
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Type</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding">
                        <mat-select class="form-control widthWebKit" placeholder="Enter Type"
                            #userTaskType formControlName="userTaskType" (selectionChange)="handleTaskTypeSelection(userTaskType.value)">
                            <mat-option *ngFor="let item of taskTypeList[0];let index=i" [value]="item.id"  (ngModelChange)="handleTaskTypeSelection(userTaskType.value)">
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                        </div>  
                        <div *ngIf="bErrormsgType" style="color: #f24949 !important;font-size: 12px;">{{errorMsgAnyType}}</div>  
                    </div>
                </div>
    
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Location</div>
                            <div class="astericColor">*</div>
                        </div>
                        <div class="fieldPadding">
                            <input (keyup)="resetErrors()"  type="text" #taskLocation 
                            placeholder="Enter activity location"class="form-control widthWebKit" formControlName="taskLocation" autocomplete="off" [value]="taskLocation.name" /> 
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>    
                        </div>
                    </div>
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Area</div>
                        </div>
                        <div class="fieldPadding">
                            <input (keyup)="resetErrors()" type="text"
                            placeholder=""class="form-control widthWebKit"formControlName="areaName" autocomplete="off" /> 
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>    
                        </div>
                    </div>
                </div>
            </div>


            <span class="group-head">Select Activity Employee and Manager</span><br>
            <div class="bggrey my-2">
                <div>
                    <div class="taskTitle">
                        <div>Employee</div>
                        <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding">
                        <div>
                            <div [formControlName]="selectMember" class="form-control" style="display: flex;justify-content: space-between;"(click)="selectMemberDialog(selectMember)" >
                                <div >{{selectMember}}</div>
                                <div style="cursor: pointer;"  ><i class="fa fa-user" aria-hidden="true"></i></div>
                            </div>
                        </div>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>  
                    </div>                           
                </div>
                <div>
                    <div class="taskTitle">
                        <div>Manager</div>
                    </div>
                    <div class="fieldPadding">
                        <div>
                            <div  [formControlName]="selectTaskManger" class="form-control" style="display: flex;justify-content: space-between;"(click)="selectManagerDialog(selectTaskManger)" >
                                <div>{{selectTaskManger}}</div>
                                <div style="cursor: pointer;"  ><i class="fa fa-user" aria-hidden="true"></i></div>
                            </div>
                        </div>
                        <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                        </app-field-error-display>
                    </div>                                     
                </div>
            </div>

            
            <span class="group-head">Activity Date and Other Info</span><br>
            <div class="bggrey my-2">
                <div style="display: flex;gap: 5px;flex-wrap: wrap;" >
                    <div class="lbl col-sm-8 col-md-6 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Due Date</div>
                        </div>
                        <div class="pickerouter fieldPadding dt dateWithMatDtae" >
                            <input  formControlName="taskDate" class="form-control widthWebKit positionNameInput" type="text"  matInput
                                [matDatepicker]="picker" 
                                [value]="ddate" (dateChange)="handleDateChange($event)" placeholder="Enter Date" #taskDate>
                            <mat-datepicker-toggle matSuffix [for]="picker">
                            </mat-datepicker-toggle>
                            <mat-datepicker #picker [dateClass]="dateClass.bind(this)">
                            </mat-datepicker>
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>       
                        </div>
                    </div>
                
                    <div class="lbl col-sm-8 col-md-6 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Est Duration</div>
                        </div>
                        <div class="fieldPadding d-flex" style="gap: 5px;flex-wrap: wrap;"  *ngIf="createBTimeField" >
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="days" [value]="taskDays" (keyup)="resetErrors()"  type="number" #taskDays (ngModelChange)="handleTaskEstDuration(taskDays.value)"
                                placeholder="Days" class="form-control widthWebKit" formControlName="taskDays"   autocomplete="off" min="0"/>
                                </div>
                                <div class="timeField">Days</div>
                            </div>
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="hrs" [value]="taskHrs" (keyup)="resetErrors()"  type="number" #taskHrs (ngModelChange)="handleTaskEstDuration(taskHrs.value)"
                            placeholder="Hours" class="form-control widthWebKit" formControlName="taskHrs"   autocomplete="off" min="0" max="23"/>
                                </div>
                                <div class="timeField"> Hours </div>
                            </div>
                            <div class="estField">
                                <div class="secondEst">
                                    <input id="min" [value]="taskMin" (keyup)="resetErrors()"  type="number" #taskMin (ngModelChange)="handleTaskEstDuration(taskMin.value)"
                                    placeholder="Minutes" class="form-control widthWebKit" formControlName="taskMin"   autocomplete="off" min="0" max="59"/>
                                </div>
                                <div class="timeField">
                                    Minutes 
                                </div>
                            </div>
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>
                        </div>
                        <div class="fieldPadding" *ngIf="updateBTimefield" >
                            <div class="form-control" style="display: flex !important;justify-content: space-between;align-items: center;">
                                <div style="display: flex;gap: 5px;align-items: center;" *ngIf="type != 'SubUpdate'">
                                    <div>{{updateValue.estDuration.days}}days,</div>
                                    <div>{{this.updateValue.estDuration.hours}}hours,</div>
                                    <div>{{this.updateValue.estDuration.minutes}}minutes</div>
                                </div>
                                <div style="display: flex;gap: 5px;align-items: center;" *ngIf="type === 'SubUpdate'">
                                    <div>{{updateValue.estdays}}days,</div>
                                    <div>{{updateValue.esthours}}hours,</div>
                                    <div>{{updateValue.estminutes}}minutes</div>
                                </div>
                                <div style="cursor: pointer;" (click)="openTimeField()"><mat-icon>access_time</mat-icon></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- <div class="lbl col-sm-8 col-md-6 col-lg-6 no-padding" *ngIf="updateBTimefield">
                <div class="taskTitle">
                    <div>Est Duration</div>
                    <div class="astericColor">*</div>
                    </div>
                    <div class="fieldPadding"  >
                        <div class="form-control widthWebKit" style="display: flex !important;justify-content: space-between;align-items: center;" *ngIf=" updateValue.estDuration.hours !=0">
                        <div>{{updateValue.estDuration.days}}(Days),{{this.updateValue.estDuration.hours}}(Hours)</div>
                        </div>
                        <div class="form-control widthWebKit" style="display: flex !important;justify-content: space-between;align-items: center;" *ngIf=" updateValue.estDuration.hours ===0">
                        <div>{{updateValue.estDuration.days}}(Days)</div>
                        </div>
                    </div>
    
                </div> -->
                
                <div> 
                    <div class="taskTitle">
                        <div>Priority</div>
                    </div>
                    <div class="fieldPadding">
                        <mat-select class="form-control" placeholder="Select Priority"
                            #userTaskPriority formControlName="userTaskPriority" >
                            <mat-option  *ngFor="let item of taskPriorityList[0];let index=i" [value]="item.id" >
                                <div>
                                    {{item.name}}
                                </div>
                            </mat-option>
                        </mat-select>
                    </div>
                </div>
            </div>



            
            
            <div class="bggrey my-2">
                <div style="display: flex;gap: 5px" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-7 no-padding">
                        <div class="taskTitle">
                            <div>Status</div>
                        </div>
                        <div class="fieldPadding">
                            <mat-select [disabled]="!editable" class="form-control widthWebKit" placeholder="Enter activity status"
                                #taskStatus formControlName="taskStatus" name="item"  >
                                <mat-option *ngFor="let item of taskStatusList[0];let index=i" [value]="item.id"  >
                                    <!-- <div>
                                        {{item.name | capitalizeFirst}}
                                    </div> -->
                                    <div [ngStyle]="{'color': getColor(item.name)}">
                                        {{item.name | capitalizeFirst}}
                                    </div>
                                </mat-option>
                            </mat-select>
                                
                            <app-field-error-display [displayError]="true" style="color: #f24949 !important;" *ngIf="taskError" errorMsg="{{taskError}}">
                            </app-field-error-display>
                        </div>
                    </div>
                </div>
    
                
                <div style="display: flex;gap: 5px;flex-wrap: wrap !important;" >
                    <div class="lbl col-sm-8 col-md-7 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Target Potential</div>
                        </div>
                        <div class="fieldPadding">
                            <input (keyup)="resetErrors()" type="text" #targetResult 
                            placeholder="Enter potential"class="form-control widthWebKit"formControlName="targetResult"  autocomplete="off" /> 
                        </div>
                    </div>
                                   
                    <div class="lbl col-sm-8 col-md-7 col-lg-6 no-padding">
                        <div class="taskTitle">
                            <div>Business Potential</div>
                        </div>
                        <div class="fieldPadding" >
                            <input min="0" (keyup)="resetErrors()" type="number" #targetPotential 
                            placeholder="Enter ({{rupee_symbol}})"class="form-control widthWebKit"formControlName="targetPotential"autocomplete="off" />           
                        </div>
                    </div>               
                </div>
            </div>



            <div style="text-align: center;margin-top: 15px;">
                <ng-container >
                    <div class=" mgn-bt-20 mgn-up-10">
                        <button [ngClass]="{'cursorDiasable':  api_loading_CreateActivity}" type="button" class="btn btn-primary font-weight-bold cancelBtn" (click)="!api_loading_CreateActivity && goback()"
                            >Cancel
                        </button>
                        <button [ngClass]="{'cursorDiasable':  api_loading_CreateActivity}" type="button"  (click)="saveCreateTask()" class="btn btn-primary font-weight-bold confirmBtn">
                            <app-common-innerloading-spinner  *ngIf="api_loading_CreateActivity"></app-common-innerloading-spinner>
                           <span *ngIf="!api_loading_CreateActivity">Save</span>
                        </button>
                    </div>
                </ng-container>
            </div>
        </form>
    </div>
        <!-- <div class="imageClass">
            <img class="taskImg" src="/assets/images/crmImages/Addtasks.png" />
        </div> -->
    </div>
      

</section>


