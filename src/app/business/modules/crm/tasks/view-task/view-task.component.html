<section class="card">
  <div class="title-gb no-padding">
    <div class="dash-head text-primary">
      <span class="fa fa-arrow-left pointer-cursor border-cirlce" (click)="goBack()"></span>&nbsp;
      Task Overview
    </div>
  </div>
  
</section>



<section class="container card mt-4 mx-auto" *ngIf="taskDetails">
  <h3>{{taskDetails.title}}</h3>
  <div class="d-flex">
    <div class="dropdown">
      <button class="btn btn-outline-primary dropdown-toggle" data-toggle="dropdown">
        Actions <i class="fa fa-chevron-down"></i>
      </button>
      <div class="dropdown-menu">
        <a class="p-3 dropdown-item" (click)="openEditTask('Update')"><i class="text-info fa fa-edit"></i>&nbsp;&nbsp;<span class="text-dark">Edit Task</span></a><br><br>
        <a class="p-3 dropdown-item" ><i class="text-success fa fa-check-square"></i>&nbsp;&nbsp;<span class="text-dark">Mark as done</span></a><br><br>
        <a class="p-3 dropdown-item" (click)="createSubTask(taskUid)"><i class="text-primary fa fa-plus-square-o"></i>&nbsp;&nbsp;<span class="text-dark">Create Subtask</span></a><br><br>
        <!-- <a class="p-3 dropdown-item"><i class="text-light-blue fa fa-edit"></i>&nbsp;<span class="text-dark">Convert to loan</span></a><br><br>
        <a class="p-3 dropdown-item"><i class="text-light-blue fa fa-edit"></i>&nbsp;<span class="text-dark">Create Appointment</span></a><br><br>
        <a class="p-3 dropdown-item"><i class="text-light-blue fa fa-edit"></i>&nbsp;<span class="text-dark">Edit Actions</span></a><br><br> -->
      </div>
    </div>
    <div>
      <button class="btn btn-outline-primary mx-2" (click)="openAddNoteDialog('AddNote')">Add Note</button>
    </div>
    <!-- <div>
      <button class="btn btn-outline-primary">Chat</button>
    </div> -->
  </div>
</section>

<section>
  <app-common-innerloading-spinner *ngIf="api_loading"></app-common-innerloading-spinner>
  <div class="container card mt-2 mx-auto" *ngIf="!api_loading">
    <div class="col-md-12 no-padding-small" *ngIf="taskDetails">
      <div class="row d-lg-flex justify-content-between">
        <div class="border col-md-12 col-lg-12 col-sm-12 col-xs-12 no-padding">
          <div class="d-flex">
            <div class="progress-circle progress-70">
              <span class="progress-bar-text">{{taskDetails.status.name}}</span>
            </div>
            <div class="ml-3">
              <span class="details text-dark"><b>Manager : {{taskDetails.manager.name}} </b></span><br>
              <span class="details text-secondary">Assigned to {{taskDetails.assignee.name}} </span><br>
              <span class="details text-warning">Priority : {{taskDetails.priority.name}} </span><br>
              <span class="details text-secondary">Due date : {{taskDetails.dueDate}} </span>
            </div>
          </div>
          <div class="task-description">
            {{taskDetails.description}}
          </div>
        </div>
        
        <!-- <div class="border col-md-5 col-lg-5 col-sm-12 col-xs-12 no-padding">
          <div class="d-flex justify-content-between">
            <div>
              <span class="card-title"><b>Appointments</b></span> 
            </div>
            <div>
              <span class="pointer-cursor fa fa-external-link"></span>
            </div>
          </div>
          <hr class="my-2 py-2">
          <div class="m-auto text-center">
            <app-appointments></app-appointments>
          </div>
        </div> -->
      </div>
      
      <div class="row d-lg-flex justify-content-lg-start">
        <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2">
          <app-task-activity></app-task-activity>
        </div>
        <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2">
          <app-connections [taskid]="taskUid"></app-connections>
        </div>
        <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2">
          <div class="d-flex justify-content-between">
            <div>
              <span class="card-title"><b>Files</b></span> 
            </div>
            <div>
              <span class="pointer-cursor fa fa-external-link"></span>
            </div>
          </div>
          <hr class="my-2 py-2">
          <div class="text-left">
            <span>  
              <button  mat-button [mat-dialog-close]="true" class="lnk action pointer-cursor btn btn-primary upload-file-btn text-primary"  (click)="uploadFiles()"><i class="fa fa-paperclip mgn-rt-5" aria-hidden="true"></i>Upload
                  File<br><span class="text-dark btn-text">Add or Upload Files related to task</span>
              </button>
              <div class="col-sm-12 col-xs-12 chk-btns-div col-md-12 my-2">
                <div *ngFor="let attachment of taskDetails.attachments;let i=index" class="allNotesList">
                  <div class="notesListSection">
                    <div>{{attachment.originalName}}</div>
                    <a style="cursor: pointer;" href="{{attachment.s3path}}" target="_blank"><i class="fa fa-eye" aria-hidden="true"></i></a>
                  </div>
                 </div>
              </div>
            </span>
          </div>
        </div>
      </div>

      <div class="row d-lg-flex justify-content-lg-start" *ngIf="notesList">
        <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2">
          <div class="d-flex justify-content-between">
            <div>
              <span class="card-title"><b>Notes</b></span> 
            </div>
            <div>
              <span class="pointer-cursor fa fa-external-link"></span>
            </div>
          </div>
          <hr class="my-2 py-2">
          <div class="text-left">
            <span>
              <div class="col-sm-12 col-xs-12 chk-btns-div col-md-12 my-2">
                <div *ngFor="let note of taskDetails.notes;let i=index" class="allNotesList">
                  <div class="notesListSection">
                    Note {{i + 1}}
                    <div>{{note.createdDate}}</div>
                    <div style="cursor: pointer;"(click)="noteView(note)"><i class="fa fa-eye" aria-hidden="true"></i></div>
                  </div>
                 </div>
              </div>
            </span>
          </div>
        </div>
        <div  class="subtask-border  height-limit col col-md-8 col-lg-8 col-sm-12 col-xs-12 no-padding mt-2 subTask">
          <app-subtasks [taskid]="taskUid"></app-subtasks>
        </div>
      </div>
      
      
      <!-- <div class="subtask-border mt-4">
        <app-subtasks [taskid]="taskUid"></app-subtasks>
      </div> -->
     
    </div>
  </div>



</section>