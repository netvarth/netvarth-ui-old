<section class="card">
    <div class="title-gb no-padding">
      <div class="dash-head text-primary">
        <span class="fa fa-arrow-left pointer-cursor border-cirlce" (click)="goBack()"></span>&nbsp;
        Lead Overview
      </div>
    </div>
    
  </section>
  
  
  
  <section class="container card mt-4 mx-auto" *ngIf="leadDetails">
    <h3>{{leadDetails.title}}</h3>
    <div class="text-primary location-name mb-2">
      <i *ngIf="leadDetails.locationArea || leadDetails.location.name" class="fa fa-map-marker"></i>&nbsp;
      <span *ngIf="leadDetails.locationArea">{{leadDetails.locationArea}},</span>
      <span *ngIf="leadDetails.location.name">{{leadDetails.location.name}}</span>
    </div>
    <div class="d-flex" *ngIf="leadDetails.status.name != 'Completed'">
      <!-- <div class="dropdown">
        <button class="btn btn-outline-primary dropdown-toggle" data-toggle="dropdown">
          Actions <i class="fa fa-chevron-down"></i>
        </button>
        <div class="dropdown-menu">
          <a class="p-3 dropdown-item" (click)="openEditLead(leadDetails,'Update')"><i class="text-info fa fa-edit"></i>&nbsp;&nbsp;<span class="text-dark">Edit Lead</span></a><br><br>
          <a class="p-3 dropdown-item" (click)="progressbarDialog()"><i class='fa fa-spinner green-color'></i>&nbsp;&nbsp;<span class="text-dark">Change Progress</span></a><br><br>
          <a class="p-3 dropdown-item" (click)="openDialogStatusChange(leadDetails)"><i class="fa fa-refresh" aria-hidden="true"></i>&nbsp;&nbsp;<span class="text-dark">Change Status</span></a><br><br>
          <a class="p-3 dropdown-item"><i class="text-light-blue fa fa-edit"></i>&nbsp;<span class="text-dark">Convert to loan</span></a><br><br>
          <a class="p-3 dropdown-item"><i class="text-light-blue fa fa-edit"></i>&nbsp;<span class="text-dark">Create Appointment</span></a><br><br>
          <a class="p-3 dropdown-item"><i class="text-light-blue fa fa-edit"></i>&nbsp;<span class="text-dark">Edit Actions</span></a><br><br>
        </div>
        
      </div> -->
      <div>
        <a [matTooltipClass]="tooltipcls"
            class="navbar-item-color bold pointer-cursor">
              <button type="button"   [matMenuTriggerFor]="appMenu" class="btn btn-outline-primary"> 
                <span class="text-dark">Actions</span> <i style="margin-left: 5px;" class="fa fa-chevron-down"></i>
              </button>
              <mat-menu #appMenu="matMenu">
                  <!-- <button style="align-items:center !important;" mat-menu-item  (click)="openEditTask(taskDetails,'Update')" *ngIf="taskType != 'SubTask'" data-toggle="modal" data-target="#exampleModalCenter">
                    <span>
                      <img class="imageStatus" src="/assets/images/crmImages/edit.png" />
                    </span>
                    <span class="text-dark">Edit Activity</span>
                  </button> -->
                  <!-- <button style="align-items:center !important;" mat-menu-item (click)="createSubTask(taskUid)" >
                    <span >
                      <i class="text-primary fa fa-plus-square-o"></i>
                    </span>
                    <span class="text-dark">Create Subactivity</span>
                  </button> -->
                  <!-- <button style="align-items:baseline !important;" mat-menu-item (click)="progressbarDialog()" >
                    <span >
                      <i class='fa fa-spinner green-color'></i>&nbsp;&nbsp;
                    </span>
                    <span class="text-dark">Change Progress</span>
                  </button> -->
                  <button style="align-items:baseline !important;" mat-menu-item (click)="openDialogStatusChange(leadDetails)">
                    <span >
                      <i class="fa fa-refresh" aria-hidden="true"></i>&nbsp;&nbsp;
                    </span>
                    <span class="text-dark">Change Status</span>
                  </button>
                  <!-- <button style="align-items:baseline !important;" mat-menu-item (click)="openDialogStatusChange(leadDetails)" *ngIf="taskType === 'SubTask'">
                    <span >
                      <i class="fa fa-refresh" aria-hidden="true"></i>&nbsp;&nbsp;
                    </span>
                    <span class="text-dark">Change Status</span>
                  </button> -->
              </mat-menu>
            </a>
      </div>
      <div>
        <button class="btn btn-outline-primary mx-2" (click)="openAddNoteDialog('AddNote')">Add Remarks</button>
      </div>
    </div>
  </section>
   
  <section>
    <app-common-innerloading-spinner *ngIf="api_loading"></app-common-innerloading-spinner>
    <div class="container card mt-2 mx-auto" *ngIf="!api_loading">
      <div class="col-md-12 no-padding-small" *ngIf="leadDetails">
        <div class="row d-lg-flex justify-content-between">
          <div class="border col-md-12 col-lg-12 col-sm-12 col-xs-12 no-padding">
            <div class="d-flex">
              <div>
                <!-- <span class="progress-bar-text">{{leadDetails.status.name}}</span> -->
                <!-- <circle-progress class="circle__progress" [percent]="leadDetails.progress" [animation]="true"
                                [animationDuration]="300" [startFromZero]="true" [showInnerStroke]="true"
                                [titleFontSize]="'10'" [titleFontWeight]="'900'" [height]="'100'" [unitsFontSize]="'10'"
                                [unitsFontWeight]="'700'" [subtitle]="leadDetails.status.name" [subtitleFontSize]="'7'"
                                [lazy]="false"></circle-progress> -->
              </div>
              <div class="ml-3">
                <span class="details text-dark" *ngIf="leadDetails.customer.name"><b> {{customer_label}} : {{leadDetails.customer.name}} </b></span><br>

                <span class="details text-secondary" *ngIf="leadDetails.assignee.name"><b> Assigned to {{leadDetails.assignee.name}} </b></span><br>
                <span class="details text-secondary" *ngIf="leadDetails.manager.name">Manager : {{leadDetails.manager.name}}</span><br>
                <span class="details text-secondary" *ngIf="leadDetails.status.name"><b> Status : <span [class]="leadDetails.status.name">{{leadDetails.status.name}}</span></b></span><br>
                <span class="details text-warning" *ngIf="leadDetails.priority.name">Priority : {{leadDetails.priority.name}} </span><br>
              </div>
            </div>
            <div class="lead-description">
              {{leadDetails.description}}
            </div>
          </div>
          
          <!-- <div class="border col-md-5 col-lg-5 col-sm-12 col-xs-12 no-padding">
            <div class="d-flex justify-content-between">
              <div>
                <span class="card-title"><b>Appointments</b></span> 
              </div>
              <div>
                <span class="pointer-cursor fa fa-external-link"></span>
              </div>
            </div>
            <hr class="my-2 py-2">
            <div class="m-auto text-center">
              <app-appointments></app-appointments>
            </div>
          </div> -->
        </div>
        
        <div class="row d-lg-flex justify-content-lg-start">
          <!-- <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2">
            <app-lead-Lead></app-lead-Lead>
          </div> -->
  
          <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2">
            <div class="d-flex justify-content-between">
              <div class="my-auto">
                <span class="card-title"><b>Files</b></span> 
              </div>
              <div>
                <a mat-button [mat-dialog-close]="true" class="lnk action pointer-cursor btn btn-primary upload-file-btn text-primary"  (click)="uploadFiles()"><i class="fa fa-paperclip mgn-rt-5" aria-hidden="true"></i>Upload
                    File
                </a>
              </div>
              <!-- <div *ngIf="leadDetails.attachments.length>0">
                <span (click)="attatchmentDialog(leadDetails.attachments)" class="pointer-cursor fa fa-external-link"></span>
              </div> -->
            </div>
            <hr class="my-2 py-2">
            <div class="text-left">
              <span>
                <!-- <div class="clearfix"></div><br>
                <span class="label"><b>Uploaded Files</b></span> -->
                <div class="my-2" *ngIf="leadDetails.attachments.length >0">
                  <div *ngFor="let attachment of leadDetails.attachments;let i=index" class="allNotesList">
                    <a href="{{attachment.s3path}}" target="_blank">
                      <div class="notesListSection" style="cursor: pointer;">
                        <div class="text-primary">{{attachment.originalName}}<br><span class="label"><b>{{attachment.type}}</b></span></div>
                        <span>{{attachment.size}} MB</span>
                      </div>
                    </a>
                   </div>
                </div>
                <div class="text-center text-primary" *ngIf="leadDetails.attachments.length == 0">
                  <span>No Files Uploaded</span>
                </div>
              </span>
            </div>
          </div>
          <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2">
            <div class="d-flex justify-content-between">
              <div class="my-auto">
                <span class="card-title"><b>Token</b></span> 
              </div>
              <div>
                <a mat-button [mat-dialog-close]="true" class="lnk action pointer-cursor btn btn-primary upload-file-btn text-primary"  (click)="createToken()"><i class="fa fa-plus" aria-hidden="true"></i>
                  Token
                </a>
              </div>
              <!-- <div *ngIf="leadDetails.attachments.length>0">
                <span (click)="attatchmentDialog(leadDetails.attachments)" class="pointer-cursor fa fa-external-link"></span>
              </div> -->
            </div>
            <hr class="my-2 py-2">
            <div class="text-left">
              <span>
                <!-- <div class="clearfix"></div><br>
                <span class="label"><b>Uploaded Files</b></span> -->
                <div class="my-2" *ngIf="leadTokens.length >0">
                  <div *ngFor="let token of leadTokens;let i=index" class="allNotesList" >
                   
                      <div class="notesListSection" style="cursor: pointer;" (click)="goCheckinDetail(token.waitlistUid)">
                        <span class="pull-left mgn-lt-5 date circle-token bold">{{token.token}}</span>
                        <div class="text-primary" *ngIf="token.consumerName">{{token.consumerName}}<br><span class="label"><b>Created By : {{token.createdByName}}</b></span></div>
                       
                      </div>
                    
                   </div>
                </div>
                <div class="text-center text-primary" *ngIf="leadTokens.length == 0">
                  <span>No Records Found</span>
                </div>
              </span>
            </div>
          </div>
          <div class="border height-limit col-md-4 col-lg-4 col-sm-12 col-xs-12 no-padding mt-2" *ngIf="leadDetails.notes.length>0">
            <div class="d-flex justify-content-between">
              <div>
                <span class="card-title"><b>Notes</b></span> 
              </div>
              <div>
                <!-- <span (click)="noteView(leadDetails)" class="pointer-cursor fa fa-external-link"></span> -->
                
              </div>
            </div>
            <hr class="my-2 py-2">
            <div class="text-left">
              <span>
                <div class="my-2">
                  <div *ngFor="let note of leadDetails.notes;let i=index" class="allNotesList">
                    <div class="notesListSection">
                      {{note.note}}
                      <hr class="my-2 py-2">
                      {{note.createdDate | date : newDateFormat}}
                      <!-- <div>{{note.createdDate}}</div> -->
                      <!-- <div style="cursor: pointer;"(click)="noteView(note)"><i class="fa fa-eye" aria-hidden="true"></i></div> -->
                    </div>
                   </div>
                </div>
              </span>
            </div>
          </div>
        </div>
        <div class="row d-lg-flex justify-content-lg-start">
          <div  class="sublead-border  col-md-12 col-lg-12 col-sm-12 col-xs-12 no-padding mt-2">
            <app-tasks [leadid]="leadkid"></app-tasks>
          </div>
        </div>

        <!-- <div class="row d-lg-flex justify-content-lg-start">
          <div  class="sublead-border height-limit col-md-12 col-lg-12 col-sm-12 col-xs-12 no-padding mt-2">
            <app-leadlog [leadid]="leadkid"></app-leadlog>
          </div>
        </div> -->
       
      </div>
    </div>
  
  
  
  </section>