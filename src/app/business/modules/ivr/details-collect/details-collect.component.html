<section class="card">
  <div class="pointer-cursor">
    <div class="d-flex">
      <div> <i class="fa fa-arrow-left mr-2" aria-hidden="true" (click)="goBack()"></i></div>
      <div class="text-primary heading" class="back-btn">Back</div>
    </div>
  </div>
</section>

<div class="card">
  <div *ngIf="customerDetails">
    <div class="d-flex justify-content-between">
      <div>
        <div class="d-flex align-items-center">
          <div class="profile-pic">
            <span *ngIf="customerDetails.firstName" class="text-uppercase">{{customerDetails.firstName[0]}}</span>
            <span *ngIf="customerDetails.lastName" class="text-uppercase">{{customerDetails.lastName[0]}}</span>
            <span *ngIf="!customerDetails.firstName" class="text-uppercase"><i class="fa fa-ban"></i></span>
          </div>
          <div class="approvedColor text-capitalize mx-3 my-1 font-weight-bold">
            <span *ngIf="customerDetails.firstName">{{customerDetails.firstName}}</span><span
              *ngIf="customerDetails.lastName">&nbsp;{{customerDetails.lastName}}</span><br>
            <span *ngIf="customerDetails.id" class="text-grey">Id : {{customerDetails.id}}</span>
          </div>
        </div>
      </div>
      <div class="d-flex align-items-center">
        <a class="btn btn-primary" (click)="editCustomer(customerDetails.id)"><i class="fa fa-edit"></i>&nbsp;Edit</a>
      </div>
    </div>
    <div class="my-2">
      ( <span *ngIf="customerDetails.countryCode">{{customerDetails.countryCode}}</span>
      <span *ngIf="customerDetails.phoneNo">{{customerDetails.phoneNo}}</span> )
    </div>
    <div class="row font-small">
      <div class="col-md-3 col-sm-6 no-padding-small"  *ngIf="customerDetails.gender">
        <span class="font-weight-bold">Gender : </span>
        <span>{{customerDetails.gender}}</span>
      </div>
      <div class="col-md-3 col-sm-6 no-padding-small" *ngIf="customerDetails.dob">
        <span class="font-weight-bold">Dob : </span>
        <span>{{customerDetails.dob}}</span>
      </div>
      <div class="col-md-6 no-padding-small" *ngIf="customerDetails.email">
        <span class="font-weight-bold">Email : </span>
        <span>{{customerDetails.email}}</span>
      </div>
    </div>
  </div>
</div>

<div class="card mt-2" *ngIf="callData">
  <div class="row px-1">
    <div class="col-md-3 col-xs-6 mt-2">
      <div class="font-weight-bold">
        <span *ngIf="callData && callData.consumerPhone && callData.consumerPhone.number">
          {{callData.consumerPhone.number}}
        </span>
      </div>
      <div>
        <span *ngIf="callData && callData.language"
          class="text-primary font-weight-600">{{callData.language}}</span>
      </div>
    </div>

    <div class="col-md-3 col-xs-6 mt-2">
      <div class="font-weight-bold">
        <span>
          <span *ngIf="callData && callData.userName">{{callData.userName}}</span>
          <span *ngIf="callData && !callData.userName">Not Assigned</span>
        </span>
      </div>
      <div *ngIf="callData && callData.callStatus">
        <span [class]="'status-' + callData.callStatus"
          class="text-capitalize">{{callData.callStatus}}</span>
      </div>
    </div>

    <div class="col-md-6 col-xs-12 mt-2">
      <div class="d-flex text-center">
        <button type="button" class="btn btn-light bg-light mr-2 font-weight-600"
          (click)="openUsersPopup(callData.uid)" *ngIf="callData && !callData.userId"
          tooltipPosition="top" pTooltip="Assign"><img width="20" src="./assets/images/ivr/unassign.png">
        </button>

        <button type="button" class="btn btn-light mr-2 font-weight-600" (click)="getCallBack(callData.uid)"
          tooltipPosition="top" pTooltip="CallBack"><img width="20" src="./assets/images/ivr/callback.png">
        </button>

        <button type="button" class="btn btn-light mr-2 font-weight-600" (click)="unassignToCall(callData.uid)"
          *ngIf="callData && callData.userId" tooltipPosition="top" pTooltip="Unassign"><img width="20"
            src="./assets/images/ivr/unassign.png">
        </button>

        <button type="button" class="btn btn-light bg-light mr-2 font-weight-600 text-light"
          (click)="markAsComplete(callData.uid)" tooltipPosition="top" pTooltip="Complete"><i
            class="fa fa-check text-grey" aria-hidden="true"></i>
        </button>

        <button type="button" class="btn btn-light bg-light font-weight-600" (click)="viewCall(callData.uid)"
          tooltipPosition="top" pTooltip="View"><i class="fa fa-eye text-grey" aria-hidden="true"></i>
        </button>
      </div>
    </div>
  </div>
</div>


<div class="mt-2">
  <form enctype="multipart/form-data">
    <div class="row px-2">
      <div>
        <mat-accordion>
          <mat-expansion-panel [expanded]="customerDetailsPanel" (opened)="customerDetailsPanel = true"
            (closed)="customerDetailsPanel = false">
            <mat-expansion-panel-header>
              <mat-panel-title>
                <div class="d-flex justify-content-center">
                  <div class="d-flex align-items-center text-primary font-weight-bold">
                    Consultation Details
                  </div>
                </div>
              </mat-panel-title>
            </mat-expansion-panel-header>
            <div>
              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">Chief Complaint(Reason for the Call)</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text"
                        placeholder="Enter Chief Complaint(Reason for the Call)" class="form-control" autocomplete="off"
                         />
                    </div>
                  </div>
                </div>
              </div>


              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">When did the Problem starts?</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter When did the Problem starts?"
                        class="form-control" autocomplete="off"  />
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">Precipitating Condition(What Caused it?)</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter Precipitating Condition(What Caused it?)"
                        class="form-control" autocomplete="off" />
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">Family History</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter Family History"
                        class="form-control" autocomplete="off" />
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">Treatment History</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter Treatment History"
                        class="form-control" autocomplete="off" />
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">Severity (as Assessed)</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter Severity (as Assessed)"
                        class="form-control" autocomplete="off" />
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">Your Approch to the call </div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter Your Approch to the call " class="form-control"
                        autocomplete="off" />
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">End of the call - Status</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter End of the call - Status" class="form-control"
                        autocomplete="off" />
                    </div>
                  </div>
                </div>
              </div>

              <div>
                <div class="bggrey my-2">
                  <div>
                    <div class="d-flex">
                      <div class="form-title">Ask your questions here</div>
                    </div>
                    <div class="fieldPadding">
                      <input (keyup)="resetErrors()" #firstname type="text" placeholder="Enter Ask your questions here"
                        class="form-control" autocomplete="off" />
                    </div>
                  </div>
                </div>
              </div>


            </div>
            <div>
              <button type="button"
                class="btn btn-primary open-all-btn" (click)="saveCustomerDetails()">Save</button>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>
    </div>
  </form>
</div>

<div>
  <div class="row">
    <div class="col-md-8 no-padding-small">
      <div class="card mt-2">
        <div>
          <span class="font-weight-bold">Call History</span>
        </div>
        <div *ngIf="customerCallHistory && customerCallHistory.length>0">
          <div class="card mt-2" *ngFor="let call of customerCallHistory">
            <div class="row px-1">
              <div class="col-md-3 col-xs-6 mt-2">
                <div class="font-weight-bold">
                  <!-- <span *ngIf="call && call.consumerPhone && call.consumerPhone.countryCode">
                                                        {{call.consumerPhone.countryCode}}
                                                      </span> -->
                  <span *ngIf="call && call.consumerPhone && call.consumerPhone.number">
                    {{call.consumerPhone.number}}
                  </span>
                </div>
                <div>
                  <!-- <span *ngIf="call && call.consumerId" class="font-weight-600">#{{call.consumerId}}</span>&nbsp; -->
                  <span *ngIf="call && call.language" class="text-primary font-weight-600">{{call.language}}</span>
                </div>
              </div>

              <div class="col-md-3 col-xs-6 mt-2">
                <div class="font-weight-bold">
                  <span>
                    <span *ngIf="call && call.userName">{{call.userName}}</span>
                    <span *ngIf="call && !call.userName">Not Assigned</span>
                  </span>
                </div>
                <div>
                  <span [class]="'status-' + call.callStatus" class="text-capitalize">{{call.callStatus}}</span>
                </div>
              </div>

              <div class="col-md-6 col-xs-12 mt-2">
                <div class="d-flex text-center">
                  <button type="button" class="btn btn-light bg-light mr-2 font-weight-600" (click)="openUsersPopup(call.uid)"
                    *ngIf="call && !call.userId" tooltipPosition="top" pTooltip="Assign"><img width="20"
                      src="./assets/images/ivr/unassign.png">
                  </button>

                  <button type="button" class="btn btn-light mr-2 font-weight-600" (click)="getCallBack(call.uid)"
                    tooltipPosition="top" pTooltip="CallBack"><img width="20" src="./assets/images/ivr/callback.png">
                  </button>

                  <button type="button" class="btn btn-light mr-2 font-weight-600" (click)="unassignToCall(call.uid)"
                    *ngIf="call && call.userId" tooltipPosition="top" pTooltip="Unassign"><img width="20"
                      src="./assets/images/ivr/unassign.png">
                  </button>

                  <button type="button" class="btn btn-light bg-light mr-2 font-weight-600 text-light"
                    (click)="markAsComplete(call.uid)" tooltipPosition="top" pTooltip="Complete"><i
                      class="fa fa-check text-grey" aria-hidden="true"></i>
                  </button>

                  <button type="button" class="btn btn-light bg-light font-weight-600" (click)="viewCall(call.uid)"
                    tooltipPosition="top" pTooltip="View"><i class="fa fa-eye text-grey" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="text-center" *ngIf="!customerCallHistory || (customerCallHistory && customerCallHistory.length==0)">
          <span class="font-weight-bold">No Call History Found</span>
        </div>
      </div>
    </div>
    <div class="col-md-4 no-padding-small">
      <div class="card mt-2">
        <div>
          <span class="font-weight-bold">Remarks</span>
        </div>
        <div class="card mt-2">
          Patient is Suffering with High Fever from the Past Four Days
        </div>
        <div class="card mt-2">
          Patient have Cold and Cough symptoms
        </div>
        <div class="card mt-2">
          No Fever,Cough or Cold Only Body Pains
        </div>
      </div>
    </div>
  </div>
</div>
