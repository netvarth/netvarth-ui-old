<section class="">
    <div class="title-gb no-padding">
        <div class="mgn-up-15 mgn-lt-15 mgn-rt-15 dash-head">
        System Alerts
          <i class="fa fa-question-circle-o fa-lg fl-right" (click)="redirecToHelp()"></i>
        </div>
    </div>
  </section>
<section>
    <div class="content">
        <app-common-innerloading-spinner *ngIf="api_loading"></app-common-innerloading-spinner>
        <div class="dashboard audit" *ngIf="!api_loading">
            <div class="col-md-12 no-padding-small">
                <div class="row">
                    <div class="card p0 w-dta">
                        <div class="table-responsive dash-list">
                            <table class="table">
                                <thead>
                                    <tr tble-filtr-tr>
                                        <th>{{subject_cap}}</th>
                                        <th>{{details_cap}}</th>
                                        <th>{{acknowledged_cap}}</th>
                                        <th>{{date_cap}}</th>
                                        <th>
                                            <table class="fltr-tbl">
                                                <tr>                                                   
                                                    <td>
                                                        <span>                                                            
                                                                <i class="icon-filter-one" (click)="showFilterSidebar()" [matTooltipClass]="tooltipcls"
                                                                [matTooltip]="filtericonTooltip"></i>
                                                        </span>
                                                    </td>
                                                </tr>
                                            </table>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <!-- <aside class="filterSidebar" *ngIf="filter_sidebar">
                                            <section class="sidebar sidebar-bottom" style="overflow:auto;height:568px">
                                                <div class="filterClosebtn">
                                                    <i class="icon-filter-one-op ng-star-inserted pointer-cursor " (click)="hideFilterSidebar()" [matTooltipClass]="tooltipcls" [matTooltip]="'Close filter window'"></i>
                                                    <span *ngIf="filterapplied === true" class="clearFilter" (click)="clearFilter()"> Clear All</span>
                                                </div>
                                                <ul class="sidebar-menu">
                                                    <li>
                                                        <div>
                                                            <label class="filterHeaders">{{acknow_status_cap}}</label>
                                                                <li class="filterli filterCheckboxborder filtercheckboxSize">
                                                                        <mat-checkbox [value]="'true'" [(ngModel)]="ackStatus" (change)="do_search(false, 'ackStatus')"> {{acknowledged_cap}}</mat-checkbox>
                                                                </li>
                                                                <li class="filterli filterCheckboxborder filtercheckboxSize">
                                                                        <mat-checkbox [value]="'false'" [(ngModel)]="notAckStatus" (change)="do_search(false, 'notAckStatus')"> {{not_acknowledged_cap}}</mat-checkbox>
                                                                </li>
                                                        </div>
                                                        <div>
                                                            <label class="filterHeaders"> From</label>
                                                            <li class="filterli filterDatepicker">
                                                                <input class="filterTextbox" type="text" [(ngModel)]="alertStartdate" [min]="minday" [max]="maxDate"
                                                                [matDatepicker]="picker" #Fdate (dateChange)="do_search(false)" (blur)="do_search(false)" placeholder="Start date" readonly>
                                                                <mat-datepicker-toggle matSuffix [for]="picker">
                                                                </mat-datepicker-toggle>
                                                                <mat-datepicker #picker></mat-datepicker> 
                                                            </li>
                                                        </div>
                                                        <div>
                                                            <label class="filterHeaders"> To</label>
                                                            <li class="filterli filterDatepicker">
                                                                <input class="filterTextbox" type="text" [(ngModel)]="alertEnddate" [min]="endminday" [max]="maxDate"
                                                                [matDatepicker]="picker1" #Edate (dateChange)="do_search(false)" (blur)="do_search(false)" placeholder="End date" readonly>
                                                                <mat-datepicker-toggle matSuffix [for]="picker1">
                                                                </mat-datepicker-toggle>
                                                                <mat-datepicker #picker1></mat-datepicker> 
                                                            </li>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </section>
                                        </aside> -->

                                        <div>
                                            <aside class="filterSidebar filter-sidebar" *ngIf="filter_sidebar">
                                              <section id="filterContainer" class="sidebar sidebar-bottom checkfilter filter-container">
                                                <div class="filterClosebtn filter-head" [class.pd-btm-30]="!filterapplied">
                                                  <span class="filter-head-title">Filters</span>
                                                  <i class="icon-filter-one-op ng-star-inserted pointer-cursor pull-right" (click)="hideFilterSidebar()"
                                                    [matTooltipClass]="tooltipcls" [matTooltip]="'Close filter window'"></i>
                                                </div>
                                                <div [ngStyle]="{'height.px': filterapplied === true ? 95 : 44 }">&nbsp;</div>
                                                <ul class="sidebar-menu accordion" id="accordion1">
                                                 
                                                  <div class="card">
                                                    <div class="card-header">
                                                      <h2 class="mb-0">
                                                        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseId1"
                                                          aria-expanded="false">
                                                          <div>
                                                            <div style="display: inline-block !important;">
                                                              <i class="fa fa-calendar"></i>
                                                            </div>
                                                            <span>&nbsp;Filter by Date</span>
                                                          </div>
                                                          <i class="fa fa-angle-down"></i>
                                                        </button>
                                                      </h2>
                                                    </div>
                                                    
                                                    <div id="collapseId1" class="collapse in" data-parent="#accordion1">
                                                      <div class="card-body">
                                                        <div class="filterTextinput filter-text-input">
                                                            <div style="color: #374957 !important;
                                                            font-weight: 700 !important;
                                                            font-size: 14px !important;">From</div>
                                                          <li class="filterli filter-li">
                                                            <input class="filterTextbox" type="text" [(ngModel)]="alertStartdate" [min]="minday" [max]="maxDate"
                                                                [matDatepicker]="picker" #Fdate (dateChange)="keyPressed()" placeholder="Enter Start date" readonly>
                                                                <mat-datepicker-toggle matSuffix [for]="picker">
                                                                </mat-datepicker-toggle>
                                                                <mat-datepicker #picker></mat-datepicker> 
                                                          </li>
                                                        </div>
    
                                                        <div class="filterTextinput filter-text-input">
                                                            <div style="color: #374957 !important;
                                                            font-weight: 700 !important;
                                                            font-size: 14px !important;">To</div>
                                                            <li class="filterli filter-li">
                                                                <input class="filterTextbox" type="text" [(ngModel)]="alertEnddate" [min]="endminday" [max]="maxDate"
                                                                [matDatepicker]="picker1" #Edate (dateChange)="keyPressed()" placeholder="Enter End date" readonly>
                                                                <mat-datepicker-toggle matSuffix [for]="picker1">
                                                                </mat-datepicker-toggle>
                                                                <mat-datepicker #picker1></mat-datepicker> 
                                                            </li>
                                                          </div>
                                                      </div>
                                                    </div>
                                                    
                                                  </div>

                                                  <div class="card">
                                                    <div class="card-header">
                                                      <h2 class="mb-0">
                                                        <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseId2"
                                                          aria-expanded="false">
                                                          <div>
                                                            <div style="display: inline-block !important;">
                                                              <!-- <i class="fa fa-calendar"></i> -->
                                                            </div>
                                                            <span>&nbsp;{{acknow_status_cap}}</span>
                                                          </div>
                                                          <i class="fa fa-angle-down"></i>
                                                        </button>
                                                      </h2>
                                                    </div>
                                                    <div id="collapseId2" class="collapse in" data-parent="#accordion1" style="margin-top: 5px;">
                                                      <div class="card-body">
                                                        <div>
                                                            <!-- <label class="filterHeaders">{{acknow_status_cap}}</label> -->
                                                                <li class="filterli filterCheckboxborder filtercheckboxSize">
                                                                        <mat-checkbox [value]="'true'" [(ngModel)]="ackStatus" (change)="keyPressed()" > {{acknowledged_cap}}</mat-checkbox>
                                                                </li>
                                                                <li class="filterli filterCheckboxborder filtercheckboxSize">
                                                                        <mat-checkbox [value]="'false'" [(ngModel)]="notAckStatus"(change)="keyPressed()" > {{not_acknowledged_cap}}</mat-checkbox>
                                                                </li>
                                                        </div>
                                                      </div>
                                                    </div>
                                                    
                                                  </div>
                                                
                                                </ul>
                                              </section>
                                              <div class="filter-footer" *ngIf="filterapplied === true">
                                                <button class="btn reset-btn" (click)="clearFilter()">
                                                  <i class="fa fa-undo"></i>&nbsp;Reset
                                                </button>
                                                <button class="btn apply-btn" (click)="do_search(false)">
                                                  <i class="fa fa-check"></i>&nbsp;Apply
                                                </button>
                                              </div>
                                            </aside>
                                          </div>    













                                    </tr>
                                </tbody>
                                <tbody>
                                    <ng-container *ngIf="alertStatus==1">
                                        <tr>
                                            <td class="spinner" colspan="5">
                                                <app-common-innerloading-spinner spinnerParams="loadingParams">
                                                </app-common-innerloading-spinner>
                                            </td>
                                        </tr>
                                    </ng-container>
                                    <ng-container *ngIf="alertStatus==2">
                                        <tr>
                                            <td class="nodatafound" colspan="5">{{no_alerts_found_cap}}</td>
                                        </tr>
                                    </ng-container>
                                    <ng-container *ngIf="alertStatus==3">
                                        <tr *ngFor="let alrt of alert_details">
                                            <td data-title="Subject" class="td1"
                                                [class.info]="alrt.severity.name=='Info'"
                                                [class.warning]="alrt.severity.name=='Warning'"
                                                [class.high]="alrt.severity.name=='High'"
                                                [class.error]="alrt.severity.name=='Critical'">
                                                {{alrt.subject}}</td>

                                            <td data-title="Details" class="td2"
                                                [class.info]="alrt.severity.name=='Info'"
                                                [class.warning]="alrt.severity.name=='Warning'"
                                                [class.high]="alrt.severity.name=='High'"
                                                [class.error]="alrt.severity.name=='Critical'">{{alrt.text}}
                                            </td>

                                            <td data-title="Act Status" class="td3"
                                                [class.info]="alrt.severity.name=='Info'"
                                                [class.warning]="alrt.severity.name=='Warning'"
                                                [class.high]="alrt.severity.name=='High'"
                                                [class.error]="alrt.severity.name=='Critical'">{{ (alrt.ackStatus) ?
'Yes' : 'No'}}</td>

                                            <td data-title="Date" class="td4" [class.info]="alrt.severity.name=='Info'"
                                                [class.warning]="alrt.severity.name=='Warning'"
                                                [class.high]="alrt.severity.name=='High'"
                                                [class.error]="alrt.severity.name=='Critical'">{{alrt.createdOn |
date:newDateFormat}}</td>

                                            <td data-title="Action" class="td5"
                                                [class.info]="alrt.severity.name=='Info'"
                                                [class.warning]="alrt.severity.name=='Warning'"
                                                [class.high]="alrt.severity.name=='High'"
                                                [class.error]="alrt.severity.name=='Critical'"><span
                                                    class="fa fa-thumbs-o-up pointr" [matTooltip]="'Acknowledge'"
                                                    *ngIf="alrt.ackStatus==false && alrt.ackRequired==true"
                                                    (click)="alertAcknowledge(alrt)"></span></td>
                                        </tr>
                                    </ng-container>
                                </tbody>
                            </table>
                            <div class="search_paging" *ngIf="alert_details.length>0">
                                <app-pager [total_pages]="gettotalCnt()" [pagesize]="getperPage()"
                                    (pagerclick)="handle_pageclick($event)" [curpage]="startpageval">
                                </app-pager>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>