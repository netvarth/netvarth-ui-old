<section class="">
    <div class="card title-gb">
        <div class="mgn-up-15 mgn-lt-15 mgn-rt-15 dash-head">
            Subscription Plan
            <i class="fa fa-question-circle-o fa-lg fl-right" (click)="redirecToHelp()"></i>
        </div>
    </div>
</section>
<section class="lic_revamp">
    <div class="content w-manager settings comn-cls lic-page" style="width: 100%;">
        <div class="col-md-12 no-padding-small">
            <div class="w-dta">
                <div class="row">
                    <!-- New Revamp -->
                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9 no-padding">
                        <div class="card no-padding-small">
                            <div class="disp-flex">
                                <p class="form-level-settings flx_1 mgn-lt-10">{{frm_lic_cap}}<a
                                        class="learnmore-pointer" id="customer-help"
                                        (click)="learnmore_clicked('upgradelicense', $event)">{{learn_more}}</a> </p>
                                <button mat-flat-button [matMenuTriggerFor]="menu">
                                    <i class="fa fa-ellipsis-v"></i>
                                </button>
                                <mat-menu #menu="matMenu">
                                    <button mat-menu-item (click)="showLicenseUsage()">License Usage</button>
                                    <button mat-menu-item (click)="showLicenceHistory()">License History</button>
                                    <button mat-menu-item (click)="gotoPaymentHistory()">Payment History</button>
                                    <button mat-menu-item (click)="showInvoiceStatus()">License Statement</button>
                                </mat-menu>
                            </div>
                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mgn-up-10 no-padding-small">

                                <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                                    <!-- Sidenav for annual -->
                                    <div class="anual_side" *ngIf="changelicence"
                                        [ngStyle]="{ 'margin-top' : height+'px'}">
                                        <aside>
                                            <div class="anual_outr">
                                                <div class="inside_anual">Subscription Plan</div>
                                                <div>Annual</div>
                                            </div>
                                            <div class="anual_outr">
                                                <div class="inside_anual">Period</div>
                                                <div>1 year</div>
                                            </div>
                                            <div class="anual_outr">
                                                <div class="inside_anual">Effective
                                                    From</div>
                                                <div>{{effectivedate | date:newDateFormat}}</div>
                                            </div>
                                            <div class="anual_outr" *ngIf="showAmounts">
                                                <div class="inside_anual">Package</div>
                                                <div>{{currentlicense_details.accountLicense.displayName}}</div>
                                            </div>
                                            <div class="anual_outr" *ngIf="showAmounts">
                                                <div class="inside_anual">Grand Total</div>
                                                <div class="rupee-font">{{grandTotal| currency:'&#8377;'}}</div>
                                            </div>
                                            <div class="anual_outr" *ngIf="showAmounts">
                                                <div class="inside_anual">Applied Discount</div>
                                                <div class="rupee-font">{{appliedDiscount | currency:'&#8377;'}}</div>
                                            </div>
                                            <div class="anual_outr" *ngIf="showAmounts">
                                                <div class="inside_anual">Net Total</div>
                                                <div class="rupee-font">{{netTotal | currency:'&#8377;'}}</div>
                                            </div>
                                            <div class="mgn-up-10">
                                                <div class="actions">
                                                    <button mat-flat-button
                                                        (click)="cancelAssignServices()">Cancel</button>
                                                    &nbsp;&nbsp;&nbsp;
                                                    <button mat-flat-button
                                                        (click)="doUpgradeSubcription('ANNUAL')">Ok</button>
                                                </div>
                                            </div>
                                        </aside>
                                    </div>


                                    <div class="txt_sub_plan">Your Subscription Plan</div>
                                    <div>
                                        <h2 class="clr_pitch_blu">{{current_lic}}</h2>
                                    </div>
                                    <div class="mgn-up-10" *ngIf="upgradablepackages.length > 0">
                                        <button mat-flat-button class="btn_upgrde"
                                            (click)="showupgradeLicense()">Upgrade your
                                            plan</button>
                                    </div>

                                    <div class="ln-ht-3 clr_grey">
                                        <span *ngIf="license_message != ''">
                                            Valid
                                            <span class="clr_pitch_blu">{{license_message}}
                                            </span> |
                                        </span>
                                        <span *ngIf="licenseDisplayName === 'Monthly'">
                                            Billed {{licenseDisplayName}}</span>
                                        <span *ngIf="licenseDisplayName === 'Annual'">
                                            {{licenseDisplayName}} Subscription</span>
                                    </div>
                                    <div class="cancel_an"
                                        *ngIf="licensePlan == 'MONTHLY' && statusOfLicense == 0 && showAmounts">
                                        <button mat-flat-button class="btn_switch" (click)="openAnnualSection()">Switch
                                            to Annual</button>
                                        <sup class="txt_off">{{annualdiscount}}% OFF</sup>
                                    </div>
                                    <div *ngIf="licensePlan == 'MONTHLY' && statusOfLicense == 1">
                                        <div class="cancel_an">
                                            <div class="fnt-san_serif">
                                                You changed your license subscription type to
                                                <strong>Annual.</strong>
                                                The subscription license statement will be generated on
                                                {{effectivedate | date: newDateFormat}}.
                                            </div>
                                            <button mat-flat-button class="btn_switch mgn-up-10 mgn-bt-10"
                                                (click)="doUpgradeSubcription('MONTHLY')">Cancel Annual</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
                                    <div *ngIf="currentlicense_details.dueAmount > 0"
                                        class="card no-mgn-bt card_addon txt_centr">
                                        <div class="txt_adon">Bill Due</div>
                                        <div>Amount - <span
                                                class="clr_pitch_blu rupee-font">{{currentlicense_details.dueAmount
                                                | currency:'&#8377;'}}</span></div>
                                        <div *ngIf="invoices.length != 0">Due Date - <span
                                                class="clr_pitch_blu">{{currentlicense_details.nextPaymentOn
                                                | date: newDateFormat }}</span></div>
                                        <div *ngIf="invoices.length != 0" class="mgn-up-10"><span
                                                class="btn_pay custId-cursor" (click)="showUnpaidInvoice()">PAY</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8  mgn-bt-10">
                                <div class="mgn-up-20">
                                    <div class="card card_addon">
                                        <span class="txt_adon">Add-ons&nbsp;&nbsp;<i
                                                *ngIf="adon_list && adon_list.length === 0 && addon_metric.length > 0"
                                                (click)="gotoAddOns()" class="fa fa-plus-circle fa-lg custId-cursor"
                                                aria-hidden="true"></i>
                                            <span *ngIf="adon_list && adon_list.length > 0 && addon_metric.length > 0"
                                                class="addbt clr_pitch_blu btn_ad_more" (click)="gotoAddOns()"></span>
                                        </span>
                                        <div class="adon_lst" *ngIf="adon_list && adon_list.length > 0">
                                            <div *ngFor="let adon of adon_list">
                                                {{adon.name}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div class="card card_addon custId-cursor" (click)="gotoJaldeeKeywords()">
                                        <span class="txt_adon">Jaldee Search Keywords</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div [innerHTML]="payment_popup" #div [style.display]="'none'"></div>
</section>