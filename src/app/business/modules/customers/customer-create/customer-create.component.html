<section class=""
    *ngIf="source !=='token' && source !=='checkin' && source !=='appointment' && source !=='appt-block' && source !== 'waitlist-block' && source !== 'clist' && !viewCustomer && !loading">
    <div class="card title-gb rounded-0">
        <h5 class="mgn-up-10">
            <span class="fa fa-arrow-left pointer-cursor" (click)="onCancel()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            {{customerName}}

        </h5>
    </div>
</section>
<section *ngIf="viewCustomer && customerAction === '' && !showMoreHistory">
    <div class="card title-gb">
        <h5 class="mgn-up-10">
            <span class="fa fa-arrow-left pointer-cursor" (click)="goBack()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            {{customer_label | capitalizeFirst}} details
        </h5>
    </div>
</section>
<section *ngIf="customerAction === 'inbox'">
    <div class="card title-gb">
        <h5 class="mgn-up-10">
            <span class="fa fa-arrow-left pointer-cursor"
                (click)="goBackfromAction()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            Communication history
        </h5>
    </div>
</section>
<section *ngIf="showMoreHistory && customerAction === ''">
    <div class="card title-gb">
        <h5 class="mgn-up-10">
            <span class="fa fa-arrow-left pointer-cursor" (click)="showHistory()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            History
        </h5>
    </div>
</section>
<section class="" 
    *ngIf="source ==='token' || source ==='checkin' || source ==='appointment' || source === 'appt-block' || source === 'waitlist-block' || source === 'clist'">
    <div class="card title-gb">
        <h5 class="mgn-up-10">
            <span class="fa fa-arrow-left pointer-cursor" (click)="onCancel()"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            {{heading}}
        </h5>
    </div>
</section>
<div class="card mgn-up-10" >
    <section class="createCustomer">
        <div class="content loc-list p-checkin col-lg-12 no-padding-small">
            <div class="card card-custom gutter-b example example-compact rounded-0 p-0" >
                <!--begin::Form-->
                <div class="card-body" *ngIf="!qnrLoaded || !loaded">
                    <app-common-innerloading-spinner></app-common-innerloading-spinner>
                </div>
                <form *ngIf="!loading && !viewCustomer && qnrLoaded" [formGroup]="amForm" novalidate (ngSubmit)="amForm.valid &&
                onSubmit(amForm.value)" (keyup)="resetApiErrors()" class="form" id="customer_creation" style="border: 1px solid #e2dddd;border-radius: 5px;">
                    <div class="card-body" *ngIf="!showBookingQnr" >
                        <div class="form-group row">
                            <div class="col-lg-4">
                                <label class="p-0 m-0 pt-1 form-text-light">First Name</label>
                                <input type="email" name="first_name" formControlName="first_name" class="form-control" id="first_name"
                                    placeholder="Enter Your {{f_name_cap}}"  autocomplete="off"
                                    (blur)="onFieldBlur('first_name')" />
                                <app-field-error-display [displayError]="fed_service.isFieldValid(amForm,'first_name')"
                                    [errorMsgs]="fed_service.getErrorMessage(amForm,'first_name',
                                    {
                                    'required' : 'Please enter first name',
                                    'pattern' : 'Only letters are allowed'
                                    })">
                                </app-field-error-display>
                            </div>
                            <div class="col-lg-4">
                                <label class="p-0 m-0 pt-1 form-text-light">Last Name</label>
                                <input type="email" class="form-control" id="last_name" placeholder="Enter Your {{l_name_cap}}"
                                    formControlName="last_name" autocomplete="off" (blur)="onFieldBlur('last_name')" />
                                <app-field-error-display [displayError]="fed_service.isFieldValid(amForm,'last_name')"
                                    [errorMsgs]="fed_service.getErrorMessage(amForm,'last_name',
                                        {
                                        'required' : 'Please enter last name',
                                        'pattern' : 'Only letters are allowed'
                                        })">
                                </app-field-error-display>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-lg-4 col-12 col-sm-12" *ngIf="haveMobile">
                                <label class="p-0 pt-1 m-0 form-text-light">Mobile</label>
                                <div class="input-group">
                                    <div class="countrycode">
                                        <input type="text"
                                         [readonly]="action === 'edit'&& customer[0].jaldeeConsumer !=0 && customer[0].phoneNo"
                                            (keypress)="isNumericSign($event)" matInput class="form-control"
                                            id="countryCode" placeholder="Country code " formControlName="countryCode"
                                            autocomplete="off" maxlength="5" style="width: 90%;">
                                    </div>
                                    <div class="mobilenumber">
                                        <input
                                            [readonly]="action === 'edit'&& customer[0].jaldeeConsumer !=0 && customer[0].phoneNo"
                                            type="text" class="form-control" (keypress)="isNumeric($event)"
                                            id="mobile_number" placeholder="Enter Your {{mobile_cap}} " formControlName="mobile_number"
                                            autocomplete="off" maxlength=10 style="width: 100%;" />
                                    </div>
                                    <app-field-error-display
                                        [displayError]="fed_service.isFieldValid(amForm,'mobile_number')" [errorMsgs]="fed_service.getErrorMessage(amForm,'mobile_number',
                                            {
                                                'required' : 'Mobile number is required',
                                                'minlength' : 'Enter a 10 digit mobile number',
                                                'maxlength' : 'Enter a 10 digit mobile number',
                                                'pattern' : 'Only numbers are allowed'
                                            })">
                                    </app-field-error-display>
                                </div>
                            </div>
                            <div class="col-lg-4" *ngIf="customidFormat && customidFormat.customerSeriesEnum && customidFormat.customerSeriesEnum === 'MANUAL'">
                                <label class="p-0 pt-1 m-0 form-text-light">{{customerPlaceholder | capitalizeFirst}}</label>
                                <div class="input-group">
                                    <input type="text" class="form-control" id="customer_id"
                                        placeholder="{{customerPlaceholder | capitalizeFirst}}"
                                        formControlName="customer_id" autocomplete="off"
                                        (blur)="onFieldBlur('customer_id')" />
                                    <div class="input-group-append"></div>
                                </div>
                                <app-field-error-display [displayError]="fed_service.isFieldValid(amForm,'customer_id')"
                                    [errorMsgs]="fed_service.getErrorMessage(amForm,'customer_id',
                                        {
                                        'required' : 'Please enter ' + customer_label + ' id'
                                        })">
                                </app-field-error-display>
                            </div>
                            <div class="col-lg-4">
                                <div class="form-group">
                                    <label class="p-0 pt-1 m-0 form-text-light">Email</label>
                                    <div class="input-group">
                                        <div class="input-group-prepend"></div>
                                        <input type="text" class="form-control" id="email_id" placeholder="Email(user@xyz.com)"
                                            formControlName="email_id" autocomplete="off" />
                                    </div>
                                    <app-field-error-display [displayError]="fed_service.isFieldValid(amForm,'email_id')"
                                        errorMsg="Please enter valid email.">
                                    </app-field-error-display>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-lg-4 form-group ">
                                <label class="p-0 py-1 m-0 form-text-light col-form-label" for="gender">{{gender_cap}}</label>
                                <mat-radio-group formControlName="gender">
                                    <mat-radio-button value="male">{{male_cap}}</mat-radio-button>
                                    <mat-radio-button class="mat-radio-button-createpatient" value="female">
                                        {{female_cap}}</mat-radio-button>
                                    <mat-radio-button class="mat-radio-button-createpatient" value="other">Others
                                    </mat-radio-button>
                                </mat-radio-group>
                                <app-field-error-display [displayError]="fed_service.isFieldValid(amForm,'gender')"
                                    errorMsg="Please select the gender.">
                                </app-field-error-display>
                            </div>
                            
                            <!-- <div class="form-group col-lg-2 ">
                                <label class="form-level-settings text-danger" *ngIf="this.domain === 'healthCare'">Enter
                                    {{customer_label | capitalizeFirst}}'s DOB or Age *</label>
                            </div> -->

                            <div class="col-lg-2">
                                <div class="form-group normalpicker">
                                    <label class="p-0 py-1 m-0 form-text-light"> Date of birth</label>
                                    <div class="pickerouter">
                                        <input class="form-control dtepicker" type="text" matInput (click)="picker.open()"
                                            [matDatepicker]="picker" formControlName="dob" id="dob" [max]="tday" [min]="minday"
                                            placeholder="DD/MM/YYYY" readonly>
                                        <mat-datepicker-toggle matSuffix [for]="picker"  style="background-color: #f6f6f6 !important"></mat-datepicker-toggle>
                                        <mat-datepicker #picker style="background-color: #f6f6f6 !important"></mat-datepicker>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group col-lg-3" style="display: flex">
                                
                                <div class="col-lg-12 no-padding">
                                    <label class="p-0 py-1 m-0 form-text-light">Age<span class="text-danger">*</span></label>
                                    <div class="input-group">
                                        <div class="input-group-prepend"></div>
                                        <mat-form-field style="width : 80px; margin-top: -20px; height: 34px !important;"
                                            appearance="none">
                                            <!-- <mat-label style="color: black">Age</mat-label> -->
                                            <mat-select formControlName="ageType" style="width : 100px;background-color: #f6f6f6;"
                                                (selectionChange)="changeType($event)" [(value)]="ageType">
                                                <mat-option value="year">Years</mat-option>
                                                <mat-option value="month">Months</mat-option>
                                            </mat-select>
                                        </mat-form-field>
                                        <input type="number" class="input1" id="age" min="0" max="100000"
                                            (keypress)="isNumeric($event)" (keyup)="isvalid($event)" formControlName="age"
                                            autocomplete="off" style="margin-top: -1px" />
                                        <app-field-error-display [displayError]="fed_service.isFieldValid(amForm,'dob')"
                                            errorMsg="Please select the date of birth.">
                                        </app-field-error-display>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        
                        
                        <div class="form-group row">
                            <div class="col-lg-8">
                                <label class="p-0 pt-1 m-0 form-text-light">Address</label>
                                <div class="input-group">
                                    <div class="input-group-prepend"></div>
                                    <textarea type="text" class="form-control" id="address" placeholder="Enter your address"
                                        formControlName="address"></textarea>
                                </div>
                            </div>
    
                        </div>
                    </div>
                    <div class="card-body" *ngIf="loaded">
                        <app-questionnaire [questionnaireList]="questionnaireList" [source]="qnrSource"
                            (returnAnswers)="getQuestionAnswers($event)" [customerDetails]="customer">
                        </app-questionnaire>
                    </div>
                    <div class="card-footer" *ngIf="!showBookingQnr">
                        <div class="row">
                            <div class="col-lg-8">
                                <button (click)="onCancel()" type="reset" class="btn btn-secondary custom-btn-length text-center" style="box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2), 0 3px 10px 0 rgba(0, 0, 0, 0.19) !important;"
                                    [disabled]="disableButton">{{cancel_btn}}</button>&nbsp;
                                <button type="submit" [disabled]="!amForm.valid || disableButton"
                                    class="btn btn-primary mr-2 custom-btn-length text-center" style="box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2), 0 3px 10px 0 rgba(0, 0, 0, 0.19) !important;" >{{save_btn}}</button>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer" *ngIf="showBookingQnr">
                        <div class="row">
                            <div class="col-lg-12">
                                <button type="button" (click)="validateQnr()"
                                    class="btn btn-primary mr-2 custom-btn-length text-center">{{save_btn}}</button>
                            </div>
                        </div>
                    </div>
                </form>
                <!--end::Form-->
            </div>
        </div>
        <div class="clearfix"></div>
    </section>
</div>