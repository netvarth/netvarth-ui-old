<section class="card">
  <div class="title-gb no-padding">
    <div class="dash-head">
      <div> <i class="fa fa-arrow-left colorHeaderIcon" aria-hidden="true" (click)="goBack()"></i></div>
      <div class="colorHeaderIcon" *ngIf="headerName">{{headerName |capitalizeFirst}}</div>
    </div>
  </div>
</section>
<section>
  <div class="row mb-2" *ngIf="user.userType!=2">

    <div class="card remarks-card marginClass px-5">
      <div class="my-2">
        <div class="font-weight-bold" *ngIf="loanData && loanData.spInternalStatus">
          <span class="text-capitalize">Status : {{loanData.spInternalStatus}} Loan</span>
        </div>
        <div *ngIf="status=='rejected'" class="text-red mt-2">
          <span>Sorry your loan was rejected because of your credit score</span>
        </div>
      </div>

    </div>
  </div>
  <div class="row mt-2">
    <div class="col-md-5">
      <div class="card">

        <div *ngIf="status=='redirected' && user.userType!=2" class="text-warning mt-2 text-right">
          <div class="btn btn-action" (click)="takeAction()">Take Actions</div>
        </div>
        <div class="text-center mt-2"
          *ngIf="loanData && loanData.consumerPhoto && loanData.consumerPhoto[0] && loanData.consumerPhoto[0].s3path">
          <img [src]="loanData.consumerPhoto[0].s3path" width="100" height="100">
        </div>
        <div class="text-center my-2">
          <span class="loan-name"
            *ngIf="loanData && loanData.customer && loanData.customer.firstName">{{loanData.customer.firstName}}
            {{loanData.customer.lastName}}</span>
        </div>
        <div class="text-center">
          <span class="loan-tag">Customer</span>
        </div><br><br>
        <div class="text-left">
          <h6 class="font-weight-bold">Personal Details</h6>
          <hr>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="bggrey my-2">
              <div class="container-fluid">
                <div>
                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Phone Number</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div>
                      <span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.customer && loanData.customer.phoneNo">{{loanData.customer.phoneNo}}</span>
                    </div>
                  </div>
                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Email</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.customer && loanData.customer.email">{{loanData.customer.email}}</span>
                    </div>
                  </div>
                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Permanent Address 1</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentAddress1">{{loanData.loanApplicationKycList[0].permanentAddress1}}</span>
                    </div>
                  </div>
                  <!-- <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Permanent Address 2</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentAddress2">{{loanData.loanApplicationKycList[0].permanentAddress2}}</span>
                    </div>
                  </div> -->
                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Permanent Address City</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentCity">{{loanData.loanApplicationKycList[0].permanentCity}}</span>
                    </div>
                  </div>
                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Permanent Address State</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentState">{{loanData.loanApplicationKycList[0].permanentState}}</span>
                    </div>
                  </div>

                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Permanent Address Pincode</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentPin">{{loanData.loanApplicationKycList[0].permanentPin}}</span>
                    </div>
                  </div>


                  <div class="row text-left my-2"
                    *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentAddress1">
                    <div class="col-md-5 details-title">
                      Current Address 1</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span
                        class="col-md-6 details-sub-title no-padding">{{loanData.loanApplicationKycList[0].currentAddress1}}</span>
                    </div>
                  </div>
                  <div class="row text-left my-2"
                    *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentAddress2">
                    <div class="col-md-5 details-title">Current Address 2</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span
                        class="col-md-6 details-sub-title no-padding">{{loanData.loanApplicationKycList[0].currentAddress2}}</span>
                    </div>
                  </div>
                  <div class="row text-left my-2"
                    *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentCity">
                    <div class="col-md-5 details-title">Current Address City</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span
                        class="col-md-6 details-sub-title no-padding">{{loanData.loanApplicationKycList[0].currentCity}}</span>
                    </div>
                  </div>
                  <div class="row text-left my-2"
                    *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentState">
                    <div class="col-md-5 details-title">Current Address State</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span
                        class="col-md-6 details-sub-title no-padding">{{loanData.loanApplicationKycList[0].currentState}}</span>
                    </div>
                  </div>

                  <div class="row text-left my-2"
                    *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentPin">
                    <div class="col-md-5 details-title">Current Address Pincode</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span
                        class="col-md-6 details-sub-title no-padding">{{loanData.loanApplicationKycList[0].currentPin}}</span>
                    </div>
                  </div>

                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Martial Status</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].maritalStatus">{{loanData.loanApplicationKycList[0].maritalStatus}}</span>
                    </div>
                  </div>

                  <div class="row text-left my-2">
                    <div class="col-md-5 details-title">Employee Type</div>
                    <div class="col-md-1 details-title no-padding">:</div>
                    <div><span class="col-md-6 details-sub-title no-padding"
                        *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].employmentStatus">{{loanData.loanApplicationKycList[0].employmentStatus}}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-7">
      <div class="card mb-2" *ngIf="user.userType=='2'">
        <div class="font-weight-bold">Actions</div>
        <div class="row mt-2">
          <div class="col-md-6">
            <div class="card border">
              <div class="d-flex">
                <span><i class="fa fa-comments-o actions-1" aria-hidden="true"></i></span>&nbsp;&nbsp;
                <div class="text-left details-sub-title">Communicate With Dealer</div>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="card border">
              <div class="d-flex">
                <span><i class="fa fa-info actions-2" aria-hidden="true"></i></span>&nbsp;&nbsp;
                <div class="text-left details-sub-title">Need More Information</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="font-weight-bold">KYC Details</div>
        <div class="row mt-2">
          <div class="col-md-6">
            <div
              *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].aadhaar">
              <div>
                <div class="text-left details-title">Aadhar Number&nbsp;<img
                    src="../../../../assets/images/cdl/check.png" width="20"
                    *ngIf="loanData.loanApplicationKycList[0].isAadhaarVerified">
                  <img src="../../../../assets/images/cdl/cancel.png" width="20"
                    *ngIf="!loanData.loanApplicationKycList[0].isAadhaarVerified">
                </div>
                <div class="text-left details-sub-title">{{loanData.loanApplicationKycList[0].aadhaar}}</div>
              </div>
              <div class="mt-2"
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].aadhaarAttachments&& loanData.loanApplicationKycList[0].aadhaarAttachments[0]">
                <a [href]="loanData.loanApplicationKycList[0].aadhaarAttachments[0].s3path" target="_blank"
                  class="btn btn-primary">
                  <span>View Aadharcard</span>
                </a>
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div
              *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].pan">
              <div>
                <div class="text-left details-title">Pan Number&nbsp;<img src="../../../../assets/images/cdl/check.png"
                    width="20" *ngIf="loanData.loanApplicationKycList[0].isPanVerified"><img
                    src="../../../../assets/images/cdl/cancel.png" width="20"
                    *ngIf="!loanData.loanApplicationKycList[0].isPanVerified"></div>
                <div class="text-left details-sub-title">{{loanData.loanApplicationKycList[0].pan}}</div>
              </div>
              <div class="mt-2"
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].panAttachments && loanData.loanApplicationKycList[0].panAttachments[0]">
                <a [href]="loanData.loanApplicationKycList[0].panAttachments[0].s3path" target="_blank"
                  class="btn btn-primary">
                  <span>View Pancard</span>
                </a>
              </div>
            </div>
          </div>
        </div>

        <br>

      </div>
      <div class="card marginClass">
        <div class="font-weight-bold">Bank Details&nbsp;<img src="../../../../assets/images/cdl/check.png" width="20"
            *ngIf="bankData && bankData.bankAccountVerified"><img src="../../../../assets/images/cdl/cancel.png"
            width="20" *ngIf="bankData && !bankData.bankAccountVerified"></div>
        <div class="row mt-2">
          <div class="col-md-4" *ngIf="bankData && bankData.bankAccountNo">
            <div class="details-title">Account Number</div>
            <div class="details-sub-title">{{bankData.bankAccountNo}}</div>
          </div>
          <div class="col-md-4" *ngIf="bankData && bankData.bankName">
            <div class="details-title">Bank</div>
            <div class="details-sub-title">{{bankData.bankName}} Bank</div>
          </div>
          <div class="col-md-4" *ngIf="bankData && bankData.bankIfsc">
            <div class="details-title">IFSC Code</div>
            <div class="details-sub-title">{{bankData.bankIfsc}}</div>
          </div>
        </div>
        <div class="row mt-2"
          *ngIf="bankData && bankData.bankStatementAttachments && bankData.bankStatementAttachments[0]">
          <div class="col-md-4">
            <div class="details-title">Bank Statements</div>
          </div>
        </div>
        <div class="row mt-2"
          *ngIf="bankData && bankData.bankStatementAttachments && bankData.bankStatementAttachments[0]">
          <div class="col-md-4">
            <a [href]="bankData.bankStatementAttachments[0].s3path" target="_blank"
              class="btn btn-primary btn-primary-full">
              <span>View Statements</span>
            </a>
          </div>
        </div>
        <br>
      </div>


      <div class="card marginClass">
        <div class="font-weight-bold">Loan Details</div>
        <div class="row mt-2">
          <div class="col-md-4" *ngIf="loanData && loanData.category">
            <div class="details-title">Category</div>
            <div class="details-sub-title">{{loanData.category.name}}</div>
          </div>
          <div class="col-md-4" *ngIf="loanData && loanData.loanProduct">
            <div class="details-title">Product</div>
            <div class="details-sub-title">{{loanData.loanProduct.productName}}</div>
          </div>
          <div class="col-md-4" *ngIf="loanData && loanData.requestedAmount">
            <div class="details-title">Loan Required</div>
            <div class="details-sub-title">{{loanData.requestedAmount}}</div>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-4" *ngIf="loanData && loanData.emiPaidAmountMonthly">
            <div class="details-title">No Of EMI Paid Monthly</div>
            <div class="details-sub-title">{{loanData.emiPaidAmountMonthly}}</div>
          </div>
          <div class="col-md-4" *ngIf="loanData && loanData.downpaymentAmount">
            <div class="details-title">Down payment</div>
            <div class="details-sub-title">{{loanData.downpaymentAmount}}</div>
          </div>
          <div class="col-md-4" *ngIf="loanData && loanData.invoiceAmount">
            <div class="details-title">Total Payment</div>
            <div class="details-sub-title">{{loanData.invoiceAmount}}</div>
          </div>
        </div>
        <br *ngIf="user.userType!='2'">
      </div>



      <div class="card marginClass min-height">
        <div *ngIf="status!='pending'">
          <div class="font-weight-bold">Remarks</div>
          <span class="details-title" *ngIf="loanData && loanData.remarks">{{loanData.remarks}}</span>
        </div>
      </div>


    </div>
  </div>
</section>
<br>
<section class="card row" *ngIf="user.userType==2">
  <div class="col-md-3">
    <div class="customcard">
      <div class="d-flex">
        <div><i class="fa fa-tachometer" aria-hidden="true"></i></div>&nbsp;&nbsp;
        <div>
          <div class="customerScoreLabel">CIBIL Score</div>
          <div class="customerScoreInfoLabel">{{cibilScore}}</div>
        </div>
      </div>
      <div class="text-right">
        <div class="btn btn-primary py-1">View Report</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="customcard">
      <div class="d-flex">
        <div><i class="fa fa-tachometer" aria-hidden="true"></i></div>&nbsp;&nbsp;
        <div>
          <div class="customerScoreLabel">Perfios Score</div>
          <div class="customerScoreInfoLabel">{{perfiosScore}}</div>
        </div>
      </div>
      <div class="text-right">
        <div class="btn btn-primary py-1">View Report</div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="customcard">
      <div class="d-flex">
        <div><i class="fa fa-tachometer" aria-hidden="true"></i></div>&nbsp;&nbsp;
        <div>
          <div class="customerScoreLabel">MAFIL Score</div>
          <div class="customerScoreInfoLabel">{{mafilScore}}</div>
        </div>
      </div>
      <div class="text-right">
        <div class="btn btn-primary py-1">View Report</div>
      </div>
    </div>
  </div>

  <div class="col-md-3">
    <div class="customcard">
      <div class="d-flex">
        <div><i class="fa fa-tachometer" aria-hidden="true"></i></div>&nbsp;&nbsp;
        <div>
          <div class="customerScoreLabel">Total Score</div>
          <div class="customerScoreInfoLabel">{{totalScore}}</div>
        </div>
      </div>
      <div class="text-right">
        <div class="btn btn-primary py-1">View Report</div>
      </div>
    </div>
  </div>


</section>

<section class="d-flex justify-content-center m-2 my-4"
  *ngIf="user.userType==2 && loanData &&  (loanData.spInternalStatus == 'consumerAccepted' || loanData.spInternalStatus == 'ApprovalRequired')">
  <div class="btn-sanctioned mr-2 pointer-cursor" (click)="sanctionLoan()">
    Sanction Loan
  </div>

  <div class="btn-redirect mr-2 pointer-cursor" (click)="redirectLoan()">
    Redirect Loan
  </div>

  <div class="btn-reject pointer-cursor" (click)="rejectLoan()">
    Reject
  </div>
</section>
