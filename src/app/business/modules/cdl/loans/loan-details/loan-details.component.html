<section class="card">
  <div class="title-gb no-padding">
    <div class="dash-head">
      <div> <i class="fa fa-arrow-left colorHeaderIcon" aria-hidden="true" (click)="goBack()"></i></div>
      <div class="colorHeaderIcon" *ngIf="headerName">{{headerName |capitalizeFirst}}</div>
    </div>
  </div>
</section>
<section>
  <div class="row mb-2">
    <div class="card remarks-card marginClass px-5">
      <div class="container-fluid my-2">
        <div *ngIf="statusIndex && loanData && loanData.applicationStatus !='Rejected'" class="desktop-only">
          <p-timeline [value]="loanStatus" layout="horizontal" [responsive]="true" styleClass="customized-timeline">
            <ng-template pTemplate="marker" let-event let-i="rowIndex">
              <span class="custom-marker p-shadow-2" *ngIf="event.index > statusIndex"
                [style.backgroundColor]="event.color">
                <img width="30" height="30" src="./assets/images/cdl/stopwatch.png">
              </span>
              <span class="custom-marker p-shadow-2" *ngIf="event.index <= statusIndex"
                [style.backgroundColor]="event.color">
                <img width="30" height="30" src="./assets/images/cdl/check.png">
              </span>
            </ng-template>
            <ng-template pTemplate="content" class="text-center timelinetext" let-event>{{event.displayName}}
            </ng-template>
          </p-timeline>
        </div>

        <div class="container mobile-only"
          *ngIf="loanData && loanData.spInternalStatusDisplyName  && loanData.applicationStatus !='Rejected'">
          <span><b>Status : </b>{{loanData.spInternalStatusDisplyName}}</span>
        </div>

        <div *ngIf="loanData && loanData.applicationStatus =='Rejected'" class="text-red mt-2">
          <span><b>Sorry,your loan was rejected</b></span>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="loanData && loanData.generalNotes && loanData.generalNotes.length>0">
    <div class="card marginClass">
      <div class="container-fluid my-2">
        <div>
          <div class="font-weight-bold">
            Remarks
          </div>
          <div class="notes" *ngFor="let notes of loanData.generalNotes">
            <span class="notes">{{notes.note}}</span><span class="notes-suffix"> (Added at {{notes.description}}
              Status) </span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row col-md-12">
    <div class="col-md-5 no-padding-small mt-2">
      <div class="card">
        <div class="d-flex">
          <div class="text-center mt-2 mr-4"
            *ngIf="loanData && loanData.consumerPhoto && loanData.consumerPhoto[0] && loanData.consumerPhoto[0].s3path">
            <a [href]="loanData.consumerPhoto[0].s3path" target="_blank" class="pointer-cursor">
              <img [src]="loanData.consumerPhoto[0].s3path" width="100" height="100" class="rounded">
            </a>
          </div>
          <div class="mt-2">
            <div>
              <span class="loan-name" *ngIf="loanData && loanData.customer && loanData.customer">
                <span *ngIf="loanData.customer.firstName">{{loanData.customer.firstName}}</span>&nbsp;
                <span *ngIf="loanData.customer.lastName">{{loanData.customer.lastName}}</span>
              </span>
            </div>
            <div class="my-2">
              <span class="loan-tag">Customer</span>
            </div>
            <div>
              <div *ngIf="loanData && loanData.referenceNo" class="font-medium">
                <span>Loan Id : <span class="font-weight-bold">{{loanData.referenceNo}}</span></span>
              </div>
              <!-- <div *ngIf="mafilScore" class="font-medium">
                <span>Mafil Score : <span class="font-weight-bold">{{mafilScore}}</span></span>
              </div> -->
            </div>
          </div>
        </div>
        <br>
        <div class="text-left">
          <span class="font-weight-bold text-primary">Personal Details</span>
          <hr class="mt-2">
        </div>
        <div>
          <div class="table-responsive">
            <table class="table table-borderless">
              <tbody>
                <tr style="width: 100%;" *ngIf="loanData && loanData.customer && loanData.customer.phoneNo">
                  <td style="width: 50%;" class="details-title">Phone Number</td>
                  <th style=" width: 50%;" class="details-sub-title">{{loanData.customer.phoneNo}}</th>
                </tr>

                <tr style="width: 100%;" *ngIf="loanData && loanData.customer && loanData.customer.email">
                  <td style="width: 50%;" class="details-title">Email</td>
                  <th style=" width: 50%;" class="details-sub-title">{{loanData.customer.email}}</th>
                </tr>

                <tr style="width: 100%;" *ngIf="loanData && loanData.customer && loanData.customer.gender">
                  <td style="width: 50%;" class="details-title">Gender</td>
                  <th style=" width: 50%;" class="details-sub-title">{{loanData.customer.gender}}</th>
                </tr>

                <tr style="width: 100%;" *ngIf="loanData && loanData.customer && loanData.customer.dob">
                  <td style="width: 50%;" class="details-title">Date of Birth</td>
                  <th style=" width: 50%;" class="details-sub-title">{{loanData.customer.dob}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentAddress1">
                  <td style="width: 50%;" class="details-title">Permanent Address 1</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].permanentAddress1}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentAddress2">
                  <td style="width: 50%;" class="details-title">Permanent Address 2</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].permanentAddress2}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentCity">
                  <td style="width: 50%;" class="details-title">Permanent Address City</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].permanentCity}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentState">
                  <td style="width: 50%;" class="details-title">Permanent Address State</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].permanentState}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].permanentPin">
                  <td style="width: 50%;" class="details-title">Permanent Address Pincode</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].permanentPin}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentAddress1">
                  <td style="width: 50%;" class="details-title">Current Address 1</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].currentAddress1}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentAddress2">
                  <td style="width: 50%;" class="details-title">Current Address 2</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].currentAddress2}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentCity">
                  <td style="width: 50%;" class="details-title">Current Address City</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].currentCity}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentState">
                  <td style="width: 50%;" class="details-title">Current Address State</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].currentState}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentPin">
                  <td style="width: 50%;" class="details-title">Current Address Pincode</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].currentPin}}</th>
                </tr>

                <tr style="width: 100%;" *ngIf="loanData && loanData.partner && loanData.partner.id">
                  <td style="width: 50%;" class="details-title">Dealer Id</td>
                  <th style=" width: 50%;" class="details-sub-title">{{loanData.partner.id}}</th>
                </tr>

                <tr style="width: 100%;" *ngIf="loanData && loanData.partner && loanData.partner.partnerName">
                  <td style="width: 50%;" class="details-title">Dealer Name</td>
                  <th style="width: 50%;" class="details-sub-title">{{loanData.partner.partnerName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].customerEducationName">
                  <td style="width: 50%;" class="details-title">Customer Education</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].customerEducationName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].customerEmployementName">
                  <td style="width: 50%;" class="details-title">Customer Employment</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].customerEmployementName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].customerOccupation">
                  <td style="width: 50%;" class="details-title">Customer Occupation</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].customerOccupation}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].monthlyIncome">
                  <td style="width: 50%;" class="details-title">Monthly Income</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].monthlyIncome}}</th>
                </tr>

                <tr style="width: 100%;" *ngIf="loanData && loanData.emiPaidAmountMonthly">
                  <td style="width: 50%;" class="details-title">No Of EMI Paid Monthly</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.emiPaidAmountMonthly}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].salaryRoutingName">
                  <td style="width: 50%;" class="details-title">Salary Routing</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].salaryRoutingName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].familyDependantsName">
                  <td style="width: 50%;" class="details-title">Family Dependants</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].familyDependantsName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].existingCustomerName">
                  <td style="width: 50%;" class="details-title">Existing Customer</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].existingCustomerName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].earningMembersName">
                  <td style="width: 50%;" class="details-title">Earning Members</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].earningMembersName}}</th>
                </tr>


                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].noOfYearsAtPresentAddressName">
                  <td style="width: 50%;" class="details-title">No of Years at Present Address</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].noOfYearsAtPresentAddressName}}</th>
                </tr>


                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].currentResidenceOwnershipStatusName">
                  <td style="width: 50%;" class="details-title">Current Residence Ownership Status</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].currentResidenceOwnershipStatusName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].ownedMovableAssetsName">
                  <td style="width: 50%;" class="details-title">Owned Movable Assets</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].ownedMovableAssetsName}}</th>
                </tr>

                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].vehicleNo">
                  <td style="width: 50%;" class="details-title">Vehicle No</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].vehicleNo}}</th>
                </tr>


                <tr style="width: 100%;"
                  *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].goodsFinancedName">
                  <td style="width: 50%;" class="details-title">Goods Financed</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.loanApplicationKycList[0].goodsFinancedName}}</th>
                </tr>



                <tr style="width: 100%;" *ngIf="loanData">
                  <td style="width: 50%;" class="details-title">Mafil Employee</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.employee?'Yes':'No'}}</th>
                </tr>

                <tr style="width: 100%;" *ngIf="loanData && loanData.employeeCode">
                  <td style="width: 50%;" class="details-title">Mafil Employee</td>
                  <th style=" width: 50%;" class="details-sub-title">
                    {{loanData.employeeCode}}</th>
                </tr>

              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div class="card mt-2" *ngIf="loanData && loanData.loanApplicationKycList[1]">
        <div class="text-left">
          <span class="font-weight-bold text-primary">Co-Applicant Details</span>
          <hr class="mt-2">
        </div>
        <div class="table-responsive">
          <div class="text-center mt-2 mr-4"
            *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[1] && loanData.loanApplicationKycList[1].customerPhoto && loanData.loanApplicationKycList[1].customerPhoto[0] && loanData.loanApplicationKycList[1].customerPhoto[0].s3path">
            <a [href]="loanData.loanApplicationKycList[1].customerPhoto[0].s3path" target="_blank"
              class="pointer-cursor">
              <img [src]="loanData.loanApplicationKycList[1].customerPhoto[0].s3path" width="100" height="100"
                class="rounded">
            </a>
          </div><br>
          <table class="table table-borderless">
            <tbody>
              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].coApplicantType">
                <td style="width: 50%;" class="details-title">Relation With Applicant</td>
                <th style=" width: 50%;" class="details-sub-title">
                  {{loanData.loanApplicationKycList[1].coApplicantType}}</th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].customerFirstName">
                <td style="width: 50%;" class="details-title">Name</td>
                <th style=" width: 50%;" class="details-sub-title">
                  <span *ngIf="loanData.loanApplicationKycList[1].customerFirstName">
                    {{loanData.loanApplicationKycList[1].customerFirstName}}
                  </span>

                  <span *ngIf="loanData.loanApplicationKycList[1].customerLastName">
                    {{loanData.loanApplicationKycList[1].customerLastName}}
                  </span>
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].customerPhone">
                <td style="width: 50%;" class="details-title">Phone Number</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].customerPhone}}
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].customerEmail">
                <td style="width: 50%;" class="details-title">Email</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].customerEmail}}
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].gender">
                <td style="width: 50%;" class="details-title">Gender</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].gender}}</th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].dob">
                <td style="width: 50%;" class="details-title">Date of Birth</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].dob}}</th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].permanentAddress1">
                <td style="width: 50%;" class="details-title">Address</td>
                <th style=" width: 50%;" class="details-sub-title">
                  <span
                    *ngIf="loanData.loanApplicationKycList[1].permanentAddress1">{{loanData.loanApplicationKycList[1].permanentAddress1}},</span>
                  <span
                    *ngIf="loanData.loanApplicationKycList[1].permanentAddress2">{{loanData.loanApplicationKycList[1].permanentAddress2}},</span>
                  <span
                    *ngIf="loanData.loanApplicationKycList[1].permanentCity">{{loanData.loanApplicationKycList[1].permanentCity}},</span>
                  <span
                    *ngIf="loanData.loanApplicationKycList[1].permanentState">{{loanData.loanApplicationKycList[1].permanentState}},</span>
                  <span
                    *ngIf="loanData.loanApplicationKycList[1].permanentPin">{{loanData.loanApplicationKycList[1].permanentPin}}</span>
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].aadhaar">
                <td style="width: 50%;" class="details-title">Aadhaar</td>
                <th style=" width: 50%;" class="details-sub-title">
                  {{loanData.loanApplicationKycList[1].aadhaar}} &nbsp;
                  <span
                    *ngIf="loanData.loanApplicationKycList[1].aadhaarAttachments && loanData.loanApplicationKycList[1].aadhaarAttachments[0] && loanData.loanApplicationKycList[1].aadhaarAttachments[0].s3path">
                    <b class="card p-1 pointer-cursor">
                      <a [href]="loanData.loanApplicationKycList[1].aadhaarAttachments[0].s3path" class="text-primary"
                        target="_blank">View</a>
                    </b>
                  </span>
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].pan">
                <td style="width: 50%;" class="details-title">Pan</td>
                <th style=" width: 50%;" class="details-sub-title">
                  {{loanData.loanApplicationKycList[1].pan}} &nbsp;
                  <span
                    *ngIf="loanData.loanApplicationKycList[1].panAttachments && loanData.loanApplicationKycList[1].panAttachments[0] && loanData.loanApplicationKycList[1].panAttachments[0].s3path">
                    <b class="card p-1 pointer-cursor">
                      <a [href]="loanData.loanApplicationKycList[1].panAttachments[0].s3path" class="text-primary"
                        target="_blank">View</a>
                    </b>
                  </span>
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].bankName">
                <td style="width: 50%;" class="details-title">Bank Name</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].bankName}}
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].bankAccountNo">
                <td style="width: 50%;" class="details-title">Bank AccountNo</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].bankAccountNo}}
                </th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].bankIfsc">
                <td style="width: 50%;" class="details-title">Bank IFSC</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].bankIfsc}}</th>
              </tr>

              <tr style="width: 100%;" *ngIf="loanData.loanApplicationKycList[1].bankBranchName">
                <td style="width: 50%;" class="details-title">Bank Branch Name</td>
                <th style=" width: 50%;" class="details-sub-title">{{loanData.loanApplicationKycList[1].bankBranchName}}
                </th>
              </tr>

            </tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col-md-7 no-padding mt-2">
      <div class="card">
        <div class="font-weight-bold mt-4">Loan Details</div>
        <section class="row col-md-12 no-padding" *ngIf="capabilities && capabilities.canViewKycReport">
          <div class="col-lg-6 col-md-6 col-xs-12 col-sm-12 mt-2">
            <div class="card">
              <div class="d-flex">
                <div>
                  <img src="../../../../assets/images/cdl/equifax_score.png" width="100">
                </div>&nbsp;&nbsp;
                <div>
                  <div class="customerScoreLabel">Equifax Score</div>
                  <div class="customerScoreInfoLabel" *ngIf="showEquifaxScore">{{equifaxScore}}</div>
                  <div class="btn btn-primary mt-4" (click)="viewEquifaxScore()" *ngIf="!showEquifaxScore">View Score
                  </div>
                  <div class="btn btn-primary" (click)="viewReport('equifax',equifaxScoreData)"
                    *ngIf="showEquifaxScore">View Report</div>
                </div>
              </div>
              <!-- <div class="text-right">
                <div class="btn btn-primary py-1">View Report</div>
              </div> -->
            </div>
          </div>
          <div class="col-lg-6 col-md-6 col-xs-12 col-sm-12 mt-2">
            <div class="card">
              <div class="d-flex">
                <div>
                  <img src="../../../../assets/images/cdl/perfios_score.png" width="100">
                </div>&nbsp;&nbsp;
                <div>
                  <div class="customerScoreLabel">Perfios Banking Habits</div>
                  <div class="customerScoreInfoLabel" *ngIf="perfiosData && perfiosData.bankingHabits">
                    {{getStringWithSpaces(perfiosData.bankingHabits)}}</div>
                  <div class="btn btn-primary" (click)="viewReport('perfios',perfiosData)">View Report</div>
                </div>
              </div>
              <!-- <div class="text-right">
                <div class="btn btn-primary py-1">View Report</div>
              </div> -->
            </div>
          </div>
          <div class="clearfix"></div>
          <div class="col-lg-6 col-md-6 col-xs-12 col-sm-12 mt-2">
            <div class="card">
              <div class="d-flex">
                <div>
                  <img src="../../../../assets/images/cdl/mafil_score.png" width="100">
                </div>&nbsp;&nbsp;
                <div>
                  <div class="customerScoreLabel">MAFIL Score</div>
                  <div class="customerScoreInfoLabel" *ngIf="mafilScore">{{mafilScore}}</div>
                  <div class="btn btn-primary" (click)="viewReport('mafil',mafilScoreData)">View Report</div>
                </div>
              </div>
              <!-- <div class="text-right">
                <div class="btn btn-primary py-1">View Report</div>
              </div> -->
            </div>
          </div>

          <div class="col-lg-6 col-md-6 col-xs-12 col-sm-12 mt-2">
            <div class="card">
              <div class="d-flex">
                <div>
                  <img src="../../../../assets/images/cdl/total_score.png" width="100">
                </div>&nbsp;&nbsp;
                <div>
                  <div class="customerScoreLabel">Mafil Score (%)</div>
                  <div class="customerScoreInfoLabel" *ngIf="mafilScorePercentange">{{mafilScorePercentange}} %</div>
                  <!-- <div class="btn btn-primary">View Report</div> -->
                </div>
              </div>
              <!-- <div class="text-right">
                <div class="btn btn-primary py-1">View Report</div>
              </div> -->
            </div>
          </div>
        </section>
        <div class="clearfix"></div><br>
        <div class="card">
          <div class="row mt-2">
            <div class="col-md-12 no-padding-small">
              <div
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].aadhaar">
                <div class="text-left details-title">Aadhar Number&nbsp;
                  <img src="../../../../assets/images/cdl/check.png" width="20"
                    *ngIf="loanData.loanApplicationKycList[0].isAadhaarVerified">
                  <img src="../../../../assets/images/cdl/cancel.png" width="20"
                    *ngIf="!loanData.loanApplicationKycList[0].isAadhaarVerified">
                </div>
                <div class="d-flex justify-content-between">
                  <div class="d-flex align-items-center">
                    <div class="text-left details-sub-title">{{loanData.loanApplicationKycList[0].aadhaar}}</div>
                  </div>
                  <div *ngIf="loanData.loanApplicationKycList[0].aadhaarAttachments">
                    <div class=" mt-2"
                      *ngFor="let attachment of loanData.loanApplicationKycList[0].aadhaarAttachments;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.loanApplicationKycList[0].aadhaarAttachments.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <br>
            <div class="col-md-12 no-padding-small mt-3">
              <div
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].pan">
                <div class="text-left details-title">Pan Number&nbsp;
                  <img src="../../../../assets/images/cdl/check.png" width="20"
                    *ngIf="loanData.loanApplicationKycList[0].isPanVerified">
                  <img src="../../../../assets/images/cdl/cancel.png" width="20"
                    *ngIf="!loanData.loanApplicationKycList[0].isPanVerified">
                </div>
                <div class="d-flex justify-content-between">
                  <div class="d-flex align-items-center">
                    <div class="text-left details-sub-title">{{loanData.loanApplicationKycList[0].pan}}</div>
                  </div>
                  <div *ngIf="loanData.loanApplicationKycList[0].panAttachments">
                    <div class=" mt-2"
                      *ngFor="let attachment of loanData.loanApplicationKycList[0].panAttachments;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.loanApplicationKycList[0].panAttachments.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-12 no-padding-small mt-3">
              <div
                *ngIf="loanData && loanData.partnerAcceptanceAttachments && loanData.partnerAcceptanceAttachments.length>0">
                <div class="text-left details-title">Uploaded Invoice&nbsp;
                </div>
                <div class="d-flex justify-content-between">
                  <div *ngIf="loanData.partnerAcceptanceAttachments">
                    <div class=" mt-2" *ngFor="let attachment of loanData.partnerAcceptanceAttachments;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.partnerAcceptanceAttachments.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>


        <div class="card marginClass">
          <div class="font-weight-bold">Bank Details&nbsp;<img src="../../../../assets/images/cdl/check.png" width="20"
              *ngIf="loanData && loanData.isBankVerified"><img src="../../../../assets/images/cdl/cancel.png" width="20"
              *ngIf="loanData && !loanData.isBankVerified"></div>
          <div class="row">
            <div class="col-md-4 mt-2 no-padding-small" *ngIf="bankData && bankData.bankAccountNo">
              <div class="details-title">Account Number</div>
              <div class="details-sub-title">{{bankData.bankAccountNo}}</div>
            </div>
            <div class="col-md-4 mt-2 no-padding-small" *ngIf="bankData && bankData.bankName">
              <div class="details-title">Bank</div>
              <div class="details-sub-title">{{bankData.bankName}} Bank</div>
            </div>
            <div class="col-md-4 mt-2 no-padding-small" *ngIf="bankData && bankData.bankIfsc">
              <div class="details-title">IFSC Code</div>
              <div class="details-sub-title">{{bankData.bankIfsc}}</div>
            </div>
          </div>
          <div class="row mt-2"
            *ngIf="bankData && bankData.bankStatementAttachments && bankData.bankStatementAttachments[0]">
            <div class="col-md-4 no-padding-small">
              <div class="details-title">Bank Statements</div>
            </div>
          </div>

          <div class="row mt-2"
            *ngIf="bankData && bankData.bankStatementAttachments && bankData.bankStatementAttachments[0]">
            <div class="col-md-12 no-padding-small font-weight-bold my-2">
              <span *ngIf="loanData && loanData.isAccountAggregated">Statement Aggregated by Account Aggreator</span>
              <span *ngIf="loanData && !loanData.isAccountAggregated">Statement Uploaded Manually</span>
            </div>
            <div class="col-md-4 no-padding-small">
              <a [href]="bankData.bankStatementAttachments[0].s3path" target="_blank" class="btn btn-primary">
                <span>View Statements</span>
              </a>
            </div>
          </div>

          <!-- <div class="row mt-2"
            *ngIf="bankData && bankData.bankStatementAttachments && bankData.bankStatementAttachments[0] && capabilities && capabilities.canViewKycReport">
            <div class="col-md-4 no-padding-small">
              <a class="btn btn-primary">
                <span>View Statement Reports</span>
              </a>
            </div>
          </div> -->

          <div class="row mt-4"
            *ngIf="accountaggregatingStatusShowing && !(bankData && bankData.bankStatementAttachments && bankData.bankStatementAttachments[0])">
            <div class="col-md-12 no-padding-small">
              <div>
                <div class="btn btn-warning" [class.approved]="accountaggregatingStatus == 'Approved'">Statement
                  Aggregation
                  {{accountaggregatingStatus}}
                </div>
              </div>
            </div>
            <div class="col-md-12 no-padding-small mt-3" *ngIf="accountaggregatingStatus == 'Approved'">
              <div>
                <div class="btn btn-primary" (click)="refreshAccountAggregator()">Refresh
                </div>
              </div>
            </div>
          </div>

          <br>
        </div>


        <div class="card marginClass">
          <div class="row">
            <div class="col-md-4 no-padding-small mt-2" *ngIf="loanData && loanData.category">
              <div class="details-title">Category</div>
              <div class="details-sub-title">{{loanData.category.name}}</div>
            </div>
            <div class="col-md-4 no-padding-small mt-2" *ngIf="loanData && loanData.loanProducts">
              <div class="details-title">Products</div>
              <span class="details-sub-title" *ngFor="let item of loanData.loanProducts">{{item.productName}},</span>
            </div>
            <div class="col-md-4 no-padding-small mt-2" *ngIf="loanData && loanData.requestedAmount">
              <div class="details-title">Loan Required</div>
              <div class="details-sub-title">{{loanData.requestedAmount}}</div>
            </div>
            <div class="col-md-4 no-padding-small mt-2" *ngIf="loanData && loanData.downpaymentAmount">
              <div class="details-title">Down payment</div>
              <div class="details-sub-title">{{loanData.downpaymentAmount}}</div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-4 no-padding-small mt-2" *ngIf="loanData && loanData.invoiceAmount">
              <div class="details-title">Total Bill Amount</div>
              <div class="details-sub-title">{{loanData.invoiceAmount}}</div>
            </div>
          </div>
          <br>
        </div>

        <div class="card marginClass">
          <div class="font-weight-bold">Nominee Details</div>
          <div class="row">
            <div class="col-md-4 no-padding-small mt-2"
              *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].nomineeName">
              <div class="details-title">Nominee Name</div>
              <div class="details-sub-title">{{loanData.loanApplicationKycList[0].nomineeName}}</div>
            </div>
            <div class="col-md-4 no-padding-small mt-2"
              *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].nomineeType">
              <div class="details-title">Nominee Relation</div>
              <div class="details-sub-title">{{loanData.loanApplicationKycList[0].nomineeType}}</div>
            </div>
            <div class="col-md-4 no-padding-small mt-2"
              *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].nomineePhone">
              <div class="details-title">Nominee Phone</div>
              <div class="details-sub-title">{{loanData.loanApplicationKycList[0].nomineePhone}}</div>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-md-4 no-padding-small mt-2"
              *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].nomineeDob">
              <div class="details-title">Nominee Date of Birth</div>
              <div class="details-sub-title">{{loanData.loanApplicationKycList[0].nomineeDob}}</div>
            </div>
            <div class="col-md-4 no-padding-small mt-2"
              *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].nomineeGender">
              <div class="details-title">Nominee Gender</div>
              <div class="details-sub-title">{{loanData.loanApplicationKycList[0].nomineeGender}}</div>
            </div>
          </div>
          <br>
        </div>


        <div class="card marginClass min-height">
          <div>
            <div class="font-weight-bold">Remarks</div>
            <span class="details-title" *ngIf="loanData && loanData.remarks">{{loanData.remarks}}</span>
            <span class="details-title" *ngIf="loanData && !loanData.remarks">No Remarks Added</span>
          </div>
        </div>


        <div class="card marginClass min-height">
          <div class="font-weight-bold">Files Uploaded in Credit Verification</div>
          <div class="row mt-2">
            <div class="col-md-12 no-padding-small">
              <div
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].postDatedCheque">
                <div class="text-left details-title">Post Dated Cheque&nbsp;
                </div>
                <div class="d-flex" *ngIf="loanData.loanApplicationKycList[0].postDatedCheque.length>0">
                  <div>
                    <div class="mt-2"
                      *ngFor="let attachment of loanData.loanApplicationKycList[0].postDatedCheque;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.loanApplicationKycList[0].postDatedCheque.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
                <div *ngIf="loanData.loanApplicationKycList[0].postDatedCheque.length ==0">
                  <div class="text-left details-title">No File Uploaded</div>
                </div>
              </div>

              <br>

              <div
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].securityPostDatedCheque">
                <div class="text-left details-title">Security Post Dated Cheque&nbsp;
                </div>
                <div class="d-flex" *ngIf="loanData.loanApplicationKycList[0].securityPostDatedCheque.length>0">
                  <div>
                    <div class="mt-2"
                      *ngFor="let attachment of loanData.loanApplicationKycList[0].securityPostDatedCheque;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.loanApplicationKycList[0].securityPostDatedCheque.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
                <div *ngIf="loanData.loanApplicationKycList[0].securityPostDatedCheque.length ==0">
                  <div class="text-left details-title">No File Uploaded</div>
                </div>
              </div>

              <br>

              <div
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].salarySlip">
                <div class="text-left details-title">Salary Slip&nbsp;
                </div>
                <div class="d-flex" *ngIf="loanData.loanApplicationKycList[0].salarySlip.length>0">
                  <div>
                    <div class="mt-2"
                      *ngFor="let attachment of loanData.loanApplicationKycList[0].salarySlip;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.loanApplicationKycList[0].salarySlip.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
                <div *ngIf="loanData.loanApplicationKycList[0].salarySlip.length ==0">
                  <div class="text-left details-title">No File Uploaded</div>
                </div>
              </div>

              <br>

              <div
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].taxReceipt">
                <div class="text-left details-title">Tax Receipt&nbsp;
                </div>
                <div class="d-flex" *ngIf="loanData.loanApplicationKycList[0].taxReceipt.length>0">
                  <div>
                    <div class="mt-2"
                      *ngFor="let attachment of loanData.loanApplicationKycList[0].taxReceipt;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.loanApplicationKycList[0].taxReceipt.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
                <div *ngIf="loanData.loanApplicationKycList[0].taxReceipt.length ==0">
                  <div class="text-left details-title">No File Uploaded</div>
                </div>
              </div>
              <br>


              <div
                *ngIf="loanData && loanData.loanApplicationKycList && loanData.loanApplicationKycList[0] && loanData.loanApplicationKycList[0].attachments">
                <div class="text-left details-title">Other Attachments&nbsp;
                </div>
                <div class="d-flex" *ngIf="loanData.loanApplicationKycList[0].attachments.length>0">
                  <div>
                    <div class="mt-2"
                      *ngFor="let attachment of loanData.loanApplicationKycList[0].attachments;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.loanApplicationKycList[0].attachments.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
                <div *ngIf="loanData.loanApplicationKycList[0].attachments.length ==0">
                  <div class="text-left details-title">No File Uploaded</div>
                </div>
              </div>


            </div>

            <div class="col-md-12 no-padding-small mt-3">
              <div
                *ngIf="loanData && loanData.partnerAcceptanceAttachments && loanData.partnerAcceptanceAttachments.length>0">
                <div class="text-left details-title">Uploaded Invoice&nbsp;
                </div>
                <div class="d-flex justify-content-between">
                  <div *ngIf="loanData.partnerAcceptanceAttachments">
                    <div class=" mt-2" *ngFor="let attachment of loanData.partnerAcceptanceAttachments;let i=index;">
                      <a [href]="attachment.s3path" target="_blank" class="btn btn-primary">
                        <span>View File <span
                            *ngIf="loanData.partnerAcceptanceAttachments.length > 1">{{i+1}}</span></span>
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div class="card marginClass min-height" *ngIf="capabilities && capabilities.canViewKycReport">
          <div class="font-weight-bold">Agreement & Letters</div>
          <div class="d-lg-flex">
            <div class="mt-2">
              <div class="btn btn-primary" (click)="viewDpnSpdcLetter()">View DPN & SPDC Letter</div>
            </div>
            <div class="mx-md-2 mt-2">
              <div class="btn btn-primary" (click)="viewconsumerAgreementLetter()">View Sanction Letter</div>
            </div>

          </div>
          <div class="d-lg-flex" *ngIf="loanData && loanData.isAcceptanceOtpUpdated">
            <div class="mt-2" *ngIf="digitalDocumenId && digitalDocumenId!=''">
              <div class="btn btn-primary" (click)="viewDigitalDocument()">View Agreement</div>
            </div>

            <div class="mt-2" *ngIf="!digitalDocumenId || (digitalDocumenId && digitalDocumenId=='')">
              <div class="btn btn-primary" (click)="sendDigitalAgreement()">Send Agreement</div>
            </div>

            <div class="mx-md-2 mt-2" *ngIf="digitalInsuranceId && digitalInsuranceId!=''">
              <div class="btn btn-primary" (click)="viewInsuranceDocument()">View Insurance Agreement</div>
            </div>

            <div class="mx-md-2 mt-2" *ngIf="!digitalInsuranceId || (digitalInsuranceId && digitalInsuranceId=='')">
              <div class="btn btn-primary" (click)="sendInsuranceDocument()">View Insurance Agreement</div>
            </div>
          </div>
          <div class="d-lg-flex">
            <div class="mt-2">
              <a (click)="showLoanDetailsDoc()" target="_blank" class="btn btn-primary">
                <span>View CAM report Doc</span>
              </a>
            </div>
            <div class="mx-md-2 mt-2" *ngIf="capabilities && capabilities.canViewKycReport">
              <a (click)="showKycDoc()" target="_blank" class="btn btn-primary">
                <span>View KYC Doc</span>
              </a>
            </div>
          </div>
        </div>
        <div class="clearfix"></div>

        <div class="card marginClass min-height"
          *ngIf="loanData && loanData.spInternalStatus && (loanData.spInternalStatus == 'Sanctioned' || loanData.spInternalStatus == 'OperationsVerified') && loanEmiDetailsData && loanEmiDetailsData.length>0">
          <div>
            <div class="font-weight-bold">EMI Details</div>
            <div class="table-responsive">
              <table class="table table-borderless">
                <tbody>
                  <tr style="width: 100%;">
                    <th class="details-sub-title">Number</th>
                    <th class="details-sub-title">EMI Due Date</th>
                    <th class="details-sub-title">EMI Amount</th>
                    <th class="details-sub-title">EMI Status</th>
                  </tr>

                  <tr style="width: 100%;" *ngFor="let emi of loanEmiDetailsData">
                    <td *ngIf="emi && emi.emiSequenceNo && !emi.isAdvancedEmi">{{emi.emiSequenceNo}}</td>
                    <td *ngIf="emi && emi.emiDueDate && !emi.isAdvancedEmi">{{emi.emiDueDate}}</td>
                    <td *ngIf="emi && emi.emiAmount && !emi.isAdvancedEmi">{{emi.emiAmount}}</td>
                    <td *ngIf="emi && emi.emiStatus && !emi.isAdvancedEmi">{{emi.emiStatus}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<br>
<div class="clearfix"></div>
<div>
  <section class="d-flex justify-content-center m-2 my-4"
    *ngIf="loanData && (loanData.spInternalStatus == 'ApprovalRequired' || loanData.spInternalStatus == 'ApprovalPending') && loanData.applicationStatus != 'Rejected' && capabilities && capabilities.canApproveLoan">
    <div class="btn-sanctioned mr-2 pointer-cursor" (click)="sanctionLoan()">
      Verify Loan
    </div>

    <div class="btn-redirect mr-2 pointer-cursor" (click)="redirectLoan()"
      *ngIf="capabilities && capabilities.canActionRequired && loanData && !loanData.isActionRequired">
      Redirect Loan
    </div>

    <div class="btn-redirect mr-2 pointer-cursor" (click)="completeLoan()"
      *ngIf="capabilities && capabilities.canActionRequired && loanData && loanData.isActionRequired">
      Complete Action
    </div>

    <div class="btn-reject pointer-cursor" (click)="rejectLoan()">
      Reject
    </div>
  </section>

  <section class="d-flex justify-content-center m-2 my-4"
    *ngIf="loanData && loanData.spInternalStatus && loanData.spInternalStatus == 'LoanRequest' && capabilities && capabilities.canApprovePartnerLoan">
    <div class="btn-sanctioned mr-2 pointer-cursor" (click)="approveLoan()">
      Approve Loan
    </div>

    <!-- <div class="btn-redirect mr-2 pointer-cursor" (click)="redirectLoan()">
      Redirect Loan
    </div> -->

    <div class="btn-reject pointer-cursor" (click)="rejectLoan()">
      Reject Loan
    </div>
  </section>


  <section class="d-flex justify-content-center m-2 my-4"
    *ngIf="loanData && loanData.spInternalStatus && loanData.spInternalStatus == 'SchemeConfirmed' && capabilities && capabilities.canLoanApplicationBranchVerification">
    <div class="btn-sanctioned mr-2 pointer-cursor" (click)="approveLoanByBranchManager()">
      Approve Loan
    </div>

    <!-- <div class="btn-redirect mr-2 pointer-cursor" (click)="redirectLoan()">
          Redirect Loan
        </div> -->

    <div class="btn-reject pointer-cursor" (click)="rejectLoan()">
      Reject Loan
    </div>
  </section>



  <section class="d-flex justify-content-center m-2 my-4"
    *ngIf="loanData && loanData.spInternalStatus && loanData.spInternalStatus == 'Sanctioned'  && capabilities && capabilities.canLoanApplicationOperationsVerification">
    <div class="btn-sanctioned mr-2 pointer-cursor" (click)="verifyLoanByOps()">
      Verify
    </div>

    <div class="btn-redirect mr-2 pointer-cursor" (click)="redirectLoanByOps()">
      Redirect Loan
    </div>
  </section>
</div>
