<section class="container">
    <app-breadcrumb [breadcrumbs]="breadcrumbs"></app-breadcrumb>
</section>
<section class="container ">
    <div class="content consumer-dash">
        <div class="card c-checkins">
            <h2><span [matTooltipClass]="tooltipcls" [matTooltip]="currentcheckinsTooltip">Active Check-Ins
                    <ng-container *ngIf="waitlists && waitlists.length>0">({{waitlists.length}})</ng-container></span>
            </h2>
            <div *ngIf="loadcomplete.waitlist && waitlists && waitlists.length == 0"
                class="col-md-12 col-xs-12 col-sm-12 mgn-up-20 nocheckins">
                <p>{{no_checkins_cap}}</p>
            </div>
            <div class="outer banner" *ngIf="loadcomplete.waitlist && waitlists && waitlists.length != 0">
                <owl-carousel id="wlCarousel" [options]="carouselOne" [carouselClasses]="['owl-theme']"
                    [items]="waitlists">
                    <div class="item checklist" *ngFor="let waitlist of waitlists; let i=index">
                        <div class="header">
                            <div class="lt">
                                <div class="title" (click)="providerDetail(waitlist.providerAccount)">
                                    <h3>{{waitlist.providerAccount.businessName || '' | capitalizeFirst}}</h3>
                                </div>
                                <div class="location consumr" *ngIf="waitlist.queue.location">
                                    {{waitlist.queue.location.place || '' | capitalizeFirst}}
                                    <span class="consumr-loc-icon"><a *ngIf="waitlist.queue.location.googleMapUrl"
                                            rel="noopener" [href]="waitlist.queue.location.googleMapUrl" target="_blank"
                                            class="icon-location" matTooltip="Click to navigate">
                                        </a></span>
                                </div>
                                <div class="status-outer">
                                    <div class="started-label" *ngIf="waitlist.waitlistStatus == 'started'">
                                        {{status_started_cap}}
                                    </div>
                                    <div class="done-label" *ngIf="waitlist.waitlistStatus == 'done'">
                                        {{status_done_cap}}
                                    </div>
                                </div>
                            </div>
                            <div class="rt">
                                <div class="favourite" *ngIf="checkIfFav(waitlist.providerAccount.id)">
                                    <span class="icon-favourite-filled"
                                        (click)="doDeleteFavProvider(waitlist.providerAccount)"
                                        matTooltip="{{remove_fav_cap}}"></span>
                                </div>
                                <div class="favourite" *ngIf="!checkIfFav(waitlist.providerAccount.id)">
                                    <span class="icon-favourite" matTooltip="Add to Favourite"
                                        (click)="addFavProvider(waitlist.providerAccount.id)"></span>
                                </div>
                            </div>
                        </div>
                        <div class="details">
                            <div class="lt">
                                <div class="lt0 pointlist" (click)="showcheckindetails(waitlist)">
                                    <span class="service">{{waitlist.service.name | capitalizeFirst}}</span> for <span
                                        class="forwhom" *ngFor="let user of waitlist.waitlistingFor">
                                        {{user.firstName | capitalizeFirst}} {{user.lastName | capitalizeFirst}}
                                    </span>
                                </div>
                                <ng-container
                                    *ngIf="waitlist.estimated_time && (waitlist.waitlistStatus == 'checkedIn'  ||
                                        waitlist.waitlistStatus == 'arrived' || waitlist.waitlistStatus == 'cancelled')">
                                    <div class="lt0"
                                        *ngIf="waitlist.estimated_date=='' && waitlist.waitlistStatus != 'cancelled'">
                                        {{waitlist.estimated_caption}} <span class="time now">
                                            {{waitlist.estimated_timenow}}</span><span style="display: flex">
                                            {{waitlist.estimated_time}}</span>
                                    </div>
                                    <div class="lt0"
                                        *ngIf="waitlist.estimated_date!='' && waitlist.waitlistStatus != 'cancelled'">
                                        {{waitlist.estimated_caption}} <span class="time now">
                                            <span *ngIf="waitlist.estimated_date_type == 'date'">{{waitlist.estimated_date
                                                | date: dateFormatSp }}</span>
                                            <span
                                                *ngIf="waitlist.estimated_date_type == 'string'">{{waitlist.estimated_date}}
                                            </span>
                                            <span
                                                *ngIf="waitlist.calculationMode != 'NoCalc'">,{{waitlist.estimated_time}}</span></span>
                                        <span style="display: flex"> {{waitlist.estimated_timeslot}}</span>
                                    </div>
                                    <div class="lt0" *ngIf="waitlist.waitlistStatus == 'cancelled'">
                                        <div class="lt0">
                                            {{waitlist.estimated_caption}} <span class="time">{{waitlist.estimated_date
                                                | date: dateFormatSp }},
                                                <span style="display: flex"> {{waitlist.estimated_time}}</span></span>
                                        </div>
                                        <div class="red">
                                            {{waitlist.cancelled_caption}}
                                            <span class="time"> {{waitlist.cancelled_date | date: dateFormatSp}}
                                                {{waitlist.cancelled_time}}</span>
                                        </div>
                                    </div>
                                </ng-container>
                                <div class="lt0"
                                    *ngIf="waitlist.waitlistStatus != 'cancelled'">
                                    <span *ngIf="waitlist.personsAhead === 0"> {{first_person}}</span>
                                    <span *ngIf="waitlist.personsAhead === 1"> <span
                                            class="forwhom">{{waitlist.personsAhead}}</span>{{one_person_ahead}} </span>
                                    <span *ngIf="waitlist.personsAhead > 1"> <span
                                            class="forwhom">{{waitlist.personsAhead}}</span>{{people_ahead}} </span>
                                </div>
                                <!-- <div class="lt0" *ngIf="waitlist.token">
                                    {{token_no}} <span class="token">{{waitlist.token}} </span>
                                </div> -->
                                <div class="lt0" *ngIf="!waitlist.batchName && waitlist.token">
                                    {{token_no}} <span class="token">{{waitlist.token}} </span>
                                </div>
                                <div class="lt0" *ngIf="waitlist.batchName" style="font-size: 0.9rem;">
                                    Batch <span class="token">{{waitlist.batchName}} </span>
                                </div>
                                <div class="lt0" *ngIf="waitlist.partySize && waitlist.partySize > 1">
                                    {{party_size}} <span class="persons">{{waitlist.partySize}}</span>
                                </div>
                                <div class="lt0 payment"
                                    *ngIf="!waitlist.parentUuid && waitlist.waitlistStatus=='prepaymentPending'">
                                    <span class="paytext">{{checkindisablemsg}} {{waitlist.counter}}
                                        {{checkindisablemsg1}}</span>
                                </div>
                                <div class="lt0 payment"
                                    *ngIf="waitlist.amountDue>0 && (waitlist.billViewStatus=='Show') && waitlist.waitlistStatus != 'cancelled'">
                                    <span class="paytext"><span>Amount Due : <span>&#8377; </span>{{waitlist.amountDue}}
                                        </span><a class="bt3 cust-btn pointer-cursor"
                                            (click)="viewBill(waitlist,'checkin')">Pay</a></span>
                                </div>
                                <div *ngIf="waitlist.waitlistStatus=='checkedIn'|| 'prepaymentPending'">
                                    <div class="lt0"
                                        *ngIf="waitlist.jaldeeWaitlistDistanceTime && waitlist.service.livetrack && waitlist.waitlistStatus === 'checkedIn' && !waitlist.future">
                                        <div>
                                                <div class="mb5">You are 10 km away from {{waitlist.providerAccount.businessName}}<span><i class="fa fa-refresh fl-right" (click)="gotoLivetrackchekin(waitlist.ynwUuid,waitlist.providerAccount.id,'true')" aria-hidden="true"></i></span></div>
                                                <div class="mb5"> You are sharing your arrival time with {{waitlist.providerAccount.businessName}}<span><i class="fa fa-check fl-right" aria-hidden="true"></i></span></div>
                                            <!-- <span *ngIf="waitlist.jaldeeStartTimeType == 'AFTERSTART'"> <label>Enable
                                                    live tracking </label></span>
                                            <p *ngIf="waitlist.jaldeeStartTimeType == 'ONEHOUR'"
                                                class="form-level-settings">Automatic Live tracking is enabled</p>
                                            <span *ngIf="waitlist.jaldeeStartTimeType == 'ONEHOUR'">
                                                <label
                                                    *ngIf="waitlist.jaldeeWaitlistDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'DRIVING'">I
                                                    am driving </label>
                                                <label
                                                    *ngIf="waitlist.jaldeeWaitlistDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'WALKING'">I
                                                    am walking </label>
                                            </span>
                                            <span class="" *ngIf="!changemode[i]">
                                                <i *ngIf="waitlist.jaldeeWaitlistDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'DRIVING'"
                                                    class="fa fa-car mgn-lt-20" aria-hidden="true"></i>
                                               
                                                <img src="./assets/images/walking.png" alt="" class="mgn-lt-20"
                                                    style="width: 15px;height:15px;"
                                                    *ngIf="waitlist.jaldeeWaitlistDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'WALKING'" />
                                                <i class="fa fa-pencil link mgn-lt-10 "
                                                    (click)="changemode[i] = !changemode[i]"></i>
                                            </span>
                                            <span *ngIf="changemode[i]" (click)="changemode[i] = !changemode[i]">
                                                <i class="fa fa-car mgn-lt-20" [class.driving]="driving"
                                                    aria-hidden="true"
                                                    (click)="getTravelMod(waitlist.ynwUuid,waitlist.providerAccount.id,'DRIVING',i)"></i>
                                                
                                                <img src="./assets/images/walking.png" alt=""
                                                    class="walkingMode mgn-lt-20" [class.walking]="walking"
                                                    aria-hidden="true"
                                                    (click)="getTravelMod(waitlist.ynwUuid,waitlist.providerAccount.id,'WALKING',i)" />
                                            </span>

                                            <span *ngIf="waitlist.jaldeeStartTimeType == 'AFTERSTART'"
                                                class="pull-right">
                                                <mat-slide-toggle [checked]="statusOfTrack[i]"
                                                    (change)="changeTrackstatus(waitlist.ynwUuid,waitlist.providerAccount.id,i,$event)"
                                                    class="trackSlide "></mat-slide-toggle>
                                                <label
                                                    class="mgn-lt-10"><b>{{statusOfTrack[i] ? 'On' : 'Off'}}</b></label>
                                            </span> -->
                                        </div>
                                    </div>
                                    <div class="lt0" *ngIf="!waitlist.jaldeeWaitlistDistanceTime && waitlist.service.livetrack && waitlist.waitlistStatus === 'checkedIn' && !waitlist.future">
                                            <div >
                                                    <div class="mb5"> You are 10 km away from {{waitlist.providerAccount.businessName}}<span><i class="fa fa-refresh fl-right" (click)="gotoLivetrackchekin(waitlist.ynwUuid,waitlist.providerAccount.id,'false')" aria-hidden="true"></i></span></div>
                                                    <div class="mb5"> Oops you are NOT sharing your arrival time with {{waitlist.providerAccount.businessName}}<span><i class="fa fa-times fl-right" aria-hidden="true"></i></span></div>
                                                    <span> Jaldee recommands you share your arrival time with provider</span>
                                            </div>
                                        </div>
                                </div>
                            </div>
                            <div class="rt">
                                <ul class="controls">
                                    <li *ngIf="waitlist.billViewStatus == 'Show'">
                                        <span class="view-bill"
                                            *ngIf="!(waitlist.amountDue>0) && waitlist.waitlistStatus != 'cancelled'"
                                            (click)="viewBill(waitlist,'checkin')">Receipt</span>
                                        <span class="view-bill"
                                            *ngIf="waitlist.waitlistStatus === 'cancelled' && waitlist.paymentStatus !== 'NotPaid'"
                                            (click)="viewBill(waitlist,'checkin')">Receipt</span>
                                        <span class="view-bill"
                                            *ngIf="waitlist.amountDue>0 && waitlist.waitlistStatus != 'cancelled'"
                                            (click)="viewBill(waitlist,'checkin')">Bill</span>
                                    </li>
                                    <li (click)="makeFailedPayment(waitlist)"
                                        *ngIf="!waitlist.parentUuid && waitlist.waitlistStatus=='prepaymentPending'">
                                        <span class="payment">{{make_pay_cap}}</span>
                                    </li>
                                    <li (click)="addWaitlistMessage(waitlist)">
                                        <span class="message">{{send_msg_cap}}</span>
                                    </li>
                                    <li class="cancelCheckinBtn"
                                        *ngIf="waitlist.waitlistStatus == 'checkedIn' || waitlist.waitlistStatus == 'arrived' || waitlist.waitlistStatus=='prepaymentPending'">
                                        <span class="cancel"
                                            (click)="doCancelWaitlist(waitlist,'checkin')">{{cancel_checkin_cap}}</span>
                                    </li>
                                    <li *ngIf="waitlist.waitlistStatus == 'done'">
                                        <span class="rate-service" [class.rated]="isRated(waitlist)"
                                            (click)="rateService(waitlist,'checkin')">{{rate_visit}}</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </owl-carousel>
                <div class="owl-theme">
                    <div class="owl-controls">
                        <div class="custom-nav owl-nav"></div>
                    </div>
                </div>
            </div>
            <div class="brd-bt">&nbsp;</div>
            <div class="col-md-12 mgn-up-10 mgn-bt-10"><a class="pointer-cursor underline" (click)="gotoHistory()">Go to
                    History</a></div>
        </div>

        <div class="card c-checkins">
            <mat-accordion>
                <mat-expansion-panel class="no-padding">
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Appointments &nbsp;<span *ngIf="appointments && appointments.length>0">({{appointments.length}})</span>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div *ngIf="appointments.length == 0" class="col-md-12 col-xs-12 col-sm-12 mgn-up-20 nocheckins">
                        <p>No current Appointments available</p>
                    </div>
                    <div class="outer banner no-padding" *ngIf="appointments.length != 0">
                        <owl-carousel id="apptCarousel" [options]="carouselAppointments"
                            [carouselClasses]="['owl-theme']" [items]="appointments">
                            <div class="item apptlist" *ngFor="let appointment of appointments; let i=index">
                                <div class="header">
                                    <div class="lt">
                                        <div class="title" (click)="providerDetail(appointment.providerAccount)">
                                            <h3>{{appointment.providerAccount.businessName || '' | capitalizeFirst}}
                                            </h3>
                                        </div>
                                        <div class="location consumr" *ngIf="appointment.location">
                                            {{appointment.location.place || '' | capitalizeFirst}}
                                            <span class="consumr-loc-icon"><a *ngIf="appointment.location.googleMapUrl"
                                                    rel="noopener" [href]="appointment.location.googleMapUrl" target="_blank"
                                                    class="icon-location" matTooltip="Click to navigate">
                                                </a></span>
                                        </div>
                                        <div class="status-outer">
                                            <div class="started-label" *ngIf="appointment.apptStatus == 'Started'">
                                                {{status_started_cap}}
                                            </div>
                                            <div class="done-label" *ngIf="appointment.apptStatus == 'Completed'">
                                                {{status_done_cap}}
                                            </div>
                                        </div>
                                    </div>
                                    <div class="rt">
                                        <div class="favourite" *ngIf="checkIfFav(appointment.providerAccount.id)">
                                            <span class="icon-favourite-filled"
                                                (click)="doDeleteFavProvider(appointment.providerAccount)"
                                                matTooltip="{{remove_fav_cap}}"></span>
                                        </div>
                                        <div class="favourite" *ngIf="!checkIfFav(appointment.providerAccount.id)">
                                            <span class="icon-favourite" matTooltip="Add to Favourite"
                                                (click)="addFavProvider(appointment.providerAccount.id)"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="details">
                                    <div class="lt">
                                        <div class="lt0 pointlist" (click)="showApptdetails(appointment)">
                                            <span class="service">{{appointment.service.name | capitalizeFirst}}</span>
                                            for <span class="forwhom" *ngFor="let user of appointment.appmtFor">
                                                {{user.firstName | capitalizeFirst}} {{user.lastName | capitalizeFirst}}
                                            </span>
                                        </div>
                                        <ng-container
                                            *ngIf="appointment.appmtTime && (appointment.apptStatus == 'Confirmed'  ||
                                    appointment.apptStatus == 'Arrived' || appointment.apptStatus == 'Cancelled' || appointment.apptStatus == 'Rejected')">
                                            <div class="lt0"
                                                *ngIf="appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'">
                                                Appointment Time<span style="display: flex">
                                                    {{appointment.appmtTime}}</span>
                                            </div>
                                            <div class="lt0"
                                                *ngIf="appointment.appmtDate!='' && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'">
                                                {{appointment.estimated_caption}} <span class="time now">
                                                    <span *ngIf="appointment.estimated_date_type == 'date'">{{appointment.estimated_date
                                                | date: dateFormatSp }}</span>
                                                    <span
                                                        *ngIf="appointment.estimated_date_type == 'string'">{{appointment.estimated_date}}
                                                    </span>
                                                    <!-- <span
                                                        *ngIf="appointment.calculationMode != 'NoCalc'">{{appointment.estimated_time}}</span> -->
                                                    </span>
                                                <span style="display: flex"> {{appointment.estimated_timeslot}}</span>
                                            </div>
                                            <div class="lt0" *ngIf="appointment.apptStatus == 'Cancelled' || appointment.apptStatus == 'Rejected'">
                                                <!-- <div class="lt0">
                                                    {{appointment.estimated_caption}} <span class="time">{{appointment.estimated_date
                                                | date: dateFormatSp }},
                                                        <span style="display: flex">
                                                            {{appointment.estimated_time}}</span></span>
                                                </div> -->
                                                <div class="red">
                                                    {{appointment.cancelled_caption}}
                                                    <span class="time">
                                                        {{appointment.cancelled_date | date: dateFormatSp}}
                                                        {{appointment.cancelled_time}}</span>
                                                </div>
                                            </div>
                                        </ng-container>
                                        <!-- <div class="lt0"
                                            *ngIf="appointment.apptStatus != 'Cancelled' && appointment.calculationMode == 'NoCalc' && appointment.token">
                                            <span *ngIf="appointment.personsAhead === 0"> {{first_person}}</span>
                                            <span *ngIf="appointment.personsAhead === 1"> <span
                                                    class="forwhom">{{appointment.personsAhead}}</span>{{one_person_ahead}}
                                            </span>
                                            <span *ngIf="appointment.personsAhead > 1"> <span
                                                    class="forwhom">{{appointment.personsAhead}}</span>{{people_ahead}}
                                            </span>
                                        </div> -->
                                        <!-- <div class="lt0" *ngIf="appointment.token">
                                    {{token_no}} <span class="token">{{appointment.token}} </span>
                                </div> -->
                                        <div class="lt0" *ngIf="appointment.partySize && appointment.partySize > 1">
                                            {{party_size}} <span class="persons">{{appointment.partySize}}</span>
                                        </div>
                                        <div class="lt0" *ngIf="appointment.batchName" style="font-size: 0.9rem;">
                                            Batch <span class="token">{{appointment.batchName}} </span>
                                        </div>
                                        <div class="lt0 payment"
                                            *ngIf="!appointment.parentUuid && appointment.apptStatus=='prepaymentPending'">
                                            <span class="paytext">{{checkindisablemsg}} {{appointment.counter}}
                                                {{appointmentdisablemsg}}</span>
                                        </div>
                                        <div class="lt0 payment"
                                            *ngIf="appointment.amountDue>0 && (appointment.billViewStatus=='Show') && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'">
                                            <span class="paytext"><span>Amount Due : <span>&#8377;
                                                    </span>{{appointment.amountDue}}
                                                </span><a class="bt3 cust-btn pointer-cursor"
                                                    (click)="viewBill(appointment,'appointment')">Pay</a></span>
                                        </div>
                                        <div *ngIf="appointment.apptStatus=='Confirmed'|| 'prepaymentPending'">
                                            <div class="lt0"
                                                *ngIf="appointment.jaldeeApptDistanceTime && appointment.service.livetrack && appointment.apptStatus === 'Confirmed' && !appointment.future">
                                                <div>
                                                    <div class="mb5"> You are 10 km away from {{appointment.providerAccount.businessName}}<span><i class="fa fa-refresh fl-right" (click)="gotoLivetrack(appointment.uid,appointment.providerAccount.id,'true')" aria-hidden="true"></i></span></div>
                                                    <div class="mb5"> You are sharing your arrival time with {{appointment.providerAccount.businessName}}<span><i class="fa fa-check fl-right" aria-hidden="true"></i></span></div>
                                                    <!-- <span *ngIf="appointment.jaldeeStartTimeType == 'AFTERSTART'">
                                                        <label>Enable
                                                            live tracking </label></span>
                                                    <p *ngIf="appointment.jaldeeStartTimeType == 'ONEHOUR'"
                                                        class="form-level-settings">Automatic Live tracking is enabled
                                                    </p>
                                                    <span *ngIf="appointment.jaldeeStartTimeType == 'ONEHOUR'">
                                                        <label
                                                            *ngIf="appointment.jaldeeApptDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'DRIVING'">I
                                                            am driving </label>
                                                        <label
                                                            *ngIf="appointment.jaldeeApptDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'WALKING'">I
                                                            am walking </label>
                                                    </span>
                                                    <span class="" *ngIf="!changemodeAppt[i]">
                                                        <i *ngIf="appointment.jaldeeApptDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'DRIVING'"
                                                            class="fa fa-car mgn-lt-20" aria-hidden="true"></i>
                                                        <img src="./assets/images/walking.png" alt="" class="mgn-lt-20"
                                                            style="width: 15px;height:15px;"
                                                            *ngIf="appointment.jaldeeApptDistanceTime.jaldeeDistanceTime.jaldeelTravelTime.travelMode == 'WALKING'" />
                                                        <i class="fa fa-pencil link mgn-lt-10 "
                                                            (click)="changemodeAppt[i] = !changemodeAppt[i]"></i>
                                                    </span>
                                                    <span *ngIf="changemodeAppt[i]"
                                                        (click)="changemodeAppt[i] = !changemodeAppt[i]">
                                                        <i class="fa fa-car mgn-lt-20" [class.driving]="driving"
                                                            aria-hidden="true"
                                                            (click)="getAppointmentTravelMod(appointment.uid,appointment.providerAccount.id,'DRIVING',i)"></i>
                                                        <img src="./assets/images/walking.png" alt=""
                                                            class="walkingMode mgn-lt-20" [class.walking]="walking"
                                                            aria-hidden="true"
                                                            (click)="getAppointmentTravelMod(appointment.uid,appointment.providerAccount.id,'WALKING',i)" />
                                                    </span>

                                                    <span *ngIf="appointment.jaldeeStartTimeType == 'AFTERSTART'"
                                                        class="pull-right">
                                                        <mat-slide-toggle [checked]="statusOfApptTrack[i]"
                                                            (change)="changeAppointmentTrackstatus(appointment.uid,appointment.providerAccount.id,i,$event)"
                                                            class="trackSlide "></mat-slide-toggle>
                                                        <label
                                                            class="mgn-lt-10"><b>{{statusOfApptTrack[i] ? 'On' : 'Off'}}</b></label>
                                                    </span> -->
                                                </div>
                                            </div>
                                            <div class="lt0" *ngIf="!appointment.jaldeeApptDistanceTime && appointment.service.livetrack && appointment.apptStatus === 'Confirmed' && !appointment.future">
                                            <div >
                                                    <div class="mb5"> You are 10 km away from {{appointment.providerAccount.businessName}}<span><i class="fa fa-refresh fl-right" (click)="gotoLivetrack(appointment.uid,appointment.providerAccount.id,'false')" aria-hidden="true"></i></span></div>
                                                    <div class="mb5"> Oops you are NOT sharing your arrival time with {{appointment.providerAccount.businessName}}<span><i class="fa fa-times fl-right" aria-hidden="true"></i></span></div>
                                                    <div> Jaldee recommands you share your arrival time with provider</div>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                    <div class="rt">
                                        <ul class="controls">
                                            <li *ngIf="appointment.billViewStatus == 'Show'">
                                                <span class="view-bill"
                                                    *ngIf="!(appointment.amountDue>0) && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'"
                                                    (click)="viewBill(appointment,'appointment')">Receipt</span>
                                                <span class="view-bill"
                                                    *ngIf="appointment.apptStatus === 'Cancelled' && appointment.apptStatus === 'Rejected' && appointment.paymentStatus !== 'NotPaid'"
                                                    (click)="viewBill(appointment,'appointment')">Receipt</span>
                                                <span class="view-bill"
                                                    *ngIf="appointment.amountDue>0 && appointment.apptStatus != 'Cancelled' && appointment.apptStatus != 'Rejected'"
                                                    (click)="viewBill(appointment,'appointment')">Bill</span>
                                            </li>
                                            <li (click)="makeApptFailedPayment(appointment)"
                                                *ngIf="!appointment.parentUuid && appointment.apptStatus=='prepaymentPending'">
                                                <span class="payment">{{make_pay_cap}}</span>
                                            </li>
                                            <li (click)="addWaitlistMessage(appointment,'appt')">
                                                <span class="message">{{send_msg_cap}}</span>
                                            </li>
                                            <li class="cancelCheckinBtn"
                                                *ngIf="appointment.apptStatus == 'Confirmed' || appointment.apptStatus == 'Arrived' || appointment.apptStatus=='prepaymentPending'">
                                                <span class="cancel"
                                                    (click)="doCancelWaitlist(appointment,'appointment')">Cancel
                                                    Appointment</span>
                                            </li>
                                            <li *ngIf="appointment.apptStatus == 'Completed'">
                                                <span class="rate-service" [class.rated]="isRated(appointment)"
                                                    (click)="rateService(appointment,'appointment')">{{rate_visit}}</span>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </owl-carousel>
                        <div class="owl-theme">
                            <div class="owl-controls">
                                <div class="custom-appt-nav owl-nav"></div>
                            </div>
                        </div>
                    </div>
                    <div class="brd-bt">&nbsp;</div>
                    <div class="col-md-12 mgn-up-10 mgn-bt-10"><a class="pointer-cursor underline"
                            (click)="gotoApptmentHistory()">Go to History</a></div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>

        <div class="card c-checkins favourites">
            <mat-accordion>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title>
                            Donations<ng-container *ngIf="donations && donations.length>0"> ({{donations.length}})
                            </ng-container>
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div *ngIf="loadcomplete.donations && donations && donations.length == 0"
                        class="col-md-12 col-xs-12 col-sm-12 mgn-up-20 nocheckins">
                        <p>No Donations Today</p>
                    </div>
                    <div class="outer banner donation no-padding"
                        *ngIf="loadcomplete.donations && donations && donations.length != 0">
                        <owl-carousel id="donCarousel" [options]="carouselDonations" [carouselClasses]="['owl-theme']"
                            [items]="dontations">
                            <div class="item" *ngFor="let donation of donations; let i=index">
                                <div class="header">
                                <div class="lt">
                                    <div class="title" *ngIf="donation.providerAccount" (click)="providerDetail(donation.providerAccount)">
                                        <h3>{{donation.providerAccount.businessName || '' | capitalizeFirst}}</h3>
                                    </div> 
                                    <div class="location consumr" *ngIf="donation.location.place">
                                        {{donation.location.place || '' | capitalizeFirst}}
                                        <span class="consumr-loc-icon"><a *ngIf="donation.location.latitude && donation.location.longitude"
                                                rel="noopener" [href]="getMapUrl(donation.location.latitude, donation.location.longitude)" target="_blank"
                                                class="icon-location" matTooltip="Click to navigate">
                                            </a></span>
                                    </div>
                                    <!-- <div class="status-outer">
                                        <div class="started-label" *ngIf="waitlist.waitlistStatus == 'started'">
                                            {{status_started_cap}}
                                        </div>
                                        <div class="done-label" *ngIf="waitlist.waitlistStatus == 'done'">
                                            {{status_done_cap}}
                                        </div>
                                    </div> -->
                                </div>
                                <div class="rt">
                                    <div class="favourite" *ngIf="donation.providerAccount && checkIfFav(donation.providerAccount.id)">
                                        <span class="icon-favourite-filled" (click)="doDeleteFavProvider(donation.providerAccount)"
                                            matTooltip="{{remove_fav_cap}}"></span>
                                    </div>
                                    <div class="favourite" *ngIf="donation.providerAccount && !checkIfFav(donation.providerAccount.id)">
                                        <span class="icon-favourite" matTooltip="Add to Favourite"
                                            (click)="addFavProvider(donation.providerAccount.id)"></span>
                                    </div>
                                </div>
                            </div>
                                <div class="details">
                                    <div class="lt">
                                        <div class="lt0">
                                            <span class="">{{donation.service.name | capitalizeFirst}}</span>
                                            <!-- for <span
                                            class="forwhom" *ngFor="let user of waitlist.waitlistingFor">
                                            {{user.firstName | capitalizeFirst}} {{user.lastName | capitalizeFirst}}
                                        </span> -->
                                            <div class="">
                                                <span class="">Amount: {{rupee_symbol}} {{donation.donationAmount}}
                                                </span>
                                            </div>
                                        </div>

                                        <!-- <div class="lt0 payment"
                                        *ngIf="!waitlist.parentUuid && waitlist.waitlistStatus=='prepaymentPending'">
                                        <span class="paytext">{{checkindisablemsg}} {{waitlist.counter}}
                                            {{checkindisablemsg1}}</span>
                                    </div>                                  -->
                                    </div>
                                    <div class="rt">
                                        <!-- <ul class="controls">
                                        <li *ngIf="waitlist.billViewStatus == 'Show'">
                                            <span class="view-bill"
                                                *ngIf="!(waitlist.amountDue>0) && waitlist.waitlistStatus != 'cancelled'"
                                                (click)="viewBill(waitlist)">Receipt</span>
                                            <span class="view-bill"
                                                *ngIf="waitlist.waitlistStatus === 'cancelled' && waitlist.paymentStatus !== 'NotPaid'"
                                                (click)="viewBill(waitlist)">Receipt</span>
                                            <span class="view-bill"
                                                *ngIf="waitlist.amountDue>0 && waitlist.waitlistStatus != 'cancelled'"
                                                (click)="viewBill(waitlist)">Bill</span>
                                        </li>
                                        <li (click)="makeFailedPayment(waitlist)"
                                            *ngIf="!waitlist.parentUuid && waitlist.waitlistStatus=='prepaymentPending'">
                                            <span class="payment">{{make_pay_cap}}</span>
                                        </li>
                                        <li (click)="addWaitlistMessage(waitlist)">
                                            <span class="message">{{send_msg_cap}}</span>
                                        </li>
                                        <li class="cancelCheckinBtn"
                                            *ngIf="waitlist.waitlistStatus == 'checkedIn' || waitlist.waitlistStatus == 'arrived' || waitlist.waitlistStatus=='prepaymentPending'">
                                            <span class="cancel"
                                                (click)="doCancelWaitlist(waitlist)">{{cancel_checkin_cap}}</span>
                                        </li>
                                        <li *ngIf="waitlist.waitlistStatus == 'done'">
                                            <span class="rate-service" [class.rated]="isRated(waitlist)"
                                                (click)="rateService(waitlist)">{{rate_visit}}</span>
                                        </li>
                                    </ul> -->
                                    </div>
                                </div>
                            </div>
                        </owl-carousel>
                        <div class="owl-theme">
                            <div class="owl-controls">
                                <div class="custom-don-nav owl-nav"></div>
                            </div>
                        </div>
                    </div>
                    <div class="brd-bt">&nbsp;</div>
                    <div class="col-md-12 mgn-up-10 mgn-bt-10"><a class="pointer-cursor underline"
                            (click)="gotoDonations()">Go to Donations</a></div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>

        <div class="card c-checkins">
            <h2><span class="pointer-cursor" (click)="paymentsClicked()">Payments</span></h2>
        </div>

        <div class="card favourites">
            <mat-accordion>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title [matTooltipClass]="tooltipcls" [matTooltip]="favTooltip">
                            {{my_fav_cap}}
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <div class="outer">
                        <div class="list" [class.active]="open_fav_div == i"
                            *ngFor="let provider of fav_providers; index as i">
                            <div class="header">
                                <div class="lt" (click)="toogleDetail(provider, i)">
                                    <h3 class="pointer-cursor">
                                        <a
                                            (click)="providerDetail(provider)">{{provider.businessName | capitalizeFirst}}</a>
                                    </h3>
                                </div>
                                <div class="rt">
                                    <ul class="controls">
                                        <li (click)="addCommonMessage(provider)"><span
                                                class="message">{{send_msg_cap}}</span></li>
                                        <li>
                                            <button mat-icon-button [matMenuTriggerFor]="appMenu">
                                                <mat-icon>more_vert</mat-icon>
                                            </button>
                                        </li>
                                    </ul>
                                    <mat-menu #appMenu="matMenu">
                                        <button mat-menu-item (click)="providerDetail(provider)">{{view_cap}}</button>
                                        <button mat-menu-item (click)="doDeleteFavProvider(provider)">
                                            <span class="add-fav favourited">
                                                {{remove_fav_cap}}</span>
                                        </button>
                                        <button mat-menu-item (click)="providerManagePrivacy(provider,i)">
                                            {{manage_privacy_cap}}
                                        </button>
                                    </mat-menu>
                                </div>
                            </div>
                            <div class="detail" [@hideShowAnimator]="hideShowAnimator" *ngIf="open_fav_div == i">
                                <div class="location" *ngFor="let loc of provider.locations">
                                    <div class="locationname">
                                        <span class="icon-location"></span> {{loc.place | capitalizeFirst}}
                                        <sup class="font-open-now" *ngIf="loc.opennow">&nbsp;{{open_now_cap}}
                                        </sup>
                                    </div>
                                    <div class="bt-l" *ngIf="loc['waitlist'] && provider.onlinePresence">
                                        <div style="display: block;" class="wt-tme" *ngIf="loc['estimatedtime_det']">
                                            <!-- <div class="o-now" *ngIf="loc.opennow">{{open_now_cap}}</div> -->
                                            <div class="timing"
                                                *ngIf="loc['calculationMode']!='NoCalc' && loc['estimatedtime_det']['caption']">
                                                <span class="est-time">{{loc['estimatedtime_det']['caption']}}</span>
                                                <span class="time-data">{{loc['estimatedtime_det']['time']}}
                                                </span>
                                            </div>
                                            <div>
                                                <div *ngIf="loc['personAhead']">
                                                    <div class="timing" style="margin-bottom: 5px" *ngIf="!loc.opennow && loc['calculationMode']=='NoCalc' && loc['showToken']">
                                                        <span class="est-time"> Next Available Time:</span>
                                                        <span class="time-data">
                                                            {{loc['estimatedtime_det']['nextAvailDate']}} </span>
                                                    </div>
                                                    <b>{{loc['personAhead']}}</b> <span *ngIf="loc['personAhead'] > 1"
                                                        class="people-ahead">
                                                        {{people_ahead}}</span><span *ngIf="loc['personAhead'] == 1"
                                                        class="people-ahead">
                                                        {{one_person_ahead}}</span>
                                                </div>
                                                <div style="font-weight: 600" *ngIf="loc['personAhead'] === 0">
                                                    <div class="timing" style="margin-bottom: 5px" *ngIf="!loc.opennow && loc['calculationMode']=='NoCalc' && loc['showToken']">
                                                        <span class="est-time"> Next Available Time:</span>
                                                        <span class="time-data">
                                                            {{loc['estimatedtime_det']['nextAvailDate']}} </span>
                                                    </div>
                                                    <div class="time-data">
                                                        {{loc['personAhead']}} {{people_ahead}} </div>{{get_token_cap}}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="wt-tme notallowed" *ngIf="loc['estimatedtime_det']">
                                            <ng-container *ngIf="loc['estimatedtime_det']['message']">
                                                {{loc['estimatedtime_det']['message']}}</ng-container>
                                        </div>
                                    </div>
                                    <div class="bt-r"
                                    *ngIf="loc['estimatedtime_det'] && (loc['onlineCheckIn'] || provider.settings && provider.settings.futureDateWaitlist)">
                                    <span class="cs-btn chk-btn"
                                        (click)="goCheckin(provider, loc, loc['estimatedtime_det']['cdate'], false, 'fav_provider')"
                                        *ngIf="loc['waitlist'] && provider.onlinePresence && loc['onlineCheckIn'] && loc['isAvailableToday'] && loc['availableToday'] && (loc['calculationMode']!='NoCalc' || (loc['calculationMode']=='NoCalc' && !loc['showToken']))">
                                        {{getTerminologyTerm('waitlist')}}</span>
                                    <span class="cs-btn chk-btn"
                                        (click)="goCheckin(provider, loc, loc['estimatedtime_det']['cdate'], false, 'fav_provider')"
                                        *ngIf="loc['waitlist'] && provider.onlinePresence && loc['onlineCheckIn'] && loc['isAvailableToday'] && loc['availableToday'] && loc['calculationMode']=='NoCalc' && loc['showToken']">{{get_token_btn}}</span>
                                    <span class="cs-btn chk-btn disabled"
                                        *ngIf="loc['waitlist'] && provider.onlinePresence && (loc['calculationMode']!='NoCalc' || (loc['calculationMode']=='NoCalc' && !loc['showToken'])) && (!loc['onlineCheckIn'] || !loc['isAvailableToday'] || !loc['availableToday'])">
                                        {{getTerminologyTerm('waitlist')}}</span>
                                    <span class="cs-btn chk-btn disabled"
                                        *ngIf="loc['waitlist'] && provider.onlinePresence && loc['calculationMode']=='NoCalc' && loc['showToken'] && (!loc['onlineCheckIn'] || !loc['isAvailableToday'] || !loc['availableToday'])">{{get_token_btn}}</span>
                                    <span class="cs-btn bt10"
                                        *ngIf="loc['waitlist'] && provider.onlinePresence && provider.settings && provider.settings.futureDateWaitlist && loc['estimatedtime_det']['cdate']"
                                        (click)="goCheckin(provider, loc, loc['estimatedtime_det']['cdate'], true, 'fav_provider')">
                                        {{do_you_want_to_cap}} <span
                                            *ngIf="loc['calculationMode']!='NoCalc' || (loc['calculationMode']=='NoCalc' && !loc['showToken'])">
                                            {{getTerminologyTerm('waitlist')}} </span>
                                        <span
                                            *ngIf="loc['calculationMode']=='NoCalc' && loc['showToken']">{{get_token_btn}}
                                        </span>{{for_cap}}
                                        <span>{{different_date_cap}}</span>
                                    </span>
                                   <br>
                                    <span class="cs-btn chk-btn" *ngIf="loc['apptAllowed'] && provider.onlinePresence"
                                        (click)="goAppointment(provider, loc, loc['estimatedtime_det']['cdate'], false, 'fav_provider')">
                                        Appointment</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div *ngIf="loadcomplete.fav_provider && fav_providers && fav_providers.length == 0">
                            <p>{{you_hav_added_caption}}</p>
                        </div>
                    </div>
                </mat-expansion-panel>
            </mat-accordion>
        </div>
        <!-- <div class="card history">
            <mat-accordion>
                <mat-expansion-panel>
                    <mat-expansion-panel-header>
                        <mat-panel-title [matTooltipClass]="tooltipcls" [matTooltip]="historyTooltip">
                            {{history_cap}}
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <app-consumer-checkin-history-list [reloadapi]="reload_history_api">
                    </app-consumer-checkin-history-list>
                </mat-expansion-panel>
            </mat-accordion>
        </div> -->
    </div>
</section>
<div [innerHTML]="payment_popup" #div [style.display]="'none'"></div>