<div class="card shadow d-flex flex-row header">
    <div class="my-auto">
        <a class="" (click)="goBack('back')"><i class="fa fa-arrow-left"></i>&emsp;</a>
    </div>
    <div class="text-center mx-auto" *ngIf="!loadingS3">
        <app-booking-accountinfo [businessInfo]="businessInfo" [smallDevice]="smallDevice" *ngIf="smallDevice">
        </app-booking-accountinfo>
    </div>
</div>
<section #consumer_checkin class="consumerCheckin" [ngClass]="theme?theme:''"
    [ngClass]="smallDevice?'container':'container-fluid'">
    <div [ngClass]="{'loadingpaytm': loadingPaytm}"></div>
    <div  class="customLoader" *ngIf="loadingPaytm">
        <app-common-innerloading-spinner ></app-common-innerloading-spinner>
    </div>
    <div class="loading-hgt my-1 login-form_custom" *ngIf="!loggedIn || loadingS3">
        <div class="card card-custom no-margin hgt-adjust">
            <div class="card-body p-0">
                <app-consumer-join *ngIf="!loggedIn" (actionPerformed)="actionPerformed($event)"></app-consumer-join>
                <!-- <app-authentication *ngIf="!loggedIn" (actionPerformed)="actionPerformed($event)"></app-authentication> -->
                <app-common-innerloading-spinner *ngIf="loggedIn && loadingS3"></app-common-innerloading-spinner>
            </div>
        </div>
    </div>
    <div class="clearfix"></div>
    <div class="row" *ngIf="loggedIn">
        <div class="col-md-4 col-lg-4 col-sm-12 col-xs-12 d-flex align-items-stretch desktop-only" *ngIf="!smallDevice">
            <div class="card shadow hgt-adjust" *ngIf="!loadingS3"> 
                <app-booking-accountinfo [businessInfo]="businessInfo" [smallDevice]="smallDevice" *ngIf="!smallDevice">
                </app-booking-accountinfo>
                <div class="booking-img"></div>
                <div class="clearfix"></div>
            </div>
        </div>
        <div class="col-md-8 col-lg-8 col-sm-12 col-xs-12 d-flex align-items-stretch p-1">
            <div class="card shadow hgt-adjust">
                <div *ngIf="!loading && selectedService">
                    <div class="p-0">
                        <div class="wizard wizard-1" id="kt_wizard_v1" data-wizard-state="step-first"
                            data-wizard-clickable="false">
                            <div class="">
                                <div class="">
                                    <div class="" data-wizard-type="step-content" data-wizard-state="current"
                                        *ngIf="bookStep === 2">
                                        <div class="lbl col-sm-12 col-md-12 col-lg-12 col-xs-12 p-1">
                                            <div class="pad-20 quest-head">
                                                Fill the following one time information
                                            </div>
                                            <app-questionnaire [questionnaireList]="onetimeQuestionnaireList"
                                                [questionAnswers]="oneTimeInfo" [source]="'onetime'"
                                                (returnAnswers)="getOneTimeQuestionAnswers($event)">
                                            </app-questionnaire>
                                        </div>
                                        <div class="clearfix"></div>
                                        <hr>
                                        <div
                                            class="text-center col-sm-12 col-md-12 col-lg-12 col-xs-12 col-sm-12 d-flex justify-content-between width-100 mgn-lt-10 hf-single-btn-container">
                                            <button type="button"
                                                class="mx-auto next-button btn btn-primary font-weight-bold text-capitalize px-5 py-2"
                                                (click)="goToStep('next')">
                                                Next
                                            </button> &nbsp;
                                        </div>
                                        <div class="clearfix"></div>
                                    </div>
                                    <div class="" data-wizard-type="step-content" data-wizard-state="current"
                                        *ngIf="bookStep === 1">
                                        
                                        <!-- Service Info -->
                                        <div class="col-xs-12" *ngIf="selectedService">
                                            <app-service-display [virtualModes]="callingModesDisplayName" [service]="selectedService"
                                                [showVirtualInfo]="type !== 'waitlistreschedule'"></app-service-display>
                                        </div>
                                        <div class="clearfix"></div>
                                        <hr />                                        
                                        <div class="col-xs-12" *ngIf="selectedService">
                                            <app-date-pagination (date_change_event)="checkinDateChanged($event)"
                                                [selected_date]="checkinDate" [availableDates]="availableDates">
                                            </app-date-pagination>
                                        </div>
                                        <div class="col-xs-12" *ngIf="queuejson && queuejson.length > 0">
                                            <app-slot-picker (slotSelected)="slotSelected($event)"
                                                [slots]="queuejson" [selectedSlot]="queuejson[0]">
                                            </app-slot-picker>
                                        </div>
                                        <div class="col-md-12 col-xs-12 col-sm-12 slotdiv red mt-3 text-center" *ngIf="queuejson && queuejson.length <= 0 && queuesLoaded">                                           
                                            <b>No slots available on selected date.Please choose other date.</b>                                        
                                        </div>
                                        <div class="clearfix"></div>
                                        <hr/>
                                        <div class="col-md-12 col-xs-12 col-sm-12">                                                        
                                            <div *ngIf="wt_personaahead && personsAhead>=0 && queuejson && queuejson.length > 0"
                                                class="text-primary col-md-12 col-xs-12 col-sm-12 no-padding lnk">
                                                <h5><b>Waiting in Line</b></h5>
                                            </div>
                                            <div class="col-md-12 col-xs-12 col-sm-12 no-padding"
                                                *ngIf="wt_personaahead && queuejson && queuejson.length > 0">
                                                <h6 class="card-title serv-time">
                                                    <span *ngIf="personsAhead <= 0">0
                                                        People</span>
                                                    <span *ngIf="personsAhead == 1">1<span>
                                                            Person</span></span>
                                                    <span *ngIf="personsAhead > 1">{{personsAhead}}<span>
                                                            People</span></span>
                                                    <span *ngIf="calc_mode=='NoCalc'">
                                                        <span *ngIf="!isFutureDate">
                                                        </span>
                                                    </span>
                                                    <span *ngIf="serviceTime=='' && calc_mode!='NoCalc'">
                                                        <span class="color-grey">\</span>
                                                        <span>{{waitingTime}}</span>
                                                    </span>
                                                    <span *ngIf="serviceTime!='' && calc_mode!='NoCalc'">
                                                        <ng-container *ngIf="isFutureDate">
                                                        </ng-container>
                                                        <ng-container *ngIf="!isFutureDate">
                                                            <span><span class="color-grey"> \
                                                                </span>{{serviceTime}}</span>
                                                        </ng-container>
                                                    </span>
                                                </h6>
                                            </div>
                                        </div>

                                        <div class="action-buttons">                            
                                            <div *ngIf="type != 'waitlistreschedule' && !selectedService.isPrePayment"
                                                class="text-center col-sm-12 col-md-12 col-lg-12 col-xs-12 col-sm-12 mx-auto">
                                                <button type="button"
                                                    class="next-button btn btn-primary font-weight-bold text-capitalize px-9 py-4"
                                                    (click)="goToStep('next');actionCompleted()"
                                                    [class.disabled]="(queuejson && queuejson.length == 0 && !api_loading1)">
                                                    Next
                                                </button>
                                            </div>
                                            <div *ngIf="type != 'waitlistreschedule' && selectedService.isPrePayment && questionnaireList.labels && questionnaireList.labels.length > 0"
                                                class="text-center col-sm-12 col-md-12 col-lg-12 col-xs-12 col-sm-12 mx-auto">
                                                <button type="button"
                                                    class="next-button btn btn-primary font-weight-bold text-capitalize px-9 py-4"
                                                    (click)="goToStep('next');actionCompleted()"
                                                    [class.disabled]="(queuejson && queuejson.length == 0 && !api_loading1)">
                                                    Next
                                                </button>
                                            </div>
                                            <div *ngIf="type != 'waitlistreschedule' && selectedService.isPrePayment && !questionnaireList.labels"
                                                class="text-center col-sm-12 col-md-12 col-lg-12 col-xs-12 col-sm-12 mx-auto">
                                                <button type="button"
                                                    class="next-button btn btn-primary font-weight-bold text-capitalize px-9 py-4"
                                                    (click)="goToStep('next');actionCompleted()"
                                                    [class.disabled]="(queuejson && queuejson.length == 0 && !api_loading1)">
                                                    Next
                                                </button>
                                            </div>
                                            <div class="col-md-12 col-xs-12 col-sm-12" *ngIf="queuesLoaded">
                                                <button type="button"
                                                    class="next-button btn btn-primary font-weight-bold text-capitalize px-9 py-4"
                                                    *ngIf="type === 'waitlistreschedule'"
                                                    [class.disableActn]="(queuejson && queuejson.length == 0 && !api_loading1) || callingModes === '' || disableButn()"
                                                    (click)="rescheduleWaitlist()">
                                                    Reschedule
                                                    <i class="fa fa-long-arrow-right mgn-lt-5"></i>
                                                </button>
                                            </div>
                                        </div>                                        
                                        <div class="clearfix"></div>
                                    </div>

                                    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog"
                                        aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog" role="document">
                                            <div class="modal-content">
                                                <div class="close-btn">
                                                    <button type="button" class="close" aria-label="Close"
                                                        data-dismiss="modal" (click)="popupClosed()">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <ng-container *ngIf="action=='members'">
                                                    <div class="modal-body">
                                                        <div
                                                            class="col-md-12 col-xs-12 col-sm-12 lnk mgn-bt-10 mgn-up-20">
                                                            <div class="pull-left"> Booking for
                                                            </div>
                                                            <a class="lnk pointer-cursoraction mgn-lt-20"
                                                                (click)="addMember()"><i class="fa fa-user-plus"></i>
                                                                {{add_member_cap}}</a>
                                                        </div>
                                                        <app-members (memberSelected)="memberSelected($event)"
                                                            [maxSelection]="maxsize" [selectedMember]="waitlist_for"
                                                            [familyMembers]="familyMembers"
                                                            [multiple]="multipleMembers_allowed" [allowSelection]="true"
                                                            [parentCustomer]="parentCustomer"></app-members>

                                                        <app-communications (setCommunications)="setCommunications"
                                                            [commObj]="commObj" [selectedService]="selectedService"
                                                            [mode]="'write'">
                                                        </app-communications>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngIf="action=='attachment'">
                                                    <div class="modal-body">
                                                        <div class="col-sm-12 col-xs-12 chk-btns-div col-md-12">
                                                            <mat-chip-list class="btns">
                                                                <mat-chip><a class="lnk action pointer-cursor"
                                                                        (click)="imagefile.click()"><input #imagefile
                                                                            type="file" accept="/*;capture=camera"
                                                                            style="display:none;" multiple
                                                                            (change)="filesSelected($event)"><i
                                                                            class="fa fa-paperclip mgn-rt-5"
                                                                            aria-hidden="true"></i>Upload
                                                                        File</a></mat-chip>
                                                            </mat-chip-list>
                                                        </div>
                                                        <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 bold pad-top-10 mgn-up-10 mgn-bt-10"
                                                            *ngIf="(selectedMessage.files && selectedMessage.files.length > 0) || (type=='waitlistreschedule' && waitlist.attchment && waitlist.attchment.length > 0)">
                                                            Uploaded Files
                                                        </div>
                                                        <div class="img-section mgn-up-20"
                                                            *ngIf="(selectedMessage.files && selectedMessage.files.length > 0) || (type=='waitlistreschedule' && waitlist.attchment && waitlist.attchment.length > 0)">
                                                            <ul class="galul">
                                                                <ng-container
                                                                    *ngIf="type=='waitlistreschedule' && waitlist.attchment && waitlist.attchment.length > 0">
                                                                    <li
                                                                        *ngFor="let file of waitlist.attchment;let i = index ">
                                                                        <div class="galimg_outer"
                                                                            *ngIf="getThumbUrl(file)">
                                                                            <div class="gal_img">
                                                                                <img [src]="getThumbUrl(file)">
                                                                            </div>
                                                                            <div class="gal-input">
                                                                                <input type="text" readonly
                                                                                    value="{{file.caption}}">
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                </ng-container>
                                                                <ng-container
                                                                    *ngIf="selectedMessage.files && selectedMessage.files.length > 0">
                                                                    <li
                                                                        *ngFor="let file of selectedMessage.files;let i = index ">
                                                                        <div class="galimg_outer">
                                                                            <div class="gal_img">
                                                                                <img [src]="getImage(selectedMessage.base64[i], file)"
                                                                                    *ngIf="selectedMessage.base64[i]">
                                                                            </div>
                                                                            <div class="gal-input">
                                                                                <input type="text" placeholder="Caption"
                                                                                    [(ngModel)]="imgCaptions[i]"
                                                                                    [ngModelOptions]="{standalone: true}">
                                                                            </div>
                                                                            <div class="gal_action"
                                                                                (click)="deleteTempImage(i)">
                                                                                <i class="fa fa-times-circle"
                                                                                    aria-hidden="true"></i>
                                                                            </div>
                                                                        </div>
                                                                    </li>
                                                                </ng-container>
                                                            </ul>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngIf="action=='coupons'">
                                                    <div class="modal-body">
                                                        <div class="col-md-12 col-xs-12 col-sm-12 lnk mgn-up-20">
                                                            Apply
                                                            Coupon Code
                                                        </div>
                                                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mgn-up-20">
                                                            <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 no-padding"
                                                                *ngIf="showCouponWB">
                                                                <div
                                                                    class="col-md-12 col-sm-12 col-lg-12 col-xs-12 form-level-settings applybill no-padding">
                                                                    <i class="icon-bell"></i>{{applied_inbilltime}}
                                                                </div>
                                                                <div class="width-60">
                                                                    <div class="input-group">
                                                                        <input [ngClass]="{'invalid':!couponvalid}"
                                                                            (keydown)="clearCouponErrors()"
                                                                            placeholder="Enter coupon code" type="text"
                                                                            class="form-control"
                                                                            [(ngModel)]="selected_coupon"
                                                                            [ngModelOptions]="{standalone: true}">
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 no-padding"
                                                                    style="color: red;" *ngIf="api_cp_error !== null">
                                                                    {{api_cp_error}}</div>
                                                                <div
                                                                    class="col-md-12 col-xs-12 col-sm-12 col-lg-12 no-padding mgn-up-10 mgn-bt-20">

                                                                </div>
                                                            </div>
                                                            <div class="col-md-12 col-sm-12 col-lg-12 col-12 mgn-up-20 mgn-bt-30 pad-up-10"
                                                                *ngIf="couponsList && couponsList.length>0">
                                                                <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 no-padding"
                                                                    *ngFor="let coupon of couponsList let i=index">
                                                                    <div
                                                                        class="col-md-12 col-sm-12 col-lg-12 col-xs-12 no-padding coupon-add-msg">
                                                                        <div
                                                                            class="col-md-5 col-sm-7 col-xs-7 col-lg-4 no-padding">
                                                                            {{coupon.couponCode}} </div>
                                                                        <div
                                                                            class="col-md-12 col-sm-5 col-xs-5 col-lg-8 delteTC">
                                                                            <span><a *ngIf="coupon.instructions"
                                                                                    (click)="toggleterms(i)"
                                                                                    class="pointer-cursor lnk read-more-checkin">Read
                                                                                    T & C </a></span>
                                                                            <span><a class="pointer-cursor lnk"><i
                                                                                        class="pointer-cursor icon-delete mgn-lt-10 lnk"
                                                                                        (click)="removeJCoupon(i)"
                                                                                        [matTooltipClass]="tooltipcls"
                                                                                        [matTooltip]="'Remove Coupon'"></i></a></span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-md-12 col-sm-12 col-lg-12 col-xs-12 mgn-up-10 pre-instr no-padding"
                                                                        *ngIf="coupon.showme">
                                                                        {{coupon.instructions}}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 coupon-outer"
                                                            *ngIf="coupon_status">
                                                            <div class="form-group">
                                                                <span *ngIf="coupon_status=='success'"
                                                                    class="coupon_success">Coupon Code(s)
                                                                    applied
                                                                    successfully</span>
                                                                <span *ngIf="coupon_status=='error'"
                                                                    class="coupon-error">Coupon
                                                                    Code(s) not
                                                                    valid</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngIf="action=='note'">
                                                    <app-booking-note (noteChanged)="handleConsumerNote($event)"
                                                        [selectedService]="selectedService"
                                                        [businessProfile]="businessjson"
                                                        [placeHolder]="note_placeholder" [note]="consumerNote">
                                                    </app-booking-note>
                                                </ng-container>
                                                <ng-container *ngIf="action=='addmember'">
                                                    <div class="modal-body">
                                                        <div class="col-md-12 col-xs-12 col-sm-12 lnk mgn-bt-10s">
                                                            <i class="fa fa-arrow-left pointer-cursor"
                                                                (click)="goBack()"></i>
                                                            {{add_member_cap}}
                                                        </div>
                                                        <div class="col-md-12 col-xs-12 col-sm-12 lnk mgn-up-20">
                                                            <app-checkin-consumer-add-member [calledFrom]="'checkin'"
                                                                (returnDetails)="handleReturnDetails($event)">
                                                            </app-checkin-consumer-add-member>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                                <div class="modal-footer">
                                                    <button type="button"
                                                        class="disp-none btn btn-light-primary font-weight-bold"
                                                        data-dismiss="modal" #closebutton>Cancel</button>
                                                    <button type="button"
                                                        class="btn btn-primary font-weight-bold hf-btn"
                                                        (click)="actionCompleted()">Ok</button>
                                                </div>
                                                <div class="error-section" *ngIf="apiError !== ''">
                                                    {{apiError}}
                                                </div>
                                                <div class="error-section success-section" *ngIf="apiSuccess !== ''">
                                                    {{apiSuccess}}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="lbl col-sm-12 col-md-12 col-lg-12 col-xs-12 col-sm-12 no-padding right-part"
                                        data-wizard-type="step-content" data-wizard-state="current"
                                        *ngIf="bookStep === 3">
                                        <div class="pad-20 quest-head">
                                            We need some more information
                                        </div>
                                        <app-questionnaire [questionnaireList]="questionnaireList"
                                            [questionAnswers]="questionAnswers" [source]="'consCheckin'"
                                            [accountId]="account_id" (returnAnswers)="getQuestionAnswers($event)">
                                        </app-questionnaire>
                                        <div class="d-flex flex-column-fluid width-100">
                                            <div class="col-xs-12 force_center note-pad">
                                                <div class="form-group card mgn-0">
                                                    <label class="col-12 quest">Add any other notes to the provider or
                                                        upload any files for provider view
                                                    </label>
                                                    <div class="col-sm-12 col-xs-12 chk-btns-div col-md-12">
                                                        <a #modal data-toggle="modal" data-target="#exampleModalCenter">
                                                        </a>
                                                        <mat-chip-list class="btns">
                                                            <mat-chip
                                                                [class.mandatoryChip]="selectedService.consumerNoteMandatory && type != 'waitlistreschedule'"
                                                                (click)="handleSideScreen('note');modal.click();">
                                                                <a class="lnk action pointer-cursor"><i
                                                                        class="fa fa-file-text-o mgn-rt-5"
                                                                        aria-hidden="true"></i>
                                                                    {{selectedService.consumerNoteTitle}}
                                                                    <span
                                                                        *ngIf="selectedService.consumerNoteMandatory">*</span></a>
                                                            </mat-chip>
                                                            <span>
                                                                <mat-chip
                                                                    [ngClass]="{'br-top-right-0 br-bottom-right-0 margin-right-0': getAttachLength() > 0}">
                                                                    <a class="lnk action pointer-cursor"
                                                                        (click)="imagefile1.click();"><input #imagefile1
                                                                            type="file" accept="/*;capture=camera"
                                                                            style="display:none;" multiple
                                                                            (change)="filesSelected($event, 'close')"><i
                                                                            class="fa fa-paperclip mgn-rt-5"
                                                                            aria-hidden="true"></i>Upload File
                                                                    </a>
                                                                </mat-chip>
                                                                <mat-chip *ngIf="getAttachLength() > 0"
                                                                    class="br-top-left-0 br-bottom-left-0 margin-left-0">
                                                                    <a class="lnk action pointer-cursor"
                                                                        (click)="viewAttachments()">
                                                                        View (<span>{{getAttachLength()}}</span>)
                                                                    </a>
                                                                </mat-chip>
                                                            </span>
                                                        </mat-chip-list>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            class=" text-center col-sm-12 col-md-12 col-lg-12 col-xs-12 col-sm-12 d-flex justify-content-between pt-10 width-100 hf-double-btn-container">
                                            <div class="mr-2">
                                                <button type="button"
                                                    class="next-button btn btn-light-primary font-weight-bold text-capitalize px-9 py-4"
                                                    (click)="goToStep('prev')">
                                                    Go Back
                                                </button>
                                            </div>
                                            <div *ngIf="!selectedService.isPrePayment">
                                                <button type="button"
                                                    class="next-button btn btn-primary font-weight-bold text-capitalize px-9 py-4"
                                                    (click)="goToStep('next');actionCompleted()">
                                                    Next
                                                </button>
                                            </div>
                                            <div *ngIf="selectedService.isPrePayment">
                                                <button type="button"
                                                    class="next-button btn btn-primary font-weight-bold text-capitalize px-9 py-4"
                                                    (click)="goToStep('next');actionCompleted()">
                                                    Proceed to Payment
                                                    <!-- Continue -->
                                                </button>
                                            </div>
                                        </div>

                                    </div>
                                    <div>
                                        <div class="lbl col-sm-12 col-md-12 col-lg-8 col-xs-12 col-sm-12 no-padding"
                                            data-wizard-type="step-content" data-wizard-state="current"
                                            *ngIf="bookStep === 4">
                                            <div *ngIf="api_loading_video" class="incomplete-msg">
                                                <div style="padding: 0 30px;">
                                                    Files are Uploading...
                                                </div>
                                            </div>
                                            <app-common-innerloading-spinner *ngIf="api_loading_video">
                                            </app-common-innerloading-spinner>
                                        </div>


                                        <div class="lbl col-sm-12 col-md-12 col-lg-12 col-xs-12 col-sm-12 p-1"
                                            data-wizard-type="step-content" data-wizard-state="current"
                                            *ngIf="bookStep === 4" [ngClass]="{'highlight': api_loading_video}">
                                            <div class="col-md-12 col-xs-12 col-sm-12 mgn-bt-10">
                                                <div class="col-md-12 col-lg-12 col-xs-12 col-sm-12 check-new-group no-padding">
                                                    <label class="question-header">Service Details</label>
                                                    <br />
                                                    <div class="service-group-section mgn-lt-10">
                                                        <div class="text-capitalize">
                                                            <div class="m-auto"
                                                                *ngIf="selectedServiceId || type == 'waitlistreschedule'">
                                                                <h6 class="text-primary service custom">
                                                                    <b>{{selectedService.name}}</b>
                                                                </h6>
                                                                <div *ngIf="queuejson && queuejson.length != 0">
                                                                    <h6
                                                                        class="font-weight-bold text-primary serv-time border-style">
                                                                        <span *ngIf="!isFutureDate"><b>Today </b></span>
                                                                        <span *ngIf="isFutureDate"><b>{{checkinDate
                                                                                | date:newDateFormat}}</b></span>
                                                                        <span><b>{{selectedQTime}}</b></span>
                                                                    </h6>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <hr />
                                                    <label class="question-header">Booking For</label>
                                                    <br />
                                                    <div class="booking-for-section mgn-lt-10">
                                                        <div class="">
                                                            <div class="col-sm-12 col-xs-12 col-md-12 no-padding">
                                                                <div class="no-padding">
                                                                    <div
                                                                        class="col-sm-12 col-xs-12 col-md-12 no-padding">
                                                                        <h5 class="text-primary service custom"
                                                                            *ngIf="waitlist_for && waitlist_for[0]">
                                                                            {{waitlist_for[0].firstName |
                                                                            capitalizeFirst}}
                                                                            {{waitlist_for[0].lastName |
                                                                            capitalizeFirst}}
                                                                            <a *ngIf="type !== 'waitlistreschedule'"
                                                                                class="pointer-cursor changeitem font-weight-bold text-capitalize px-2 py-1"
                                                                                (click)="handleSideScreen('members')"
                                                                                data-toggle="modal"
                                                                                data-target="#exampleModalCenter"><i
                                                                                    class="fa fa-pencil-square-o"
                                                                                    aria-hidden="true"></i>
                                                                            </a>
                                                                        </h5>
                                                                    </div>
                                                                    <div
                                                                        class="col-sm-12 col-xs-12 col-md-12 no-padding">
                                                                        <app-communications
                                                                            (setCommunications)="setCommunications"
                                                                            [commObj]="commObj" [mode]="'read'"
                                                                            [selectedService]="selectedService">
                                                                        </app-communications>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="clearfix"></div>
                                                    <hr *ngIf="!questionnaireList.labels"/>
                                                    <div *ngIf="!questionnaireList.labels"
                                                        class="col-sm-12 col-xs-12 chk-btns-div col-md-12 no-padding">
                                                        <a #modal data-toggle="modal"
                                                            data-target="#exampleModalCenter"></a>
                                                        <!-- <span class="text-primary">Add notes/upload files you may have</span> -->
                                                        <div>
                                                            <label class="question-header">Add notes/upload files you
                                                                may have</label>
                                                        </div>
                                                        <mat-chip-list class="btns">
                                                            <mat-chip
                                                                [class.mandatoryChip]="selectedService.consumerNoteMandatory && type != 'waitlistreschedule'"
                                                                (click)="handleSideScreen('note');modal.click();">
                                                                <a class="lnk action pointer-cursor"><i
                                                                        class="fa fa-file-text-o mgn-rt-5"
                                                                        aria-hidden="true"></i>{{selectedService.consumerNoteTitle}}
                                                                    <span
                                                                        *ngIf="selectedService.consumerNoteMandatory && type != 'waitlistreschedule'">*</span></a>
                                                            </mat-chip>
                                                            <span>
                                                                <mat-chip
                                                                    [ngClass]="{'br-top-right-0 br-bottom-right-0 margin-right-0': getAttachLength() > 0}">
                                                                    <a class="lnk action pointer-cursor"
                                                                        (click)="imagefile1.click();"><input #imagefile1
                                                                            type="file" accept="/*;capture=camera"
                                                                            style="display:none;" multiple
                                                                            (change)="filesSelected($event, 'close')"><i
                                                                            class="fa fa-paperclip mgn-rt-5"
                                                                            aria-hidden="true"></i>Upload File
                                                                    </a>
                                                                </mat-chip>
                                                                <mat-chip *ngIf="getAttachLength() > 0"
                                                                    class="br-top-left-0 br-bottom-left-0 margin-left-0">
                                                                    <a class="lnk action pointer-cursor"
                                                                        (click)="viewAttachments()">
                                                                        View (<span>{{getAttachLength()}}</span>)
                                                                    </a>
                                                                </mat-chip>
                                                            </span>
                                                        </mat-chip-list>
                                                    </div>
                                                    <div class="clearfix"></div>
                                                    <div
                                                        class="coupon-section col-md-12 col-xs-12 col-sm-12 no-padding">
                                                        <div class="col-md-12 col-xs-12 col-sm-12 lnk mgn-up-5 no-padding"
                                                            *ngIf="(s3CouponsList.JC.length > 0) && type != 'waitlistreschedule' || (s3CouponsList.OWN.length > 0) && type != 'waitlistreschedule'">
                                                            <a class="lnk pointer-cursor action"
                                                                *ngIf="selected_coupons.length === 0"
                                                                (click)="applyPromocode()" data-toggle="modal"
                                                                data-target="#exampleModalCenter">Apply
                                                                Coupon Code</a>
                                                            <a class="lnk pointer-cursor action"
                                                                *ngIf="selected_coupons.length > 0"
                                                                (click)="applyPromocode()" data-toggle="modal"
                                                                data-target="#exampleModalCenter">
                                                                Coupon code added</a>
                                                            {{selected_coupons.toString()}}
                                                        </div>
                                                        <div *ngFor="let coupon of paymentDetails.jCouponList | keyvalue"
                                                            style="text-align: initial;">
                                                            <small class="black rupee-font"
                                                                *ngIf="coupon.value.value !== '0.0'">You
                                                                saved
                                                                {{coupon.value.value | currency:'&#8377;'}}
                                                                on
                                                                {{coupon.key}}
                                                            </small>
                                                            <small class="black"
                                                                *ngIf="coupon.value.value === '0.0'">{{coupon.key}}
                                                                will be honored if all the rules are met
                                                                &nbsp;<small *ngIf="coupon.value.value === '0.0'"
                                                                    class="blue custId-cursor"
                                                                    (click)="showJCCouponNote(coupon)"
                                                                    aria-hidden="true">Know
                                                                    more</small></small>
                                                        </div>
                                                        <div
                                                            *ngFor="let coupon of paymentDetails.proCouponList | keyvalue">
                                                            <small class="black rupee-font"
                                                                *ngIf="coupon.value.value !== '0.0'">You saved
                                                                {{coupon.value.value | currency:'&#8377;'}}
                                                                on {{coupon.key}}
                                                            </small>
                                                            <small class="black"
                                                                *ngIf="coupon.value.value === '0.0'">{{coupon.key}}
                                                                will be honored if all the rules are met
                                                                &nbsp;<small *ngIf="coupon.value.value === '0.0'"
                                                                    class="blue custId-cursor"
                                                                    (click)="showJCCouponNote(coupon)"
                                                                    aria-hidden="true">Know
                                                                    more</small></small>
                                                        </div>
                                                    </div>
                                                    <div class="clearfix"></div>
                                                    <hr  />
                                                    <hr
                                                    *ngIf="(s3CouponsList.JC.length > 0) && type != 'waitlistreschedule'||(s3CouponsList.OWN.length > 0) && type != 'waitlistreschedule'" />
                            <label class="question-header" *ngIf="type != 'waitlistreschedule' && paymentLength>0 && paymentDetails">Payment
                                Details</label><br />
                                                    <div class="payment-section-details mgn-lt-10"
                                                        *ngIf="selectedService && selectedService.isPrePayment">
                                                        <div>
                                                            <div class="web">
                                                                <div class="text-left"
                                                                    *ngIf="paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0">
                                                                    <span *ngIf="paymentDetails.showPrice"
                                                                        class="ser_price no-mgn-bt bold mgn-rt-10">Service
                                                                        Price :ss
                                                                        <span
                                                                            class="ser_price no-mgn-bt bold rupee-font">{{paymentDetails.netTotal
                                                                            | currency:'&#8377;'}}</span></span>
                                                                    <span class="ser_price no-mgn-bt bold">Payment
                                                                        required now :
                                                                        <span
                                                                            class="ser_price no-mgn-bt bold rupee-font">{{(checkJcash
                                                                            ? payAmount :
                                                                            paymentDetails.amountRequiredNow)|
                                                                            currency:'&#8377;'}}</span></span>
                                                                </div>
                                                            </div>
                                                            <div class="disply">
                                                                <div class="text-left"
                                                                    *ngIf="paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0 && ((checkJcash && jcashamount < paymentDetails.amountRequiredNow) || (!checkJcash))">
                                                                    <span *ngIf="paymentDetails.showPrice"
                                                                        class="ser_price no-mgn-bt bold mgn-rt-10">Service
                                                                        Price :bgg
                                                                        <span
                                                                            class="ser_price no-mgn-bt bold rupee-font">{{paymentDetails.netTotal
                                                                            | currency:'&#8377;'}}</span></span>
                                                                    <span class="ser_price no-mgn-bt bold">Payment
                                                                        required now :
                                                                        <span
                                                                            class="ser_price no-mgn-bt bold rupee-font">{{(checkJcash
                                                                            ? payAmount :
                                                                            paymentDetails.amountRequiredNow)|
                                                                            currency:'&#8377;'}}</span></span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div
                                                            *ngIf="selectedService && selectedService.isPrePayment && paymentLength>0 && paymentDetails.amountRequiredNow > 0">
                                                            <div class="jaldeecredit" *ngIf="jcashamount>0">
                                                                <mat-checkbox [(ngModel)]="checkJcash"
                                                                    (change)="changeJcashUse($event)">
                                                                </mat-checkbox>
                                                                Use Jaldee cash balance : <span
                                                                    class="rupee-font">{{jcashamount|
                                                                    currency:'&#8377;'}}</span>
                                                            </div>
                                                            <div class="creditleft"
                                                                *ngIf="jcashamount>0  && (checkJcash && jcashamount < paymentDetails.amountRequiredNow)">
                                                                Balance amount can be paid by other payment methods
                                                            </div>
                                                            <div class="prepayment"
                                                                *ngIf="paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0 && 
                                        ((checkJcash && jcashamount > paymentDetails.amountRequiredNow) || (checkJcash && jcashamount == paymentDetails.amountRequiredNow))">
                                                                <button type="button" [class.disabled]="isClickedOnce"
                                                                    (click)="!isClickedOnce && confirmcheckin('checkin')"
                                                                    id="stepThreeConfirmButton"
                                                                    class="next-button btn btn-primary font-weight-bold  px-12 py-4"
                                                                    [disabled]="!checkPolicy && heartfulnessAccount">
                                                                    <ng-container
                                                                        *ngIf="paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0 && 
                                                ((checkJcash && jcashamount > paymentDetails.amountRequiredNow) || (checkJcash && jcashamount == paymentDetails.amountRequiredNow))">
                                                                        Confirm
                                                                    </ng-container>
                                                                </button>
                                                            </div>
                                                            <hr />
                                                            <div class="resPaymrntDetails"
                                                                *ngIf="paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0">
                                                                <label class="custom resPaymrntDetails">Select Payment
                                                                    Mode</label>
                                                            </div>
                                                            <div class="clearfix"></div>
                                                            <div class="text-center mx-auto no-padding"
                                                                *ngIf=" isPayment&& paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0 && ((checkJcash && jcashamount < paymentDetails.amountRequiredNow) || (!checkJcash))">
                                                                <ng-container *ngIf="!shownonIndianModes"
                                                                    class="text-center mx-auto">
                                                                    <app-payment-modes
                                                                        [paymentModes]="indian_payment_modes"
                                                                        (modeSelected)="indian_payment_mode_onchange($event)">
                                                                    </app-payment-modes>
                                                                </ng-container>
                                                                <ng-container *ngIf="shownonIndianModes"
                                                                    class="text-center mx-auto">
                                                                    <app-payment-modes [paymentModes]="non_indian_modes"
                                                                        (modeSelected)="non_indian_modes_onchange($event)">
                                                                    </app-payment-modes>
                                                                </ng-container>
                                                            </div>
                                                            <div class="clearfix"></div>
                                                            <div class="mgn-up-20 col-md-12 col-xs-12 no-padding">
                                                                <div class="col-md-12 txt-align-center pad_link question-header"
                                                                    *ngIf="paymentmodes && paymentmodes.internationalPay && paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0 && ((checkJcash && jcashamount < paymentDetails.amountRequiredNow) || (!checkJcash))">
                                                                    <span [class.disabled]="paymentBtnDisabled"
                                                                        (click)="togglepaymentMode()"
                                                                        class="pointer-cursor">
                                                                        <a class="refund_policy">
                                                                            <span
                                                                                *ngIf="!shownonIndianModes && paymentmodes && paymentmodes.internationalPay">Non
                                                                                Indian Payment ? Click
                                                                                here</span>
                                                                            <span
                                                                                *ngIf="shownonIndianModes && paymentmodes && paymentmodes.indiaPay">Indian
                                                                                Payment ? Click
                                                                                here</span>
                                                                        </a>
                                                                    </span>
                                                                </div>
                                                                <div class="clearfix"></div>
                                                                <div class="col-md-12 cancelpolicy  mgn-rt-5"
                                                                    *ngIf="paymentDetails && paymentDetails.amountRequiredNow > 0">
                                                                    <div class="pad_policy"
                                                                        *ngIf="paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0">
                                                                        <a data-toggle="modal"
                                                                            data-target="#exampleModal"
                                                                            class="refund_policy">Cancellation
                                                                            Policy</a>
                                                                    </div>
                                                                </div>
                                                                <div class="col-md-12 txt-align-center">
                                                                    <button type="button"
                                                                        class=" next-button btn btn-primary font-weight-bold text-capitalize "
                                                                        [class.disabled]="paymentBtnDisabled"
                                                                        *ngIf=" isPayment&& paymentLength>0 && paymentDetails && paymentDetails.amountRequiredNow > 0 && ((checkJcash && jcashamount < paymentDetails.amountRequiredNow) || (!checkJcash))"
                                                                        (click)="!isClickedOnce && confirmcheckin('checkin')">
                                                                        Make Payment
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <!-- modalbox -->
                                                            <div class="modal fade" id="exampleModal" tabindex="-1"
                                                                role="dialog" aria-labelledby="exampleModalLabel"
                                                                aria-hidden="true">
                                                                <app-refundpolicy></app-refundpolicy>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="clearfix"></div>
                                                <hr>
                                            </div>
                                            <div class="clearfix"></div>
                                            <div class="text-center"
                                                *ngIf="selectedService && selectedService.isPrePayment==false && paymentLength==0|| (paymentDetails && paymentDetails.amountRequiredNow == 0)">
                                                <!-- <div class="prepayment-confirm"> -->
                                                <button type="button" [class.disabled]="isClickedOnce"
                                                    (click)="!isClickedOnce && confirmcheckin('checkin')"
                                                    id="stepThreeConfirmButton"
                                                    class="next-button btn btn-primary font-weight-bold  px-12 py-4"
                                                    [disabled]="!checkPolicy && heartfulnessAccount">
                                                    Confirm
                                                </button>
                                                <!-- </div> -->
                                            </div>
                                            <ng-container *ngIf="heartfulnessAccount">
                                                <app-privacy (approvePolicy)="policyApproved($event)"></app-privacy>
                                            </ng-container>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>