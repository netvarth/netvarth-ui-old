<div class="mt-5" *ngIf="apiloading">
  <app-skeleton-loading></app-skeleton-loading>
</div>


<div *ngIf="desktopView && !apiloading">
  <div class="container card">
    <div>
      <div class="pointer-cursor">
        <i class="fa fa-arrow-left" (click)="goBack()"></i>&nbsp;&nbsp;<span class="font-weight-bold text-primary">Go
          Back</span>
      </div>
    </div>
  </div>
  <div class="container card shadow">
    <div>
      <div class="">
        <div class="d-flex justify-content-center">
          <div>
            <img *ngIf="business && business.logo" src="{{business.logo}}" width="100" height="100"
              class="rounded-circle">
          </div>
          <div class="pl-3 pt-4">
            <h4 *ngIf=" business && business.bname" class="business-name">{{business.bname}}</h4>
            <span *ngIf="business && business.blocation" class="business-location"><i
                class="fa fa-map-marker"></i>&nbsp;&nbsp;{{business.blocation}}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <br>
  <div class="container">
    <div class="row">
      <div class="col-md-7 col-sm-12 px-0">
        <div class="card items-card">
          <div class="card-body">
            <div class="row">
              <div class="form-group col-md-12 col-sm-12 no-padding-small">
                <input class="form-control" [(ngModel)]="seacrchFilterOrder" type="search" class="form-control"
                  placeholder="Search for Items" [matAutocomplete]="autoprov"
                  (ngModelChange)="transform(seacrchFilterOrder)" (focus)="myMethod(seacrchFilterOrder)" />
                <mat-autocomplete #autoprov="matAutocomplete" class="matAutocomplete">
                  <mat-option *ngFor="let option of catalogItems"
                    (click)="handleSearchSelect(option,seacrchFilterOrder)" [value]="option.item.displayName">
                    <div class="flexClass" style="justify-content: space-between;">
                      <div class="flexClass">
                        <div>{{option.item.displayName | capitalizeFirst}}</div>
                      </div>
                    </div>
                  </mat-option>
                </mat-autocomplete>
              </div>
            </div>
            <h4 class="card-title" *ngIf="catalog && catalog.catalogName" class="catalog-name">
              {{this.catalog.catalogName}}</h4>
            <!-- <h6 class="card-title" *ngIf="catalog && catalog.catalogName" class="catalog-count">
                          {{this.catalog.catalogItem.length}} Items</h6> -->
            <h6 class="card-title" class="catalog-count" *ngIf="catalogItems && catalogItems.length">
              {{catalogItems.length}} Items</h6>
              <div class="card item-card shadow-lg mt-3" *ngIf="catalogItems && catalogItems.length===0">
                <h4>Sorry item not found</h4>
              </div>
            <div *ngIf="catalogItems">
              <div *ngFor="let item of catalogItems;let i=index">
                <div class="card item-card shadow-lg mt-3">
                  <div class="d-flex justify-content-between">
                    <div class="d-flex">
                      <div class="mr-2">
                        <i class="fa fa-circle veg-icon" aria-hidden="true"></i>
                      </div>
                      <div class="pt-1">
                        <span class="font-weight-bold item-name"
                          *ngIf="item.item && item.item.displayName">{{item.item.displayName}}</span><br>
                        <span class="text-red item-name"
                          *ngIf="item.item && item.item.price && !item.item.showPromotionalPrice"><i
                            class="fa fa-inr"></i>&nbsp;{{item.item.price}}</span>
                        <span class="text-red item-price"
                          *ngIf="item.item && item.item.price && item.item.showPromotionalPrice"><s><i
                              class="fa fa-inr"></i>&nbsp;{{item.item.price}}</s>&nbsp;<i
                            class="fa fa-inr"></i>&nbsp;{{item.item.promotionalPrice}}</span><br>
                        <span class="text-light item-desc"
                          *ngIf="item.item && item.item.shortDesc">{{item.item.shortDesc}}</span>
                        <div *ngIf="getItemQty(item)>0">
                          <span class="add_nte" (click)="addNotes(item,i)">
                            {{item.consumerNote ? 'Edit Note':'Add Note'}}
                          </span> &nbsp;
                          <span [matTooltip]="'Delete'" (click)="deleteNotes(item,i)">
                            <i *ngIf="item.consumerNote" class="fa fa-trash"></i>
                          </span>
                        </div>
                      </div>
                    </div>
                    <div class="cart">
                      <div>
                        <img
                          *ngIf="item.item && item.item.itemImages && item.item.itemImages[0] && item.item.itemImages[0].thumbUrl"
                          src="{{item.item.itemImages[0].thumbUrl}}" class="item-image" width="70" height="70">
                        <img
                          *ngIf="!item.item || !item.item.itemImages || !item.item.itemImages[0] || !item.item.itemImages[0].thumbUrl"
                          src="../../../../assets/images/order/Items.svg" class="item-image" width="70" height="70">
                      </div>

                      <div class="cart-btn mt-1 ">
                        <div *ngIf=" getItemQty(item)===0" (click)="increment(item)"
                          class="cusr-pointer add-qty pointer-cursor text-center">Add&nbsp;+&nbsp;
                        </div>
                        <div *ngIf="getItemQty(item) >= 1" class=" d-flex justify-content-between">
                          <div (click)="decrement(item)"
                            class="item-pad bodr-lft bodr-btm-up item-qty pointer-cursor item-padding">-
                          </div>
                          <div class="item-pad bodr-btm-up item-qty">
                            {{getItemQty(item)}}
                          </div>
                          <div class="cusr-pointer add-qty pointer-cursor item-padding"
                            [class.pointer-none]="getItemQty(item) >= item.maxqty"
                            [class.shaded]="getItemQty(item) >= item.maxqty" (click)="increment(item)">+
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-5 col-sm-12 pr-0 no-padding-small" *ngIf="catalogItems && catalogItems.length !==0">
        <div class="card checkout-card p-0">
          <div class="card-body cart-heading" *ngIf="action!='timeChange'">
            <span><i class="fa fa-shopping-cart" aria-hidden="true"></i>&nbsp;&nbsp;Cart</span>
          </div>
          <hr class="my-0 py-0">
          <div class="card-body cart-heading" *ngIf="action=='timeChange'">
            <div *ngIf="choose_type === 'store'">
              <span><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;&nbsp;Store Pickup Details</span>
            </div>
            <div *ngIf="choose_type === 'home'">
              <span><i class="fa fa-info-circle" aria-hidden="true"></i>&nbsp;&nbsp;Home Delivery Details</span>
            </div>
          </div>
          <div *ngIf="action!='timeChange'">
            <div *ngFor="let item of catalogItems; let i=index">
              <div class=" card item-card mt-2" *ngIf="getItemQty(item) > 0">
                <div class="d-flex justify-content-between">
                  <div>
                    <span class="font-weight-bold item-name"
                      *ngIf="item.item && item.item.displayName">{{item.item.displayName}}</span><br>
                    <span class="text-light item-desc"
                      *ngIf="item.item && item.item.shortDesc">{{item.item.shortDesc}}</span>
                  </div>
                  <div class="cart">
                    <span class="text-red item-price"
                      *ngIf="item.item && item.item.price && !item.item.showPromotionalPrice"><i
                        class="fa fa-inr"></i>&nbsp;{{item.item.price}}</span>
                    <span class="text-red item-price"
                      *ngIf="item.item && item.item.price && item.item.showPromotionalPrice">&nbsp;<i
                        class="fa fa-inr"></i>&nbsp;{{item.item.promotionalPrice}}</span><br>

                    <div class="cart-btn pr-2">
                      <div *ngIf=" getItemQty(item)===0" (click)="increment(item)"
                        class="cusr-pointer add-qty pointer-cursor text-center">
                        Add&nbsp;+&nbsp;
                      </div>
                      <div *ngIf="getItemQty(item) >= 1" class=" d-flex justify-content-between">
                        <div (click)="decrement(item)"
                          class="item-pad bodr-lft bodr-btm-up item-qty pointer-cursor item-padding">-
                        </div>
                        <div class="item-pad bodr-btm-up item-qty">
                          {{getItemQty(item)}}
                        </div>
                        <div (click)="increment(item)" class="cusr-pointer add-qty pointer-cursor item-padding"
                          [class.pointer-none]="getItemQty(item) >= item.maxqty"
                          [class.shaded]="getItemQty(item) >= item.maxqty">+
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12 col-xs-12 bdr-bt-grey"
            *ngIf="orderList && orderList.length>0 && isPhysicalItemsPresent() && action!='timeChange'">
            <div class="clearfix"></div>
          </div>
          <div class="mx-auto text-center my-3" *ngIf="orderList && orderList.length==0">
            <img src="../../../../assets/images/order/empty_cart.png" class="item-image" width="200"><br><br>
            <span class="mt-5 text-grey font-weight-bold">Your Cart is Empty</span><br>
            <span class="text-blue small-font">Looks like you haven't added anything to your cart yet.<br>Go ahead &
              explore categories.</span><br>
          </div>
          <div class="m-auto text-center">
            <a class="btn btn-lg btn-primary checkout-btn" (click)="confirmOrder()"
              [class.disabled]="orderList && orderList.length==0 ||!isfutureAvailableTime">Checkout</a>
          </div>
        </div>
      </div>
    </div><br>
    <div class="row">
      <div class="col-md-7 no-padding">
        <div class="card shadow-lg">
          <div class="d-flex justify-content-between">
            <div>
              <span class="text-dark font-weight-bold">Need our help?</span><br>
              <span class="text-light query-text">Call us in case of you face any issues in our service bookings</span>
            </div>
            <div *ngIf="businessPhoneNumber">
              <a class="btn btn-primary help-btn">Call {{businessPhoneNumber}}</a>
            </div>
          </div>
        </div>
      </div>
    </div><br><br><br>
  </div>
</div>








<!-- Mobile View -->






<div *ngIf="mobileView && !apiloading">
  <div class="container card">
    <div class="d-flex">
      <div class="pointer-cursor pl-3">
        <i class="fa fa-angle-left left-angle" (click)="goBack()"></i>
      </div>
      <div class="m-auto">
        <h4 *ngIf=" business && business.bname" class="business-name-mobile">{{business.bname}}</h4>
        <span *ngIf="business && business.blocation" class="business-location-mobile"><i
            class="fa fa-map-marker"></i>&nbsp;&nbsp;{{business.blocation}}</span>
      </div>
    </div>
  </div>

  <!-- <div class="clearfix"></div> -->

  <!-- <br> -->
  <!-- <div class="row">
    <div class="form-group no-padding-small">
      <input class="form-control" [(ngModel)]="seacrchFilterOrder" type="search" class="form-control"
        placeholder="Search for Items" [matAutocomplete]="autoprov" (ngModelChange)="transform(seacrchFilterOrder)" />
      <mat-autocomplete #autoprov="matAutocomplete" class="matAutocomplete">
        <mat-option *ngFor="let option of catalogItems" (click)="handleSearchSelect(option,seacrchFilterOrder)"
          [value]="option.item.displayName">
          <div class="flexClass" style="justify-content: space-between;">
            <div class="flexClass">
              <div>{{option.item.displayName | capitalizeFirst}}</div>
            </div>
          </div>
        </mat-option>
      </mat-autocomplete>
    </div>
  </div> -->
  <div class="card item-card shadow-lg mt-3">
    <div >
      <input  class="form-control" 
        [(ngModel)]="seacrchFilterOrder" type="search" class="form-control" placeholder="Search for Items" [matAutocomplete]="autoprov"
        (ngModelChange)="transform(seacrchFilterOrder)"/>
        <mat-autocomplete #autoprov="matAutocomplete" class="matAutocomplete">
          <mat-option *ngFor="let option of catalogItems" (click)="handleSearchSelect(option,seacrchFilterOrder)" 
          [value]="option.item.displayName">
            <div class="flexClass" style="justify-content: space-between;">
              <div class="flexClass">
                  <div>{{option.item.displayName  | capitalizeFirst}}</div>
                </div>
            </div>
          </mat-option>
        </mat-autocomplete>
    </div>
    <h4 class="card-title catalog-name mt-3" *ngIf="catalog && catalog.catalogName" >
      {{this.catalog.catalogName}}</h4>
      <h6 class="card-title catalog-count"  *ngIf="catalogItems && catalogItems.length">
        {{catalogItems.length}} Items</h6>
  </div>
  <div class="card item-card shadow-lg mt-3" *ngIf="catalogItems && catalogItems.length===0">
    <h4>Sorry item not found</h4>
  </div>


  <div>
    <div *ngIf="catalogItems">
      <div *ngFor="let item of catalogItems;let i=index">
        <div class="card item-card shadow-lg mt-3">
          <div class="d-flex justify-content-between">
            <div class="d-flex">
              <div class="cart">
                <div>
                  <img
                    *ngIf="item.item && item.item.itemImages && item.item.itemImages[0] && item.item.itemImages[0].thumbUrl"
                    src="{{item.item.itemImages[0].thumbUrl}}" class="item-image-mobile" width="100" height="100">
                  <img
                    *ngIf="!item.item || !item.item.itemImages || !item.item.itemImages[0] || !item.item.itemImages[0].thumbUrl"
                    src="../../../../assets/images/order/Items.svg" class="item-image-mobile" width="100" height="100">
                </div>
              </div>

              <div class="ml-3">
                <span class="font-weight-bold item-name-mobile"
                  *ngIf="item.item && item.item.displayName">{{item.item.displayName}}</span><br>
                <span class="text-red item-name-mobile"
                  *ngIf="item.item && item.item.price && !item.item.showPromotionalPrice"><i
                    class="fa fa-inr"></i>&nbsp;{{item.item.price}}</span>
                <span class="text-red item-price-mobile"
                  *ngIf="item.item && item.item.price && item.item.showPromotionalPrice"><s><i
                      class="fa fa-inr"></i>&nbsp;{{item.item.price}}</s>&nbsp;<i
                    class="fa fa-inr"></i>&nbsp;{{item.item.promotionalPrice}}</span><br>
                <span class="text-light item-desc-mobile"
                  *ngIf="item.item && item.item.shortDesc">{{item.item.shortDesc}}</span>
                <div *ngIf="getItemQty(item)>0">
                  <span class="add_nte" (click)="addNotes(item,i)">
                    {{item.consumerNote ? 'Edit Note':'Add Note'}}
                  </span> &nbsp;
                  <span [matTooltip]="'Delete'" (click)="deleteNotes(item,i)">
                    <i *ngIf="item.consumerNote" class="fa fa-trash"></i>
                  </span>
                </div>
              </div>
            </div>
            <div class="d-flex">
              <div class="cart-btn-mobile">
                <div *ngIf=" getItemQty(item)===0" (click)="increment(item)"
                  class="cusr-pointer add-qty-mobile pointer-cursor text-center">
                  Add&nbsp;+&nbsp;
                </div>
                <div *ngIf="getItemQty(item) >= 1" class=" d-flex justify-content-between">
                  <div (click)="decrement(item)"
                    class="item-pad bodr-lft bodr-btm-up item-qty pointer-cursor item-padding">
                    -
                  </div>
                  <div class="item-pad bodr-btm-up item-qty">
                    {{getItemQty(item)}}
                  </div>
                  <div class="cusr-pointer item-qty pointer-cursor item-padding"
                    [class.pointer-none]="getItemQty(item) >= item.maxqty"
                    [class.shaded]="getItemQty(item) >= item.maxqty" (click)="increment(item)">+
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div><br>
  <div *ngIf="catalogItems && catalogItems.length !==0">
    <div class="m-auto text-center">
      <a class="btn btn-primary checkout-btn-mobile" (click)="confirmOrder()"
        [class.disabled]="!isfutureAvailableTime || (orderList && orderList.length==0) || !orderList">Checkout</a>
    </div>
  </div>
</div>
