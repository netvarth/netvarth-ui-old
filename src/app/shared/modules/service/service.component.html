<div class="col-md-12 no-padding-small" *ngIf="showService">
  <div class="cl1" *ngIf="action=='show'">
    <span class="editbt" [class.serv-disabled-icn]="!is_virtual_enable && service.serviceType === 'virtualService'"
      (click)="(is_virtual_enable || service.serviceType !== 'virtualService') && editService()"
      [matTooltip]="(!is_virtual_enable && service.serviceType === 'virtualService') ? 'Please turn on Teleservice in settings' : ''"></span>
    <div class="ot-it">
      <h4>
        <i *ngIf="service_data.serviceType === 'virtualService' && service_data.virtualCallingModes[0].callingMode === 'GoogleMeet'"
          class="fa meet-icon"></i>
        <i *ngIf="service_data.serviceType === 'virtualService' && service_data.virtualCallingModes[0].callingMode === 'Zoom'"
          class="fa zoom-icon"></i>
        <i *ngIf="service_data.serviceType === 'virtualService' && service_data.virtualCallingModes[0].callingMode === 'Phone'"
          class="fa phon-icon"></i>
        <i *ngIf="service_data.serviceType === 'virtualService' && service_data.virtualCallingModes[0].callingMode === 'WhatsApp' && service_data.virtualServiceType === 'audioService'"
          class="fa wtsapaud-icon"></i>
        <i *ngIf="service_data.serviceType === 'virtualService' && service_data.virtualCallingModes[0].callingMode === 'WhatsApp' && service_data.virtualServiceType === 'videoService'"
          class="fa wtsapvid-icon"></i>
        <i *ngIf="service_data.serviceType === 'virtualService' && service_data.virtualCallingModes[0].callingMode === 'VideoCall'"
          class="fa jvideo-icon jvideo-icon-s jvideo-icon-mgm5"></i>
        {{service_data.name | capitalizeFirst}}
        <span *ngIf="service.provider && !userId ">({{service.provider.firstName}})</span>
      </h4>
      <div class="it-des">
        {{service_data.description | capitalizeFirst}}
      </div>

      <div class="c-ot">
        <div class="item" *ngIf="!is_donation && showResources">
          <span class="ttle">Number of resources</span>
          <span> {{service_data.resoucesRequired}}
          </span>
        </div>
        <div class="item" *ngIf="!is_donation && showResources">
          <span class="ttle">Maximum bookings</span>
          <span> {{service_data.maxBookingsAllowed}}
          </span>
        </div>
        <div class="item" *ngIf="filterDepart && departmentName && !is_donation">
          <span class="ttle">Department Name</span>
          <span>{{departmentName}}</span>
        </div>
        <div class="item" *ngIf="subdomainsettings.serviceBillable && !is_donation">
          <span class="ttle">{{est_duration_cap}}</span>
          <span class="icon-time"> {{getAppxTime(service_data.serviceDuration)}}
          </span>
        </div>
        <div class="item" *ngIf="service_data.totalAmount!=0">
          <span class="ttle">{{price_cap}}</span>
          <span class="rupee-font">{{service_data.totalAmount | currency:'INR':'symbol':'.2-2'}}</span>
        </div>
        <div class="item" *ngIf="service_data.isPrePayment">
          <span class="ttle">{{pre_pay_amt}}</span>
          <span class="rupee-font" *ngIf="service_data && service_data.prePaymentType === 'fixed'">{{service_data.minPrePaymentAmount | currency:'INR':'symbol':'.2-2'}}</span>
          <span class="rupee-font" *ngIf="service_data && service_data.prePaymentType === 'percentage'">{{service_data.minPrePaymentAmount}}{{percentage_symbol}} of Service Price</span>
        </div>
        <div class="item" *ngIf="service_data.serviceType && !is_donation">
          <span class="ttle">Service Type</span>
          <span *ngIf="service_data.serviceType==='virtualService'">Teleservice</span>
          <span *ngIf="service_data.serviceType==='physicalService'">Onsite Service</span>
        </div>
        <div class="item" *ngIf="service_data.virtualServiceType">
          <span class="ttle">Service Mode</span>
          <span *ngIf="service_data.virtualServiceType === 'audioService'">Audio</span>
          <span *ngIf="service_data.virtualServiceType === 'videoService'">Video</span>
        </div>
      </div>
      <div class="c-ot" *ngIf="service_data.virtualServiceType">
        <div class="item">
          <span class="ttle">Tele Mode</span>
          <span>{{service_data.virtualCallingModes[0].callingMode}}</span>
        </div>
        <div class="item">
          <span *ngIf="service_data.virtualCallingModes[0].callingMode === 'WhatsApp'" class=" ttle">WhatsApp Number
          </span>
          <span *ngIf="service_data.virtualCallingModes[0].callingMode === 'Zoom'" class=" ttle">Zoom ID
          </span>
          <span *ngIf="service_data.virtualCallingModes[0].callingMode === 'GoogleMeet'" class=" ttle">Google Meet
            ID</span>
          <span *ngIf="service_data.virtualCallingModes[0].callingMode === 'Phone'" class=" ttle">Phone Number
          </span>
          <span
            *ngIf="service_data.virtualCallingModes[0].callingMode === 'Phone' || service_data.virtualCallingModes[0].callingMode === 'WhatsApp'">
            {{(service_data.virtualCallingModes[0].countryCode) ? service_data.virtualCallingModes[0].countryCode : +91
            }}</span>&nbsp;
          <span>{{service_data.virtualCallingModes[0].value}}</span>
        </div>

      </div>
      <div class="c-ot" *ngIf="is_donation">
        <div class="item" *ngIf="service_data.minDonationAmount">
          <span class="ttle">Min Amount</span>
          <span class="rupee-font">{{service_data.minDonationAmount |
            currency:'&#8377;'}}</span>
        </div>
        <div class="item" *ngIf="service_data.maxDonationAmount">
          <span class="ttle">Max Amount</span>
          <span class="rupee-font">{{service_data.maxDonationAmount |
            currency:'&#8377;'}}</span>
        </div>
        <div class="item" *ngIf="service_data.multiples">
          <span class="ttle">Multiples</span>
          <span>{{service_data.multiples}}</span>
        </div>
      </div>
      <div class="item" *ngIf="service.serviceType !== 'virtualService' && is_lvtrack_enable && service_data.livetrack">
        <span class="ttle">Live tracking </span>
        <span>{{(service_data.livetrack ? 'On': 'Off')}}</span>
      </div>

      <div class="c-ot" *ngIf="service_data.questionnaireIds && service_data.questionnaireIds.length > 0">
        <div class="item width-100">
          <span>{{service_data.questionnaireIds.length}} questionnaire added </span>
          <a *ngFor="let id of service_data.questionnaireIds;let i=index" (click)="gotoQnr(id)">{{getQnrName(id)}}
            <ng-container *ngIf="i < (service_data.questionnaireIds.length - 1)">, </ng-container>
          </a>
        </div>
      </div>

      <span class="setings" *ngIf="service.status=='ACTIVE'">Share link</span>
      <p *ngIf="service.status=='ACTIVE'">
        <span *ngIf="service && service.provider && service.provider.id">
          <span class='assured'
            *ngIf="bprofile.accEncUid">{{wndw_path}}{{bprofile.accEncUid}}/{{service.provider.id}}/service/{{service.id}}</span>
          <span class='assured'
            *ngIf="bprofile.customId">{{wndw_path}}{{bprofile.customId}}/{{service.provider.id}}/service/{{service.id}}</span>
        </span>

        <span *ngIf="service && !service.provider">
          <span class='assured'
            *ngIf="bprofile.accEncUid && bprofile.customId">{{wndw_path}}{{bprofile.customId}}/service/{{service.id}}</span>
          <span class='assured'
            *ngIf="bprofile.accEncUid && !bprofile.customId">{{wndw_path}}{{bprofile.accEncUid}}/service/{{service.id}}</span>
        </span>
      </p>
      <p>
        <span class="custid" *ngIf="service.status=='ACTIVE'">
          <i class="fa fa-qrcode custId-cursor  font-lrge" (click)="serviceqrCodegeneraterOnlineID()"
            [matTooltip]="'QR code'"></i>
        </span>
        <span class="custid" *ngIf="service.status=='ACTIVE'">
          <i class="fa fa-copy custId-cursor pad-left-20 font-lrge" (click)="copyInputMessage()"
            [matTooltip]="'Copy link'"></i>
        </span>
        <span class="custid" *ngIf="service.status=='ACTIVE'">
          <i class="fa fa-share-alt custId-cursor pad-left-20 font-lrge" (click)="serviceqrCodegeneraterOnlineID()"
            [matTooltip]="'Share link'"></i>
        </span>
      </p>
      <div *ngIf="service.paymentProfileId && action==='show'">
        <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12 mgn-bt-10 no-padding ">Payment Profile Selected for this
          service is: <b>{{selectedPaymentProfile[0].displayName}}</b></div>
        <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12 no-padding ">
          <app-payment-mode [paymentProfile]="selectedPaymentProfile[0]"></app-payment-mode>
        </div>
      </div>
     
      <div class="btm-ctrl">
        <div class="ctrl enable-disable">
          <span *ngIf="!is_donation" class="ttle">{{serv_status}}</span>
          <span *ngIf="is_donation" class="ttle">Cause Status</span>
          <span>
            <mat-slide-toggle [checked]="service_data.status=='ACTIVE'" [(ngModel)]="servstatus"
              (change)="changeServiceStatus(service_data)"></mat-slide-toggle>
          </span>
          <span class='enabled' *ngIf="service_data.status=='ACTIVE'">{{enable_cap}}</span>
          <span class='disabled' *ngIf="service_data.status=='INACTIVE' || !service_data.status">{{disbale_cap}}</span>
        </div>
      </div>
      <div *ngIf="!is_donation">
        <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12 mgn-bt-10 no-padding setings">Service Labels</div>
        <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12 no-padding ">
          <span *ngFor="let label of service_data.label | keyvalue"
          [class.appliedLabel]="getDisplayname(label.key)">{{getDisplayname(label.key)}}</span>
        </div>
      </div>
     
      
    </div>
  </div>

  <div class="cop-r" *ngIf="action=='show' && !is_donation" style="margin-bottom: 10px;margin-top: 10px;">
    <ul class="info-lst serviceadd-info">
      <li *ngIf="source === 'appt'">Please add this service to the relevant
        <a class="pointlist" (click)="gotoManageQueue()">Schedules </a>by editing it
      </li>
      <li *ngIf="source !== 'appt'">Please add this service to the relevant
        <a class="pointlist" (click)="gotoManageQueue()">Queues </a>by editing it
      </li>
    </ul>
  </div>
  <hr *ngIf="action=='show'&&  service_data.internalStatus && service_data.internalStatus.length > 0">
  <span *ngIf="action=='show'&&   service_data.internalStatus && service_data.internalStatus.length > 0">Internal
    Status
    and Permissions</span>
  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 no-padding mgn-up-10 mgn-bt-10"
    *ngIf="action=='show'&& service_data.internalStatus && service_data.internalStatus.length > 0">
    <div class="col-xs-12 col-sm-12 col-md-8 col-lg-5 boxsty"
      *ngFor="let stat of service_data.internalStatus;  let i = index">
      <div class="userhed" style="padding-top:10px;">{{stat.status|capitalizeFirst}}</div>
      <div style="font-size:small;"> Permitted Users/Team</div>
      <div *ngIf="getOwnership(stat,false).length > maxuserLength">
        <span class="usrstyle">{{getOwnership(stat,true)}}...<span (click)="usersPopUp(stat)"><u
              style="color: #3c8dbc ; font-size: smaller;cursor: pointer;">more</u></span></span>
      </div>
      <div *ngIf="getOwnership(stat,false).length < maxuserLength">
        <span class="usrstyle">{{getOwnership(stat,false)}}</span>
      </div>
    </div>
  </div>
  <div class="clearfix"></div>







  <!-- Add Service Start -->

  <form [formGroup]="serviceForm" novalidate (ngSubmit)="serviceForm.valid &&
onSubmit(serviceForm.value)" (keyup)="resetApiErrors()" *ngIf="action !== 'show' && !showInfo"
    class="ynw-common-form-nm wiz-service serviceform">
    <br>
    <div class="card-header text-capitalize card pointer-cursor d-flex" data-toggle="collapse"
      data-target="#service_details">
      <div>
        <span class="font-weight-bold grouping-heading float-left">{{is_donation ? 'Cause' : 'Service'}} Details</span>
        <span class="float-right arrow font-weight-bolder"><span class="fa fa-angle-down"></span></span>
      </div>
      <!-- <div>
        <span class="fa fa-angle-down" aria-hidden="true"></span>
        <span class="fa fa-angle-up" aria-hidden="true"></span>
      </div> -->
    </div>
    <ng-container>
      <div id="service_details" class="collapse bgGrey">
        <div class="form-group service-options">
          <label class="label">{{is_donation ? 'Cause' : service_name_cap}} <span class="text-red">*</span></label>
          <input matInput type="text" class="form-control" id="service_name"
            placeholder="{{is_donation ? 'Cause *' : service_name_cap}}" formControlName="name" autocomplete="off">
          <app-field-error-display [displayError]="fed_service.isFieldValid(serviceForm,'name')" [errorMsg]="fed_service.getErrorMessage(serviceForm,'name',
            {
            'required' : is_donation ? 'Please enter cause' : 'Please enter service name',
            'maxlength' : 'Name can contain only 100 characters'
            })">
          </app-field-error-display>
        </div>
        <div class="form-group service-options">
          <!-- <mat-form-field> -->
          <label class="label">{{is_donation ? 'Briefly describe cause' : 'Briefly describe service'}}</label>
          <textarea matInput class="form-control" id="description"
            placeholder="{{is_donation ? 'Briefly describe cause' : 'Briefly describe service'}}"
            formControlName="description" (keyup)="setCharCount()" (focus)="setDescFocus()" (blur)="lostDescFocus()"
            maxlength="500"> </textarea>
          <!-- </mat-form-field> -->

          <app-field-error-display [displayError]="fed_service.isFieldValid(serviceForm,'description')" [errorMsg]="fed_service.getErrorMessage(serviceForm,'description',
          {
          'required' : is_donation ? 'Please enter the cause description' : 'Please enter the service description',
          'maxlength' : 'Description can contain only 500 characters'
          })">
          </app-field-error-display>
          <span class="max-char-length" *ngIf="isfocused">You have {{char_count}} characters remaining</span>
        </div>
        <div class="form-group service-options" *ngIf="filterDepart && !this.departmentId && !is_donation">
          <!-- <mat-form-field> -->
          <label class="label">Choose Department <span class="text-red">*</span></label>
          <mat-select class="form-control" #deptlist (selectionChange)="selectDeptHandler(deptlist.value)"
            formControlName="department" placeholder="Choose Department *" class="form-control">
            <mat-option *ngFor="let dept of departments" [value]="dept.departmentId">
              {{dept.departmentName | capitalizeFirst}}
            </mat-option>
          </mat-select>
          <!-- </mat-form-field> -->
        </div>

        <div class="form-group service-options d-lg-flex" *ngIf="!is_donation">
          <div class="example-full-width" [ngClass]="{'mat-select-virtualsrvcategory':is_virtual_serv}">
            <label class="label">Type</label>
            <!-- <mat-select formControlName="serviceType" placeholder="Type" #virtual
              (selectionChange)="selectServiceHandler(virtual.value)" class="form-control">
              <mat-option *ngIf="!is_donation && is_virtual_enable" [value]="'virtualService'">
                Teleservice
              </mat-option>
              <mat-option *ngIf="!is_donation" [value]="'physicalService'">
                Onsite Service
              </mat-option>
            </mat-select> -->



            <mat-radio-group formControlName="serviceType" class="d-flex service-radio">
              <mat-radio-button disableRipple="true" (change)="selectServiceHandler(virtual.value)" *ngIf="!is_donation"
                [value]="'physicalService'" #virtual class="radio-btn form-control">
                Onsite Service
              </mat-radio-button>
              <mat-radio-button disableRipple="true" (change)="selectServiceHandler(virtual.value)"
                *ngIf="!is_donation && is_virtual_enable" [value]="'virtualService'" #virtual
                class="radio-btn form-control">
                Teleservice
              </mat-radio-button>
            </mat-radio-group>

          </div>
          <div
            *ngIf="is_virtual_serv ||(service_data && service_data.serviceType==='virtualService' && is_physical ===0)"
            class="example-full-width mat-select-virtualservice no-padding">
            <label class="label">Mode</label>
            <mat-select formControlName="virtualServiceType" placeholder="Select mode" #type
              (selectionChange)="selectServiceTypeHandler(type.value)" class="form-control">
              <mat-option [value]="'audioService'">
                Audio
              </mat-option>
              <mat-option [value]="'videoService'">
                Video
              </mat-option>
            </mat-select>
          </div>
        </div>

        <div class="form-group"
          [ngClass]="{'tel-serv-flex':is_tool, 'virtual-serv-div':(service_data && service_data.serviceType==='virtualService' && is_physical ===0)}"
          *ngIf="modeselected || (service_data && service_data.serviceType==='virtualService' && is_physical ===0 )">
          <div class="mat-select-virtualsrvcategory">
            <mat-label class="label">Select
              <span *ngIf="serv_mode === 'videoService'">Video</span>
              <span *ngIf="serv_mode === 'audioService'">Audio</span> Call App
            </mat-label>
            <mat-select class="form-control" #tool (selectionChange)="selectToolTypeHandler(tool.value)"
              [(ngModel)]="tool_name" name="toolname" [ngModelOptions]="{standalone: true}">
              <mat-option *ngFor="let mode of telemodes" [value]="mode">
                <span *ngIf="(mode == 'GoogleMeet'||mode == 'Phone')">&nbsp;</span>
                <i *ngIf="mode === 'WhatsApp'"
                  [ngClass]="{'fa wtsapaud-icon': (serv_mode === 'audioService' || (service_data && service_data.serviceType==='virtualService' && service_data.virtualServiceType === 'audioService')), 'fa wtsapvid-icon': (serv_mode === 'videoService' || (service_data && service_data.serviceType==='virtualService' && service_data.virtualServiceType === 'videoService'))}"
                  aria-hidden="true"></i>
                <i *ngIf="mode === 'Zoom'" class="fa zoom-icon"></i>
                <i *ngIf="mode === 'GoogleMeet'" class="fa meet-icon"></i>
                <i *ngIf="mode === 'Phone'" class="fa phon-icon" aria-hidden="true"></i>
                <i *ngIf="mode === 'VideoCall'" class="fa jvideo-icon jvideo-icon-s jvideo-icon-mgm5"
                  aria-hidden="true"></i>
                <span *ngIf="(mode == 'GoogleMeet'||mode == 'Phone')">&nbsp;</span>
                <span class="dash">{{mode}}</span>
              </mat-option>
            </mat-select>
          </div>
          <div class="example-full-width mat-select-virtualservice">
            <div class="form-group"
              *ngIf="(is_tool || ((service_data && service_data.serviceType==='virtualService' && is_physical ===0) && tool_name !== '')) && tool_name!=='VideoCall'">
              <label class="label">
                {{(tool_name === 'WhatsApp' || tool_name === 'Phone') ? tool_name+' Number' : tool_name+' ID'}}
              </label> <br />
              <div class="form-group" [ngClass]="tool_name === 'WhatsApp' || tool_name === 'Phone' ? 'd-flex':''">
                <div class="input-group-prepend" *ngIf="tool_name === 'WhatsApp' || tool_name === 'Phone'">
                  <input type="text" style="padding: 0px !important;" class="form-control serv-county-code"
                    value="{{tool_code}}" [(ngModel)]="tool_code" [ngModelOptions]="{standalone: true}"
                    (keypress)="isNumericSign($event)">
                </div>
                <div class="form-group">
                  <input style="padding: 0px !important;" type="text" class="form-control"
                    [ngClass]="tool_name === 'WhatsApp' || tool_name === 'Phone' ? 'serv-phone-code':''"
                    autocomplete="off" value="{{tool_id}}" [(ngModel)]="tool_id" [ngModelOptions]="{standalone: true}"
                    (blur)="checkUrl(tool_id)">
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="form-group "
          *ngIf="bprofile.accountType === 'BRANCH' && !serviceFrom && action === 'add' && !is_donation && users_list && users_list.length >= 1">
          <mat-checkbox [(ngModel)]="userspecific" [ngModelOptions]="{standalone: true}">
            User specific
          </mat-checkbox>
          <div class="example-full-width" *ngIf="userspecific && users_list.length >= 1">
            <label class="label">Select user</label>
            <mat-select class="form-control" [(value)]="selectedUser" placeholder="Select user" #userlist>
              <mat-option *ngFor="let usr of users_list" [value]="usr.id">
                {{usr.firstName}} {{usr.lastName}}
              </mat-option>
            </mat-select>
          </div>
        </div>
        <div class="form-group service-options d-lg-flex justify-content-between">
          <div class="example-full-width">
            <label class="label">Appointment Type</label>
            <!-- <mat-radio-button [value]="profile.profileId" readonly
                [checked]="service && profile.profileId === service.paymentProfileId">
                <span class="font-weight-bold">{{profile.displayName}}</span>
              </mat-radio-button> -->
            <!-- <div class="example-full-width row">
                <div class="col-sm-6 col-md-3 col-lg-3 col-xs-6"> -->
            <div class="">
              <!--  -->
              <mat-radio-group class="" formControlName="serviceBookingType">
                <mat-radio-button (change)="selectRequest(request.value)" [checked]="is_checked_booking"
                  [value]="'booking'" #request>
                  <span class="font-weight-bold">Booking</span>
                </mat-radio-button> &nbsp;
                <!-- <mat-radio-button *ngIf="action != 'add'"  (change)="selectRequest(request.value)" [checked]="is_checked_request" [value]="'booking'" #request >
                <span class="font-weight-bold">Booking</span>
              </mat-radio-button> &nbsp; -->
                <!-- </div>
              <div class="col-sm-6 col-md-3 col-lg-3 col-xs-6"> -->
                <mat-radio-button *ngIf="!is_donation" (change)="selectRequest(request1.value)"
                  [checked]="is_checked_request" [value]="'request'" #request1>
                  <span class="font-weight-bold">Request</span>
                </mat-radio-button>

              </mat-radio-group>
            </div>
            <!-- </div> -->

          </div>
          <div *ngIf="is_service_request" class="example-full-width mat-select-virtualservice no-padding">
            <label class="label">Mode</label>
            <!-- formControlName="virtualServiceType" [(value)]="service_data.date || service_data.dateTime || service_data.noDateTime" -->
            <mat-select placeholder="Select mode" #type [(value)]="selectedRequestMode"
              (selectionChange)="selectServiceRequestModeHandler(type.value)" class="form-control">
              <mat-option [value]="'dateTime'">
                Date/Time
              </mat-option>
              <mat-option [value]="'date'">
                Date
              </mat-option>
              <mat-option [value]="'noDateTime'">
                No Date & time
              </mat-option>
            </mat-select>
            <!-- </div> -->
          </div>
          <div *ngIf="service_data && is_checked_request"
            class="example-full-width mat-select-virtualservice no-padding">
            <label class="label">Mode</label>
            <mat-select placeholder="Select mode" #type [(value)]="selectedRequestMode"
              (selectionChange)="selectServiceRequestModeHandler(type.value)" class="form-control">
              <mat-option [value]="'dateTime'">
                Date/Time
              </mat-option>
              <mat-option [value]="'date'">
                Date
              </mat-option>
              <mat-option [value]="'noDateTime'">
                No Date & time
              </mat-option>
            </mat-select>
          </div>

          <!-- <div *ngIf="is_service_request && service_data"
            class="example-full-width mat-select-virtualservice no-padding">
            <label class="label">Mode</label>
            <mat-select placeholder="Select mode" #type
              (selectionChange)="selectServiceRequestModeHandler(type.value)" class="form-control">
              <mat-option *ngIf="service_data.dateTime" [value]="'dateTime'">
                Date/Time
              </mat-option>
              
              <mat-option *ngIf="service_data.date"  [value]="'date'">
                Date
              </mat-option>
              <mat-option *ngIf="service_data.noDateTime"  [value]="'noDateTime'">
               No Date & time
              </mat-option>
            </mat-select>
            </div> -->

        </div>
        <!-- <div class="example-full-width">
          <div class="col-sm-12 col-md-6 col-lg-6 col-xs-12">
            <div *ngIf="is_service_request"
            class="example-full-width mat-select-virtualservice no-padding">
            <label class="label">Mode</label>
            <mat-select formControlName="virtualServiceType" placeholder="Select mode" #type
              (selectionChange)="selectServiceTypeHandler(type.value)" class="form-control">
              <mat-option [value]="'dateTime'">
                Date/Time Mode
              </mat-option>
              <mat-option [value]="'date'">
                Date
              </mat-option>
              <mat-option [value]="'noDateTime'">
               No Date & time
              </mat-option>
            </mat-select>
          </div>
            </div>
        </div> -->
      </div>

      <div class="card-header text-capitalize card pointer-cursor" data-toggle="collapse"
        data-target="#service_time_duration">
        <div>
          <span class="font-weight-bold grouping-heading float-left" *ngIf="!is_donation">Service Time Window</span>
          <span class="font-weight-bold grouping-heading float-left" *ngIf="is_donation">Cause Amount Details</span>
          <span class="float-right arrow font-weight-bolder"><span class="fa fa-angle-down"></span></span>
        </div>
      </div>
      <div id="service_time_duration" class="collapse bgGrey">
        <div class="form-group" *ngIf="subdomainsettings.serviceBillable && !is_donation">
          <ng-container class="example-full-width">
            <label class="col-form-label">{{est_duration_cap}} (Hours : Minutes) *</label>
            <ngb-timepicker [(ngModel)]="duration" formControlName="serviceDuration" (ngModelChange)="resetApiErrors()">
            </ngb-timepicker>
          </ng-container>
        </div>
        <div *ngIf="subdomainsettings.serviceBillable && !is_donation">
          <mat-checkbox [checked]="showServiceduration" [(ngModel)]="showServiceduration"
            [ngModelOptions]="{standalone: true}">
            Show service duration
          </mat-checkbox>
        </div>
        <!-- mgn-lt-5 *ngIf="showResources" -->
        <div class="row mx-1 mgn-up-20">
          <section class="mgn-bt-30" *ngIf="!is_donation">
            <label style="margin-bottom: 0 !important" class="col-form-label">Number of resources</label>
            <div class="settings_info">
              No. of resources that need to be used for this service.</div>

            <div>
              <div class="example-full-width">
                <input matInput type="text" class="form-control" id="resources" (keypress)="isNumeric($event)"
                  placeholder="Number of resources" formControlName="resoucesRequired" autocomplete="off">
              </div>
            </div>
          </section>
        </div>
        <div class="row mx-1 mgn-up-20" *ngIf="!is_donation">
          <section class="mgn-bt-30">
            <label style="margin-bottom: 0 !important" class="col-form-label">Maximum bookings allowed</label>
            <div class="settings_info">
              Maximum no. of bookings allowed for a {{customer_label}} for the same service, same schedule and same day.
            </div>

            <div class="no-padding">
              <input matInput type="number" class="form-control number-ip-sm" id="bookings"
                (keypress)="isNumeric($event)" placeholder="Maximum bookings allowed"
                formControlName="maxBookingsAllowed" autocomplete="off" min="1">
            </div>
          </section>
        </div>
        <div *ngIf="!is_donation">
          <mat-checkbox [checked]="showOnlyAvailableSlots" [(ngModel)]="showOnlyAvailableSlots"
            [ngModelOptions]="{standalone: true}">
            Show Only Available Slots
          </mat-checkbox>
        </div>
        <div class="form-group glbl-preview"
          *ngIf="(subdomainsettings.serviceBillable || !subdomainsettings.serviceBillable) && is_donation">
          <div class="mr-4">
            <div class="rupee-font">
              <label class="label">Minimum Amount ({{rupee_symbol}}) *</label>
              <input min="1" matInput type="number" class="form-control number-ip-sm" id="minprice" maxlength="10"
                (keypress)="isNumeric($event)" (keyup)="isvalid($event, 'minDonationAmount')"
                placeholder="Minimum Amount ({{rupee_symbol}}) *" formControlName="minDonationAmount"
                autocomplete="off">
            </div>
            <app-field-error-display [displayError]="fed_service.isFieldValid(serviceForm,'minDonationAmount')"
              [errorMsgs]="fed_service.getErrorMessage(serviceForm,'minDonationAmount',
              {'required' : 'Please enter amount',
              'pattern' : 'Enter a valid amount',
              'maxlength' : 'Only 10 digits are allowed'})">
            </app-field-error-display>
          </div>
          <div>
            <div class="rupee-font">
              <label class="label">Maximum Amount ({{rupee_symbol}}) *</label>
              <input min="1" matInput type="number" class="form-control number-ip-sm" id="maxprice" maxlength="10"
                (keypress)="isNumeric($event)" (keyup)="isvalid($event, 'maxDonationAmount')"
                placeholder="Maximum Amount ({{rupee_symbol}}) *" formControlName="maxDonationAmount"
                autocomplete="off">
            </div>
            <app-field-error-display [displayError]="fed_service.isFieldValid(serviceForm,'maxDonationAmount')"
              [errorMsgs]="fed_service.getErrorMessage(serviceForm,'maxDonationAmount',
              {'required' : 'Please enter amount',
              'pattern' : 'Enter a valid amount',
              'maxlength' : 'Only 10 digits are allowed'})">
            </app-field-error-display>
          </div>
        </div>
        <div class="form-group" *ngIf="is_donation">
          <label class="label">Multiples</label>
          <input min="1" max={{maxlimit}} matInput type="number" class="form-control number-ip-sm" id="multiples"
            pattern="[0-9]+" maxlength="10" (keypress)="isNumeric($event)" (keyup)="isvalid($event, 'multiples')"
            placeholder="Multiples*" formControlName="multiples" autocomplete="off">
          <app-field-error-display [displayError]="fed_service.isFieldValid(serviceForm,'multiples')" [errorMsgs]="fed_service.getErrorMessage(serviceForm,'multiples',
          {'required' : 'Please enter a multiple',
          'pattern' : 'Enter a valid multiple',
          'maxlength' : 'Only 4 digits are allowed'})">
          </app-field-error-display>
        </div>
      </div>



      <div *ngIf="!is_donation && bprofile.serviceSector.domain != 'finance'"
        class="card-header text-capitalize card pointer-cursor d-flex" data-toggle="collapse"
        data-target="#payment_info">
        <div *ngIf="bprofile.serviceSector.domain != 'finance'">
          <span class="no-padding pointer-cursor">
            Pricing</span>
          <span class="float-right arrow font-weight-bolder"><span class="fa fa-angle-down"></span></span>
        </div>
        <div class="settings_info mx-1" *ngIf="!is_donation">
          Service price, advance amount and more
        </div>
      </div>

      <div *ngIf="bprofile.serviceSector.domain != 'finance'" class="collapse bgGrey" id="payment_info">

        <!-- mgn-lt-5 -->
        <div class="row mx-1 mgn-up-20" *ngIf="showBillingInfo && !is_donation">
          <section class="mgn-bt-30">
            <label style="margin-bottom: 0 !important" class="col-form-label"
              *ngIf="bprofile.serviceSector.domain != 'finance'">Service Price</label>
            <div class="settings_info" *ngIf="bprofile.serviceSector.domain != 'finance'">
              {{frm_service_price}}</div>
            <div class="form-group" *ngIf="subdomainsettings.serviceBillable && !is_donation">
              <label class="label">{{service_price_cap}} ({{rupee_symbol}}) <span class="text-red">*</span></label>
              <div class="rupee-font">
                <input min="0" max={{maxlimit}} matInput type="number" class="form-control number-ip-sm" id="price"
                  maxlength="10" (keypress)="isNumeric($event)" (keyup)="isvalid($event, 'totalAmount')"
                  placeholder="{{service_price_cap}} ({{rupee_symbol}}) *" formControlName="totalAmount"
                  autocomplete="off">
              </div>
              <app-field-error-display [displayError]="fed_service.isFieldValid(serviceForm,'totalAmount')" [errorMsgs]="fed_service.getErrorMessage(serviceForm,'totalAmount',
                {'required' : 'Please enter price',
                'pattern' : 'Enter a valid price',
                'maxlength' : 'Only 10 digits are allowed'})">
              </app-field-error-display>
            </div>
            <div *ngIf="serviceForm.get('totalAmount') && serviceForm.get('totalAmount').value > 0">
              <mat-checkbox [checked]="showPrice" [(ngModel)]="showPrice" [ngModelOptions]="{standalone: true}">
                Show Service Price
              </mat-checkbox>
            </div>
            <div class="form-group" *ngIf="subdomainsettings.serviceBillable && !is_donation">
              <label style="margin-bottom: 0 !important;">Show Price Description
                <mat-slide-toggle class="example-margin" formControlName="priceDynamic">
                </mat-slide-toggle>
                <!-- <div class="form-level-settings">{{frm_enable_prepayment_cap}}</div> -->
              </label>
            </div>
            <div class="form-group"
              *ngIf="subdomainsettings.serviceBillable && !is_donation && serviceForm.get('priceDynamic').value === true">
              <label class="label">{{'Any disclaimer note for price *'}}</label>
              <!-- <mat-form-field> -->
              <textarea matInput class="form-control" id="paymentDescription"
                placeholder="{{'Any disclaimer note for price *'}}" formControlName="paymentDescription" maxlength="500"
                rows="6" cols="1"> </textarea>
              <!-- </mat-form-field> -->
              <!-- <app-field-error-display *ngIf="subdomainsettings.serviceBillable && !is_donation && serviceForm.get('priceDynamic').value === true" [displayError]="fed_service.isFieldValid(serviceForm,'paymentDescription')" [errorMsgs]="fed_service.getErrorMessage(serviceForm,'paymentDescription',
              {'required' : 'Please enter paymentDescription'})">
            </app-field-error-display> -->
            </div>
            <div class="form-group" *ngIf="subdomainsettings.serviceBillable && !is_donation">
              <div>
                <label style="margin-bottom: 0 !important;">Advance payment
                  <mat-slide-toggle class="example-margin" formControlName="isPrePayment" (change)="changePrepayment()">
                  </mat-slide-toggle>
                  <div class="form-level-settings">{{frm_enable_prepayment_cap}}</div>
                </label>
              </div>
              <ng-container *ngIf="subdomainsettings.serviceBillable && !is_donation">
                <div class="form-group" *ngIf="serviceForm.get('isPrePayment').value === true">
                  <div class="example-full-width mt-2">
                    <label class="label">PrePayment Type</label>
                    <div class="">
                      <mat-radio-group class="" formControlName="prePaymentType">
                        <mat-radio-button (change)="selectPrePaymentType(type.value)" [checked]="is_checked_fixed"
                          [value]="'fixed'" #type>
                          <span class="font-weight-bold">Fixed</span>
                        </mat-radio-button> &nbsp;
                        <mat-radio-button (change)="selectPrePaymentType(type1.value)" [checked]="is_checked_percentage"
                          [value]="'percentage'" #type1>
                          <span class="font-weight-bold">Percentange</span>
                        </mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>
                  <div class="rupee-font d-flex align-items-center">
                    <span *ngIf="is_checked_fixed">{{rupee_symbol}}</span>&nbsp;
                    <input matInput min="0" max={{maxlimit}} type="number"
                      (keyup)="isvalid($event, 'minPrePaymentAmount')" (keypress)="isNumeric($event)" maxlength="10"
                      class="form-control number-ip-sm" id="prepayment_amount"
                      placeholder="Advance payment amount ({{rupee_symbol}}) *" formControlName="minPrePaymentAmount"
                      autocomplete="off">&nbsp;
                    <span *ngIf="is_checked_percentage">{{percentage_symbol}}</span>
                  </div>
                  <!--  <div class="rupee-font d-flex align-items-center" *ngIf="is_checked_percentage">
                    <input matInput min="0" max={{maxlimit}} type="number" (keyup)="isvalid($event, 'minPrePaymentAmount')"
                      (keypress)="isNumeric($event)" maxlength="10" class="form-control number-ip-sm"
                      id="prepayment_amount" placeholder="Advance payment amount ({{rupee_symbol}}) *"
                      formControlName="minPrePaymentAmount" autocomplete="off">&nbsp;
                      <span >{{percentage_symbol}}</span>
                  </div> -->
                  <app-field-error-display [displayError]="fed_service.isFieldValid(serviceForm,'minPrePaymentAmount')"
                    [errorMsgs]="fed_service.getErrorMessage(serviceForm,'minPrePaymentAmount',
                    {'required' : 'Please enter prepayment amount',
                    'pattern' : 'Enter a valid amount'})">
                  </app-field-error-display>

                </div>
              </ng-container>
            </div>
            <div class="form-group inline" *ngIf="subdomainsettings.serviceBillable">
              <label class="col-form-label">{{tax_applicable_cap}}</label>
              <mat-slide-toggle class="example-margin" formControlName="taxable" (change)="taxapplicableChange()">
              </mat-slide-toggle>
            </div>
          </section>
        </div>
      </div>



      <div *ngIf="bprofile.serviceSector.domain != 'finance'"
        class="card-header text-capitalize card pointer-cursor d-flex" data-toggle="collapse"
        data-target="#payment_profiles">
        <div>
          <span class="no-padding pointer-cursor">
            Payment Info
          </span>
          <span class="float-right arrow font-weight-bolder"><span class="fa fa-angle-down"></span></span>
        </div>
      </div>
      <div *ngIf="bprofile.serviceSector.domain != 'finance'" class="collapse bgGrey" id="payment_profiles">
        <ng-container *ngIf="paymentProfiles.length===1">
          <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12 mgn-bt-10 no-padding ">Payment Profile Selected for this
            service is: <b>{{paymentProfiles[0].displayName}}.</b> Contact our support team to change payment profile
            for
            this service.</div>
          <div class="col-xs-12 col-md-12 col-sm-12 col-lg-12 no-padding ">
            <app-payment-mode [paymentProfile]="paymentProfiles[0]"></app-payment-mode>
          </div>
        </ng-container>
        <ng-container *ngIf="paymentProfiles.length>1">
          <div class="col-xs-12 col-sm-12 col-lg-12 col-xs-12 no-padding mgn-bt-10 bold">Select Payment Profile for
            Service</div>
          <div class="col-xs-12 col-sm-12 col-lg-12 col-xs-12 mgn-bt-20"
            *ngFor="let profile of paymentProfiles; let i=index">
            <mat-radio-group name="paymentprofile" formControlName="paymentProfileId" class="mt-4">
              <mat-radio-button [value]="profile.profileId" readonly
                [checked]="service && profile.profileId === service.paymentProfileId">
                <span class="font-weight-bold">{{profile.displayName}}</span>
              </mat-radio-button>
              <app-payment-mode [paymentProfile]="profile"></app-payment-mode>
            </mat-radio-group>
          </div>
        </ng-container>
      </div>



      <div class="card-header text-capitalize card pointer-cursor d-flex" (click)="advancedClick()"
        data-toggle="collapse" data-target="#customization">
        <div>
          <span class="no-padding pointer-cursor">
            Customization
          </span>
          <span class="float-right arrow font-weight-bolder"><span class="fa fa-angle-down"></span></span>
        </div>
      </div>
      <div class="collapse bgGrey" id="customization">
        <div class="row mx-1  mgn-up-20" *ngIf="showAdvancedSettings">
          <div class="form-group box-style col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div class="disp-flex">
              <label *ngIf="!is_donation" class="col-form-label">Custom field to collect additional information from
                your {{customer_label}}s
                while booking online &nbsp;&nbsp;
              </label>
              <label *ngIf="is_donation" class="col-form-label">Custom field to collect additional information from your
                {{customer_label}}s
                while donation &nbsp;&nbsp;
              </label>
              <mat-slide-toggle class="example-margin" formControlName="consumerNoteMandatory"
                (change)="changeConsumerNoteStatus($event)">
              </mat-slide-toggle>
            </div>
            <div class="settings_info" *ngIf="!is_donation">
              If enabled, {{customer_label}}s will have to click this button and add certain information before
              confirming
              their service
              booking</div>
            <div class="settings_info" *ngIf="is_donation">
              If enabled, {{customer_label}}s will have to click this button and add certain information before
              confirming
              their donation</div>
            <div class="mgn-up-15" *ngIf="showConsumerNote">
              Button Name:
              <span *ngIf="!showEditSection">{{consumerNote}}&nbsp;
                <i class="fa fa-pencil pointer-cursor" (click)="editClicked()"></i>
              </span>
              <div class="settings_info">
                Name this button accordingly so that {{customer_label}} will add the relevant information.
                <div> ex. Delivery Address</div>
              </div>
              <div class="disp-flex" *ngIf="showEditSection">
                <mat-form-field class="col-lg-8 col-md-8 col-sm-12 col-xs-12 no-padding">
                  <input matInput min="0" maxlength="20" [(ngModel)]="consumerNote"
                    [ngModelOptions]="{standalone: true}" autocomplete="off" (keyup)="resetApiErrors()">
                </mat-form-field>
                <div class="mgn-up-20 col-lg-4 col-md-4 col-sm-12 col-xs-12">
                  <span class="cs-btn bt3" (click)="editClicked('save')">
                    ok</span>
                </div>
              </div>
              <app-field-error-display *ngIf="showNoteError !== ''" [displayError]="true" [errorMsg]="showNoteError">
              </app-field-error-display>
            </div>
          </div>
          <div class="mgn-up-10 mgn-bt-10 box-style col-lg-12 col-md-12 col-sm-12 col-xs-12" *ngIf="!is_donation">
            Show personalized information about this service
            <span class="cs-btn bt3" (click)="showInfoSection()" *ngIf="!preInfoEnabled && !postInfoEnabled">
              Click here</span>
            <div class="prepost-check" *ngIf="preInfoEnabled || postInfoEnabled">
              <i class="fa fa-check"></i>
              <a (click)="showInfoSection()"> Instructions Added</a>
            </div>
          </div>
          <div class="mgn-up-10 mgn-bt-10 box-style col-lg-12 col-md-12 col-sm-12 col-xs-12" *ngIf="is_donation">
            Show personalized information about this cause
            <span class="cs-btn bt3" (click)="showInfoSection()" *ngIf="!preInfoEnabled && !postInfoEnabled">
              Click here</span>
            <div class="prepost-check" *ngIf="preInfoEnabled || postInfoEnabled">
              <i class="fa fa-check"></i>
              <a (click)="showInfoSection()"> Instructions Added</a>
            </div>
          </div>
          <div class="form-group mgn-up-20 col-lg-12 col-md-12 col-sm-12 col-xs-12 no-padding"
            *ngIf="!is_virtual_serv && is_lvtrack_enable && !is_donation">
            <div class="disp-flex">
              <label class="col-form-label">Enable live track to locate your {{customer_label}}&nbsp;&nbsp;
              </label>
              <mat-slide-toggle class="example-margin" formControlName="livetrack">
              </mat-slide-toggle>
            </div>
            <div class="settings_info">
              Enable live track feature to know the arrival time of your {{customer_label}}</div>
          </div>
        </div>
      </div>


      <a class="card-header text-capitalize card pointer-cursor d-flex" href="tel:+91 7306823011">
        <div>
          <span class="font-weight-bold grouping-heading float-left"><label *ngIf="!is_donation"
              class="no-padding grouping-heading" style="font-size: 1.1rem;">
              {{customer_label | capitalizeFirst}} Info</label>
            <label *ngIf="is_donation" class="no-padding grouping-heading" style="font-size: 1.1rem;">
              Donor Info</label>
          </span>
          <!-- <span class="float-right arrow font-weight-bolder"><span class="fa fa-angle-down"></span></span> -->
        </div>
        <div class="settings_info" *ngIf="!is_donation">
          Would you like to collect more information from your {{customer_label}} along with the booking ? Jaldee can
          set it up for you. Please contact support team at (+91 7306823011) to help us assist you.
        </div>
        <div class="settings_info" *ngIf="is_donation">
          Would you like to collect more information from your donor along with the donation ? Jaldee can set it up
          for you. Please contact support team at (+91 7306823011) to help us assist you.
        </div>
        <!-- <div>
          <span class="fa fa-angle-down" aria-hidden="true"></span>
          <span class="fa fa-angle-up" aria-hidden="true"></span>
        </div> -->
      </a>



      <div class="actiondiv" style="margin-top: 20px;">
        <div style="margin-bottom:30px;display: inline-flex;">
          <button (click)="onCancel()" type="button" class="cs-btn bt2">{{cancel_btn}}</button> &nbsp;
          <button type="submit" mat-button [disabled]="!serviceForm.valid || savedisabled"
            class="cs-btn bt1">{{button_title}}</button>
        </div>
        <div *ngIf="action == 'add' && !is_donation">
          <span class="addservice-tooltip" *ngIf="source === 'appt'">
            <i class="icon-bell"></i>
            Please add this service to the relevant Schedules by editing it
          </span>
          <span class="addservice-tooltip" *ngIf="source !== 'appt'">
            <i class="icon-bell"></i>
            {{tooltip}}
          </span>
        </div>
      </div>
    </ng-container>
  </form>

  <div class="ynw-common-form-nm pre-post" *ngIf="showInfo">
    <div class="mgn-bt-20 mgn-up-20">
      <div class="form-group preinfo">
        <label class="col-form-label" *ngIf="!is_donation">Show personalized information about this service in the
          booking
          window&nbsp;&nbsp;</label>
        <label class="col-form-label" *ngIf="is_donation">Show personalized information about this donation
          cause.&nbsp;&nbsp;</label>
        <mat-slide-toggle class="example-margin" [(ngModel)]="preInfoEnabled">
        </mat-slide-toggle>
      </div>
      <div class="form-level-settings" *ngIf="!is_donation">These instructions will be seen by your
        {{customer_label}}s while choosing the
        service.</div>
      <div class="form-level-settings" *ngIf="is_donation">These instructions will be seen by your {{customer_label}}s
        while making a donation.</div>
      <div class="form-group pre-post-info" *ngIf="preInfoEnabled">
        <mat-form-field>
          <input matInput type="text" placeholder="Title *" autocomplete="off" [(ngModel)]="preInfoTitle"
            [ngModelOptions]="{standalone: true}" maxlength="20">
        </mat-form-field>
        Enter the text your {{customer_label}}s will see
        <div class="infotext mgn-bt-20 mgn-up-20">
          <textarea [(ngModel)]="preInfoText" rows="10" [ngModelOptions]="{standalone: true}"></textarea>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="mgn-bt-20 mgn-up-20">
      <div class="form-group postinfo">
        <label class="col-form-label" *ngIf="!is_donation">Show personalized messages to your {{customer_label}}s upon
          successful booking
          confirmation.&nbsp;&nbsp;</label>
        <label class="col-form-label" *ngIf="is_donation">Show personalized message to your {{customer_label}}s after
          the donation.&nbsp;&nbsp;</label>
        <mat-slide-toggle class="example-margin" [(ngModel)]="postInfoEnabled">
        </mat-slide-toggle>
      </div>
      <div class="form-level-settings" *ngIf="!is_donation">These instructions will be seen by your
        {{customer_label}}s after confirmation of
        the service.</div>
      <div class="form-level-settings" *ngIf="is_donation">These instructions will be seen by your {{customer_label}}s
        after the donation is successfully made.</div>
      <div class="form-group pre-post-info" *ngIf="postInfoEnabled">
        <mat-form-field>
          <input matInput type="text" placeholder="Title *" autocomplete="off" [(ngModel)]="postInfoTitle"
            [ngModelOptions]="{standalone: true}" maxlength="20">
        </mat-form-field>
        Enter the text your {{customer_label}}s will see
        <div class="infotext mgn-bt-20 mgn-up-20">
          <textarea [(ngModel)]="postInfoText" rows="10" [ngModelOptions]="{standalone: true}"></textarea>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
    <div class="col-md-12 col-xs-12 col-sm-12 col-lg-12 actiondiv no-padding">
      <button class="cs-btn bt2 savemember" (click)="cancelChanges()">Cancel</button>&nbsp;&nbsp;
      <button mat-button class="cs-btn bt1 savemember" (click)="showInfoSection()">Save</button>
    </div>
  </div>
</div>